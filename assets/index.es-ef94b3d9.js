import{i as Kv,e as Vv,f as Bv,h as Gv,j as Wv,k as Jv,m as Qv,o as Yv,p as Zv,q as Xv,s as e1,r as t1,t as r1,u as i1,v as n1,w as kc,x as vf,y as se,z as wf,A as No,H as s1,B as bf,C as o1,D as a1,E as Kc,F as Qr,G as c1,I as _f,J as yo,K as u1,L as Vc,_ as h1}from"./index-a31c56fe.js";import{d as l1,s as os,a as $o,i as al,c as f1,b as p1,f as Bc,p as d1,J as fi,e as Gc,g as Wc,h as Jc,j as Si,k as li,l as ts,m as g1,n as y1,H as Ai}from"./http-9b2b62d2.js";function Qc(s){return globalThis.Buffer!=null?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):s}function Ef(s=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Qc(globalThis.Buffer.allocUnsafe(s)):new Uint8Array(s)}function Sc(s,t){t||(t=s.reduce((o,u)=>o+u.length,0));const r=Ef(t);let n=0;for(const o of s)r.set(o,n),n+=o.length;return Qc(r)}const cl={...Kv,...Vv,...Bv,...Gv,...Wv,...Jv,...Qv,...Yv,...Zv,...Xv};function If(s,t,r,n){return{name:s,prefix:t,encoder:{name:s,prefix:t,encode:r},decoder:{decode:n}}}const ul=If("utf8","u",s=>"u"+new TextDecoder("utf8").decode(s),s=>new TextEncoder().encode(s.substring(1))),ac=If("ascii","a",s=>{let t="a";for(let r=0;r<s.length;r++)t+=String.fromCharCode(s[r]);return t},s=>{s=s.substring(1);const t=Ef(s.length);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}),xf={utf8:ul,"utf-8":ul,hex:cl.base16,latin1:ac,ascii:ac,binary:ac,...cl};function gr(s,t="utf8"){const r=xf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Qc(globalThis.Buffer.from(s,"utf-8")):r.decoder.decode(`${r.prefix}${s}`)}function sr(s,t="utf8"){const r=xf[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(s.buffer,s.byteOffset,s.byteLength).toString("utf8"):r.encoder.encode(s).substring(1)}const m1={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};var rs={};(function(s){const t=r1,r=i1,n=e1,o=t1,u=A=>A==null,f=Symbol("encodeFragmentIdentifier");function g(A){switch(A.arrayFormat){case"index":return $=>(U,M)=>{const x=U.length;return M===void 0||A.skipNull&&M===null||A.skipEmptyString&&M===""?U:M===null?[...U,[w($,A),"[",x,"]"].join("")]:[...U,[w($,A),"[",w(x,A),"]=",w(M,A)].join("")]};case"bracket":return $=>(U,M)=>M===void 0||A.skipNull&&M===null||A.skipEmptyString&&M===""?U:M===null?[...U,[w($,A),"[]"].join("")]:[...U,[w($,A),"[]=",w(M,A)].join("")];case"colon-list-separator":return $=>(U,M)=>M===void 0||A.skipNull&&M===null||A.skipEmptyString&&M===""?U:M===null?[...U,[w($,A),":list="].join("")]:[...U,[w($,A),":list=",w(M,A)].join("")];case"comma":case"separator":case"bracket-separator":{const $=A.arrayFormat==="bracket-separator"?"[]=":"=";return U=>(M,x)=>x===void 0||A.skipNull&&x===null||A.skipEmptyString&&x===""?M:(x=x===null?"":x,M.length===0?[[w(U,A),$,w(x,A)].join("")]:[[M,w(x,A)].join(A.arrayFormatSeparator)])}default:return $=>(U,M)=>M===void 0||A.skipNull&&M===null||A.skipEmptyString&&M===""?U:M===null?[...U,w($,A)]:[...U,[w($,A),"=",w(M,A)].join("")]}}function v(A){let $;switch(A.arrayFormat){case"index":return(U,M,x)=>{if($=/\[(\d*)\]$/.exec(U),U=U.replace(/\[\d*\]$/,""),!$){x[U]=M;return}x[U]===void 0&&(x[U]={}),x[U][$[1]]=M};case"bracket":return(U,M,x)=>{if($=/(\[\])$/.exec(U),U=U.replace(/\[\]$/,""),!$){x[U]=M;return}if(x[U]===void 0){x[U]=[M];return}x[U]=[].concat(x[U],M)};case"colon-list-separator":return(U,M,x)=>{if($=/(:list)$/.exec(U),U=U.replace(/:list$/,""),!$){x[U]=M;return}if(x[U]===void 0){x[U]=[M];return}x[U]=[].concat(x[U],M)};case"comma":case"separator":return(U,M,x)=>{const j=typeof M=="string"&&M.includes(A.arrayFormatSeparator),K=typeof M=="string"&&!j&&E(M,A).includes(A.arrayFormatSeparator);M=K?E(M,A):M;const ce=j||K?M.split(A.arrayFormatSeparator).map(ae=>E(ae,A)):M===null?M:E(M,A);x[U]=ce};case"bracket-separator":return(U,M,x)=>{const j=/(\[\])$/.test(U);if(U=U.replace(/\[\]$/,""),!j){x[U]=M&&E(M,A);return}const K=M===null?[]:M.split(A.arrayFormatSeparator).map(ce=>E(ce,A));if(x[U]===void 0){x[U]=K;return}x[U]=[].concat(x[U],K)};default:return(U,M,x)=>{if(x[U]===void 0){x[U]=M;return}x[U]=[].concat(x[U],M)}}}function p(A){if(typeof A!="string"||A.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function w(A,$){return $.encode?$.strict?t(A):encodeURIComponent(A):A}function E(A,$){return $.decode?r(A):A}function O(A){return Array.isArray(A)?A.sort():typeof A=="object"?O(Object.keys(A)).sort(($,U)=>Number($)-Number(U)).map($=>A[$]):A}function q(A){const $=A.indexOf("#");return $!==-1&&(A=A.slice(0,$)),A}function D(A){let $="";const U=A.indexOf("#");return U!==-1&&($=A.slice(U)),$}function J(A){A=q(A);const $=A.indexOf("?");return $===-1?"":A.slice($+1)}function oe(A,$){return $.parseNumbers&&!Number.isNaN(Number(A))&&typeof A=="string"&&A.trim()!==""?A=Number(A):$.parseBooleans&&A!==null&&(A.toLowerCase()==="true"||A.toLowerCase()==="false")&&(A=A.toLowerCase()==="true"),A}function fe(A,$){$=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},$),p($.arrayFormatSeparator);const U=v($),M=Object.create(null);if(typeof A!="string"||(A=A.trim().replace(/^[?#&]/,""),!A))return M;for(const x of A.split("&")){if(x==="")continue;let[j,K]=n($.decode?x.replace(/\+/g," "):x,"=");K=K===void 0?null:["comma","separator","bracket-separator"].includes($.arrayFormat)?K:E(K,$),U(E(j,$),K,M)}for(const x of Object.keys(M)){const j=M[x];if(typeof j=="object"&&j!==null)for(const K of Object.keys(j))j[K]=oe(j[K],$);else M[x]=oe(j,$)}return $.sort===!1?M:($.sort===!0?Object.keys(M).sort():Object.keys(M).sort($.sort)).reduce((x,j)=>{const K=M[j];return K&&typeof K=="object"&&!Array.isArray(K)?x[j]=O(K):x[j]=K,x},Object.create(null))}s.extract=J,s.parse=fe,s.stringify=(A,$)=>{if(!A)return"";$=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},$),p($.arrayFormatSeparator);const U=K=>$.skipNull&&u(A[K])||$.skipEmptyString&&A[K]==="",M=g($),x={};for(const K of Object.keys(A))U(K)||(x[K]=A[K]);const j=Object.keys(x);return $.sort!==!1&&j.sort($.sort),j.map(K=>{const ce=A[K];return ce===void 0?"":ce===null?w(K,$):Array.isArray(ce)?ce.length===0&&$.arrayFormat==="bracket-separator"?w(K,$)+"[]":ce.reduce(M(K),[]).join("&"):w(K,$)+"="+w(ce,$)}).filter(K=>K.length>0).join("&")},s.parseUrl=(A,$)=>{$=Object.assign({decode:!0},$);const[U,M]=n(A,"#");return Object.assign({url:U.split("?")[0]||"",query:fe(J(A),$)},$&&$.parseFragmentIdentifier&&M?{fragmentIdentifier:E(M,$)}:{})},s.stringifyUrl=(A,$)=>{$=Object.assign({encode:!0,strict:!0,[f]:!0},$);const U=q(A.url).split("?")[0]||"",M=s.extract(A.url),x=s.parse(M,{sort:!1}),j=Object.assign(x,A.query);let K=s.stringify(j,$);K&&(K=`?${K}`);let ce=D(A.url);return A.fragmentIdentifier&&(ce=`#${$[f]?w(A.fragmentIdentifier,$):A.fragmentIdentifier}`),`${U}${K}${ce}`},s.pick=(A,$,U)=>{U=Object.assign({parseFragmentIdentifier:!0,[f]:!1},U);const{url:M,query:x,fragmentIdentifier:j}=s.parseUrl(A,U);return s.stringifyUrl({url:M,query:o(x,$),fragmentIdentifier:j},U)},s.exclude=(A,$,U)=>{const M=Array.isArray($)?x=>!$.includes(x):(x,j)=>!$(x,j);return s.pick(A,M,U)}})(rs);const v1=":";function w1(s){const[t,r]=s.split(v1);return{namespace:t,reference:r}}function b1(s,t=[]){const r=[];return Object.keys(s).forEach(n=>{if(t.length&&!t.includes(n))return;const o=s[n];r.push(...o.accounts)}),r}function Sf(s,t){return s.includes(":")?[s]:t.chains||[]}const Pf="base10",nr="base16",Pc="base64pad",Yc="utf8",Of=0,Gi=1,_1=0,hl=1,Oc=12,Zc=32;function E1(){const s=wf.generateKeyPair();return{privateKey:sr(s.secretKey,nr),publicKey:sr(s.publicKey,nr)}}function Cc(){const s=No.randomBytes(Zc);return sr(s,nr)}function I1(s,t){const r=wf.sharedKey(gr(s,nr),gr(t,nr),!0),n=new s1(kc.SHA256,r).expand(Zc);return sr(n,nr)}function x1(s){const t=kc.hash(gr(s,nr));return sr(t,nr)}function bn(s){const t=kc.hash(gr(s,Yc));return sr(t,nr)}function S1(s){return gr(`${s}`,Pf)}function as(s){return Number(sr(s,Pf))}function P1(s){const t=S1(typeof s.type<"u"?s.type:Of);if(as(t)===Gi&&typeof s.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const r=typeof s.senderPublicKey<"u"?gr(s.senderPublicKey,nr):void 0,n=typeof s.iv<"u"?gr(s.iv,nr):No.randomBytes(Oc),o=new bf.ChaCha20Poly1305(gr(s.symKey,nr)).seal(n,gr(s.message,Yc));return C1({type:t,sealed:o,iv:n,senderPublicKey:r})}function O1(s){const t=new bf.ChaCha20Poly1305(gr(s.symKey,nr)),{sealed:r,iv:n}=Oo(s.encoded),o=t.open(n,r);if(o===null)throw new Error("Failed to decrypt");return sr(o,Yc)}function C1(s){if(as(s.type)===Gi){if(typeof s.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return sr(Sc([s.type,s.senderPublicKey,s.iv,s.sealed]),Pc)}return sr(Sc([s.type,s.iv,s.sealed]),Pc)}function Oo(s){const t=gr(s,Pc),r=t.slice(_1,hl),n=hl;if(as(r)===Gi){const g=n+Zc,v=g+Oc,p=t.slice(n,g),w=t.slice(g,v),E=t.slice(v);return{type:r,sealed:E,iv:w,senderPublicKey:p}}const o=n+Oc,u=t.slice(n,o),f=t.slice(o);return{type:r,sealed:f,iv:u}}function A1(s,t){const r=Oo(s);return Cf({type:as(r.type),senderPublicKey:typeof r.senderPublicKey<"u"?sr(r.senderPublicKey,nr):void 0,receiverPublicKey:t==null?void 0:t.receiverPublicKey})}function Cf(s){const t=(s==null?void 0:s.type)||Of;if(t===Gi){if(typeof(s==null?void 0:s.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(s==null?void 0:s.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:t,senderPublicKey:s==null?void 0:s.senderPublicKey,receiverPublicKey:s==null?void 0:s.receiverPublicKey}}function ll(s){return s.type===Gi&&typeof s.senderPublicKey=="string"&&typeof s.receiverPublicKey=="string"}var R1=Object.defineProperty,fl=Object.getOwnPropertySymbols,T1=Object.prototype.hasOwnProperty,N1=Object.prototype.propertyIsEnumerable,pl=(s,t,r)=>t in s?R1(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,dl=(s,t)=>{for(var r in t||(t={}))T1.call(t,r)&&pl(s,r,t[r]);if(fl)for(var r of fl(t))N1.call(t,r)&&pl(s,r,t[r]);return s};const $1="ReactNative",Er={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},F1="js";function Xc(){return typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"}function En(){return!o1()&&!!vf()&&navigator.product===$1}function In(){return!Xc()&&!!vf()}function cs(){return En()?Er.reactNative:Xc()?Er.node:In()?Er.browser:Er.unknown}function D1(){var s;try{return En()&&typeof global<"u"&&typeof(global==null?void 0:global.Application)<"u"?(s=global.Application)==null?void 0:s.applicationId:void 0}catch{return}}function j1(s,t){let r=rs.parse(s);return r=dl(dl({},r),t),s=rs.stringify(r),s}function L1(){return n1()||{name:"",description:"",url:"",icons:[""]}}function q1(){if(cs()===Er.reactNative&&typeof global<"u"&&typeof(global==null?void 0:global.Platform)<"u"){const{OS:r,Version:n}=global.Platform;return[r,n].join("-")}const s=l1();if(s===null)return"unknown";const t=s.os?s.os.replace(" ","").toLowerCase():"unknown";return s.type==="browser"?[t,s.name,s.version].join("-"):[t,s.version].join("-")}function M1(){var s;const t=cs();return t===Er.browser?[t,((s=a1())==null?void 0:s.host)||"unknown"].join(":"):t}function U1(s,t,r){const n=q1(),o=M1();return[[s,t].join("-"),[F1,r].join("-"),n,o].join("/")}function z1({protocol:s,version:t,relayUrl:r,sdkVersion:n,auth:o,projectId:u,useOnCloseEvent:f,bundleId:g}){const v=r.split("?"),p=U1(s,t,n),w={auth:o,ua:p,projectId:u,useOnCloseEvent:f||void 0,origin:g||void 0},E=j1(v[1]||"",w);return v[0]+"?"+E}function Bi(s,t){return s.filter(r=>t.includes(r)).length===s.length}function Af(s){return Object.fromEntries(s.entries())}function Rf(s){return new Map(Object.entries(s))}function vn(s=se.FIVE_MINUTES,t){const r=se.toMiliseconds(s||se.FIVE_MINUTES);let n,o,u;return{resolve:f=>{u&&n&&(clearTimeout(u),n(f))},reject:f=>{u&&o&&(clearTimeout(u),o(f))},done:()=>new Promise((f,g)=>{u=setTimeout(()=>{g(new Error(t))},r),n=f,o=g})}}function is(s,t,r){return new Promise(async(n,o)=>{const u=setTimeout(()=>o(new Error(r)),t);try{const f=await s;n(f)}catch(f){o(f)}clearTimeout(u)})}function Tf(s,t){if(typeof t=="string"&&t.startsWith(`${s}:`))return t;if(s.toLowerCase()==="topic"){if(typeof t!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${t}`}else if(s.toLowerCase()==="id"){if(typeof t!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${t}`}throw new Error(`Unknown expirer target type: ${s}`)}function H1(s){return Tf("topic",s)}function k1(s){return Tf("id",s)}function Nf(s){const[t,r]=s.split(":"),n={id:void 0,topic:void 0};if(t==="topic"&&typeof r=="string")n.topic=r;else if(t==="id"&&Number.isInteger(Number(r)))n.id=Number(r);else throw new Error(`Invalid target, expected id:number or topic:string, got ${t}:${r}`);return n}function Ur(s,t){return se.fromMiliseconds((t||Date.now())+se.toMiliseconds(s))}function Pi(s){return Date.now()>=se.toMiliseconds(s)}function Ft(s,t){return`${s}${t?`:${t}`:""}`}function cc(s=[],t=[]){return[...new Set([...s,...t])]}async function K1({id:s,topic:t,wcDeepLink:r}){try{if(!r)return;const n=typeof r=="string"?JSON.parse(r):r;let o=n==null?void 0:n.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const u=`${o}/wc?requestId=${s}&sessionTopic=${t}`,f=cs();f===Er.browser?u.startsWith("https://")?window.open(u,"_blank","noreferrer noopener"):window.open(u,"_self","noreferrer noopener"):f===Er.reactNative&&typeof(global==null?void 0:global.Linking)<"u"&&await global.Linking.openURL(u)}catch(n){console.error(n)}}async function V1(s,t){try{return await s.getItem(t)||(In()?localStorage.getItem(t):void 0)}catch(r){console.error(r)}}const B1="irn";function Ac(s){return(s==null?void 0:s.relay)||{protocol:B1}}function Io(s){const t=m1[s];if(typeof t>"u")throw new Error(`Relay Protocol not supported: ${s}`);return t}var G1=Object.defineProperty,gl=Object.getOwnPropertySymbols,W1=Object.prototype.hasOwnProperty,J1=Object.prototype.propertyIsEnumerable,yl=(s,t,r)=>t in s?G1(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Q1=(s,t)=>{for(var r in t||(t={}))W1.call(t,r)&&yl(s,r,t[r]);if(gl)for(var r of gl(t))J1.call(t,r)&&yl(s,r,t[r]);return s};function Y1(s,t="-"){const r={},n="relay"+t;return Object.keys(s).forEach(o=>{if(o.startsWith(n)){const u=o.replace(n,""),f=s[o];r[u]=f}}),r}function ml(s){s=s.includes("wc://")?s.replace("wc://",""):s,s=s.includes("wc:")?s.replace("wc:",""):s;const t=s.indexOf(":"),r=s.indexOf("?")!==-1?s.indexOf("?"):void 0,n=s.substring(0,t),o=s.substring(t+1,r).split("@"),u=typeof r<"u"?s.substring(r):"",f=rs.parse(u);return{protocol:n,topic:Z1(o[0]),version:parseInt(o[1],10),symKey:f.symKey,relay:Y1(f)}}function Z1(s){return s.startsWith("//")?s.substring(2):s}function X1(s,t="-"){const r="relay",n={};return Object.keys(s).forEach(o=>{const u=r+t+o;s[o]&&(n[u]=s[o])}),n}function ew(s){return`${s.protocol}:${s.topic}@${s.version}?`+rs.stringify(Q1({symKey:s.symKey},X1(s.relay)))}function xn(s){const t=[];return s.forEach(r=>{const[n,o]=r.split(":");t.push(`${n}:${o}`)}),t}function tw(s){const t=[];return Object.values(s).forEach(r=>{t.push(...xn(r.accounts))}),t}function rw(s,t){const r=[];return Object.values(s).forEach(n=>{xn(n.accounts).includes(t)&&r.push(...n.methods)}),r}function iw(s,t){const r=[];return Object.values(s).forEach(n=>{xn(n.accounts).includes(t)&&r.push(...n.events)}),r}function nw(s,t){const r=xo(s,t);if(r)throw new Error(r.message);const n={};for(const[o,u]of Object.entries(s))n[o]={methods:u.methods,events:u.events,chains:u.accounts.map(f=>`${f.split(":")[0]}:${f.split(":")[1]}`)};return n}function eu(s){return s.includes(":")}function Zn(s){return eu(s)?s.split(":")[0]:s}const sw={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},ow={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function Z(s,t){const{message:r,code:n}=ow[s];return{message:t?`${r} ${t}`:r,code:n}}function It(s,t){const{message:r,code:n}=sw[s];return{message:t?`${r} ${t}`:r,code:n}}function Jr(s,t){return Array.isArray(s)?typeof t<"u"&&s.length?s.every(t):!0:!1}function _n(s){return Object.getPrototypeOf(s)===Object.prototype&&Object.keys(s).length}function ir(s){return typeof s>"u"}function Ht(s,t){return t&&ir(s)?!0:typeof s=="string"&&!!s.trim().length}function tu(s,t){return t&&ir(s)?!0:typeof s=="number"&&!isNaN(s)}function aw(s,t){const{requiredNamespaces:r}=t,n=Object.keys(s.namespaces),o=Object.keys(r);let u=!0;return Bi(o,n)?(n.forEach(f=>{const{accounts:g,methods:v,events:p}=s.namespaces[f],w=xn(g),E=r[f];(!Bi(Sf(f,E),w)||!Bi(E.methods,v)||!Bi(E.events,p))&&(u=!1)}),u):!1}function Co(s){return Ht(s,!1)&&s.includes(":")?s.split(":").length===2:!1}function cw(s){if(Ht(s,!1)&&s.includes(":")){const t=s.split(":");if(t.length===3){const r=t[0]+":"+t[1];return!!t[2]&&Co(r)}}return!1}function uw(s){if(Ht(s,!1))try{return typeof new URL(s)<"u"}catch{return!1}return!1}function hw(s){var t;return(t=s==null?void 0:s.proposer)==null?void 0:t.publicKey}function lw(s){return s==null?void 0:s.topic}function fw(s,t){let r=null;return Ht(s==null?void 0:s.publicKey,!1)||(r=Z("MISSING_OR_INVALID",`${t} controller public key should be a string`)),r}function vl(s){let t=!0;return Jr(s)?s.length&&(t=s.every(r=>Ht(r,!1))):t=!1,t}function pw(s,t,r){let n=null;return Jr(t)&&t.length?t.forEach(o=>{n||Co(o)||(n=It("UNSUPPORTED_CHAINS",`${r}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Co(s)||(n=It("UNSUPPORTED_CHAINS",`${r}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),n}function dw(s,t,r){let n=null;return Object.entries(s).forEach(([o,u])=>{if(n)return;const f=pw(o,Sf(o,u),`${t} ${r}`);f&&(n=f)}),n}function gw(s,t){let r=null;return Jr(s)?s.forEach(n=>{r||cw(n)||(r=It("UNSUPPORTED_ACCOUNTS",`${t}, account ${n} should be a string and conform to "namespace:chainId:address" format`))}):r=It("UNSUPPORTED_ACCOUNTS",`${t}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),r}function yw(s,t){let r=null;return Object.values(s).forEach(n=>{if(r)return;const o=gw(n==null?void 0:n.accounts,`${t} namespace`);o&&(r=o)}),r}function mw(s,t){let r=null;return vl(s==null?void 0:s.methods)?vl(s==null?void 0:s.events)||(r=It("UNSUPPORTED_EVENTS",`${t}, events should be an array of strings or empty array for no events`)):r=It("UNSUPPORTED_METHODS",`${t}, methods should be an array of strings or empty array for no methods`),r}function $f(s,t){let r=null;return Object.values(s).forEach(n=>{if(r)return;const o=mw(n,`${t}, namespace`);o&&(r=o)}),r}function vw(s,t,r){let n=null;if(s&&_n(s)){const o=$f(s,t);o&&(n=o);const u=dw(s,t,r);u&&(n=u)}else n=Z("MISSING_OR_INVALID",`${t}, ${r} should be an object with data`);return n}function xo(s,t){let r=null;if(s&&_n(s)){const n=$f(s,t);n&&(r=n);const o=yw(s,t);o&&(r=o)}else r=Z("MISSING_OR_INVALID",`${t}, namespaces should be an object with data`);return r}function Ff(s){return Ht(s.protocol,!0)}function ww(s,t){let r=!1;return t&&!s?r=!0:s&&Jr(s)&&s.length&&s.forEach(n=>{r=Ff(n)}),r}function bw(s){return typeof s=="number"}function dr(s){return typeof s<"u"&&typeof s!==null}function _w(s){return!(!s||typeof s!="object"||!s.code||!tu(s.code,!1)||!s.message||!Ht(s.message,!1))}function Ew(s){return!(ir(s)||!Ht(s.method,!1))}function Iw(s){return!(ir(s)||ir(s.result)&&ir(s.error)||!tu(s.id,!1)||!Ht(s.jsonrpc,!1))}function xw(s){return!(ir(s)||!Ht(s.name,!1))}function wl(s,t){return!(!Co(t)||!tw(s).includes(t))}function Sw(s,t,r){return Ht(r,!1)?rw(s,t).includes(r):!1}function Pw(s,t,r){return Ht(r,!1)?iw(s,t).includes(r):!1}function bl(s,t,r){let n=null;const o=Ow(s),u=Cw(t),f=Object.keys(o),g=Object.keys(u),v=_l(Object.keys(s)),p=_l(Object.keys(t)),w=v.filter(E=>!p.includes(E));return w.length&&(n=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces keys don't satisfy requiredNamespaces.
      Required: ${w.toString()}
      Received: ${Object.keys(t).toString()}`)),Bi(f,g)||(n=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces chains don't satisfy required namespaces.
      Required: ${f.toString()}
      Approved: ${g.toString()}`)),Object.keys(t).forEach(E=>{if(!E.includes(":")||n)return;const O=xn(t[E].accounts);O.includes(E)||(n=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces accounts don't satisfy namespace accounts for ${E}
        Required: ${E}
        Approved: ${O.toString()}`))}),f.forEach(E=>{n||(Bi(o[E].methods,u[E].methods)?Bi(o[E].events,u[E].events)||(n=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces events don't satisfy namespace events for ${E}`)):n=Z("NON_CONFORMING_NAMESPACES",`${r} namespaces methods don't satisfy namespace methods for ${E}`))}),n}function Ow(s){const t={};return Object.keys(s).forEach(r=>{var n;r.includes(":")?t[r]=s[r]:(n=s[r].chains)==null||n.forEach(o=>{t[o]={methods:s[r].methods,events:s[r].events}})}),t}function _l(s){return[...new Set(s.map(t=>t.includes(":")?t.split(":")[0]:t))]}function Cw(s){const t={};return Object.keys(s).forEach(r=>{if(r.includes(":"))t[r]=s[r];else{const n=xn(s[r].accounts);n==null||n.forEach(o=>{t[o]={accounts:s[r].accounts.filter(u=>u.includes(`${o}:`)),methods:s[r].methods,events:s[r].events}})}}),t}function Aw(s,t){return tu(s,!1)&&s<=t.max&&s>=t.min}function El(){const s=cs();return new Promise(t=>{switch(s){case Er.browser:t(Rw());break;case Er.reactNative:t(Tw());break;case Er.node:t(Nw());break;default:t(!0)}})}function Rw(){return In()&&(navigator==null?void 0:navigator.onLine)}async function Tw(){if(En()&&typeof global<"u"&&global!=null&&global.NetInfo){const s=await(global==null?void 0:global.NetInfo.fetch());return s==null?void 0:s.isConnected}return!0}function Nw(){return!0}function $w(s){switch(cs()){case Er.browser:Fw(s);break;case Er.reactNative:Dw(s);break}}function Fw(s){!En()&&In()&&(window.addEventListener("online",()=>s(!0)),window.addEventListener("offline",()=>s(!1)))}function Dw(s){En()&&typeof global<"u"&&global!=null&&global.NetInfo&&(global==null||global.NetInfo.addEventListener(t=>s(t==null?void 0:t.isConnected)))}const uc={};let mo=class{static get(t){return uc[t]}static set(t,r){uc[t]=r}static delete(t){delete uc[t]}};const jw=/"(?:_|\\u0{2}5[Ff]){2}(?:p|\\u0{2}70)(?:r|\\u0{2}72)(?:o|\\u0{2}6[Ff])(?:t|\\u0{2}74)(?:o|\\u0{2}6[Ff])(?:_|\\u0{2}5[Ff]){2}"\s*:/,Lw=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/,qw=/^\s*["[{]|^\s*-?\d{1,16}(\.\d{1,17})?([Ee][+-]?\d+)?\s*$/;function Mw(s,t){if(s==="__proto__"||s==="constructor"&&t&&typeof t=="object"&&"prototype"in t){Uw(s);return}return t}function Uw(s){console.warn(`[destr] Dropping "${s}" key to prevent prototype pollution.`)}function vo(s,t={}){if(typeof s!="string")return s;const r=s.trim();if(s[0]==='"'&&s.at(-1)==='"'&&!s.includes("\\"))return r.slice(1,-1);if(r.length<=9){const n=r.toLowerCase();if(n==="true")return!0;if(n==="false")return!1;if(n==="undefined")return;if(n==="null")return null;if(n==="nan")return Number.NaN;if(n==="infinity")return Number.POSITIVE_INFINITY;if(n==="-infinity")return Number.NEGATIVE_INFINITY}if(!qw.test(s)){if(t.strict)throw new SyntaxError("[destr] Invalid JSON");return s}try{if(jw.test(s)||Lw.test(s)){if(t.strict)throw new Error("[destr] Possible prototype pollution");return JSON.parse(s,Mw)}return JSON.parse(s)}catch(n){if(t.strict)throw n;return s}}function zw(s){return!s||typeof s.then!="function"?Promise.resolve(s):s}function zt(s,...t){try{return zw(s(...t))}catch(r){return Promise.reject(r)}}function Hw(s){const t=typeof s;return s===null||t!=="object"&&t!=="function"}function kw(s){const t=Object.getPrototypeOf(s);return!t||t.isPrototypeOf(Object)}function So(s){if(Hw(s))return String(s);if(kw(s)||Array.isArray(s))return JSON.stringify(s);if(typeof s.toJSON=="function")return So(s.toJSON());throw new Error("[unstorage] Cannot stringify value!")}function Df(){if(typeof Buffer===void 0)throw new TypeError("[unstorage] Buffer is not supported!")}const Rc="base64:";function Kw(s){if(typeof s=="string")return s;Df();const t=Buffer.from(s).toString("base64");return Rc+t}function Vw(s){return typeof s!="string"||!s.startsWith(Rc)?s:(Df(),Buffer.from(s.slice(Rc.length),"base64"))}function pr(s){return s?s.split("?")[0].replace(/[/\\]/g,":").replace(/:+/g,":").replace(/^:|:$/g,""):""}function Bw(...s){return pr(s.join(":"))}function wo(s){return s=pr(s),s?s+":":""}const Gw="memory",Ww=()=>{const s=new Map;return{name:Gw,options:{},hasItem(t){return s.has(t)},getItem(t){return s.get(t)??null},getItemRaw(t){return s.get(t)??null},setItem(t,r){s.set(t,r)},setItemRaw(t,r){s.set(t,r)},removeItem(t){s.delete(t)},getKeys(){return Array.from(s.keys())},clear(){s.clear()},dispose(){s.clear()}}};function Jw(s={}){const t={mounts:{"":s.driver||Ww()},mountpoints:[""],watching:!1,watchListeners:[],unwatch:{}},r=p=>{for(const w of t.mountpoints)if(p.startsWith(w))return{base:w,relativeKey:p.slice(w.length),driver:t.mounts[w]};return{base:"",relativeKey:p,driver:t.mounts[""]}},n=(p,w)=>t.mountpoints.filter(E=>E.startsWith(p)||w&&p.startsWith(E)).map(E=>({relativeBase:p.length>E.length?p.slice(E.length):void 0,mountpoint:E,driver:t.mounts[E]})),o=(p,w)=>{if(t.watching){w=pr(w);for(const E of t.watchListeners)E(p,w)}},u=async()=>{if(!t.watching){t.watching=!0;for(const p in t.mounts)t.unwatch[p]=await Il(t.mounts[p],o,p)}},f=async()=>{if(t.watching){for(const p in t.unwatch)await t.unwatch[p]();t.unwatch={},t.watching=!1}},g=(p,w,E)=>{const O=new Map,q=D=>{let J=O.get(D.base);return J||(J={driver:D.driver,base:D.base,items:[]},O.set(D.base,J)),J};for(const D of p){const J=typeof D=="string",oe=pr(J?D:D.key),fe=J?void 0:D.value,A=J||!D.options?w:{...w,...D.options},$=r(oe);q($).items.push({key:oe,value:fe,relativeKey:$.relativeKey,options:A})}return Promise.all([...O.values()].map(D=>E(D))).then(D=>D.flat())},v={hasItem(p,w={}){p=pr(p);const{relativeKey:E,driver:O}=r(p);return zt(O.hasItem,E,w)},getItem(p,w={}){p=pr(p);const{relativeKey:E,driver:O}=r(p);return zt(O.getItem,E,w).then(q=>vo(q))},getItems(p,w){return g(p,w,E=>E.driver.getItems?zt(E.driver.getItems,E.items.map(O=>({key:O.relativeKey,options:O.options})),w).then(O=>O.map(q=>({key:Bw(E.base,q.key),value:vo(q.value)}))):Promise.all(E.items.map(O=>zt(E.driver.getItem,O.relativeKey,O.options).then(q=>({key:O.key,value:vo(q)})))))},getItemRaw(p,w={}){p=pr(p);const{relativeKey:E,driver:O}=r(p);return O.getItemRaw?zt(O.getItemRaw,E,w):zt(O.getItem,E,w).then(q=>Vw(q))},async setItem(p,w,E={}){if(w===void 0)return v.removeItem(p);p=pr(p);const{relativeKey:O,driver:q}=r(p);q.setItem&&(await zt(q.setItem,O,So(w),E),q.watch||o("update",p))},async setItems(p,w){await g(p,w,async E=>{E.driver.setItems&&await zt(E.driver.setItems,E.items.map(O=>({key:O.relativeKey,value:So(O.value),options:O.options})),w),E.driver.setItem&&await Promise.all(E.items.map(O=>zt(E.driver.setItem,O.relativeKey,So(O.value),O.options)))})},async setItemRaw(p,w,E={}){if(w===void 0)return v.removeItem(p,E);p=pr(p);const{relativeKey:O,driver:q}=r(p);if(q.setItemRaw)await zt(q.setItemRaw,O,w,E);else if(q.setItem)await zt(q.setItem,O,Kw(w),E);else return;q.watch||o("update",p)},async removeItem(p,w={}){typeof w=="boolean"&&(w={removeMeta:w}),p=pr(p);const{relativeKey:E,driver:O}=r(p);O.removeItem&&(await zt(O.removeItem,E,w),(w.removeMeta||w.removeMata)&&await zt(O.removeItem,E+"$",w),O.watch||o("remove",p))},async getMeta(p,w={}){typeof w=="boolean"&&(w={nativeOnly:w}),p=pr(p);const{relativeKey:E,driver:O}=r(p),q=Object.create(null);if(O.getMeta&&Object.assign(q,await zt(O.getMeta,E,w)),!w.nativeOnly){const D=await zt(O.getItem,E+"$",w).then(J=>vo(J));D&&typeof D=="object"&&(typeof D.atime=="string"&&(D.atime=new Date(D.atime)),typeof D.mtime=="string"&&(D.mtime=new Date(D.mtime)),Object.assign(q,D))}return q},setMeta(p,w,E={}){return this.setItem(p+"$",w,E)},removeMeta(p,w={}){return this.removeItem(p+"$",w)},async getKeys(p,w={}){p=wo(p);const E=n(p,!0);let O=[];const q=[];for(const D of E){const oe=(await zt(D.driver.getKeys,D.relativeBase,w)).map(fe=>D.mountpoint+pr(fe)).filter(fe=>!O.some(A=>fe.startsWith(A)));q.push(...oe),O=[D.mountpoint,...O.filter(fe=>!fe.startsWith(D.mountpoint))]}return p?q.filter(D=>D.startsWith(p)&&!D.endsWith("$")):q.filter(D=>!D.endsWith("$"))},async clear(p,w={}){p=wo(p),await Promise.all(n(p,!1).map(async E=>{if(E.driver.clear)return zt(E.driver.clear,E.relativeBase,w);if(E.driver.removeItem){const O=await E.driver.getKeys(E.relativeBase||"",w);return Promise.all(O.map(q=>E.driver.removeItem(q,w)))}}))},async dispose(){await Promise.all(Object.values(t.mounts).map(p=>xl(p)))},async watch(p){return await u(),t.watchListeners.push(p),async()=>{t.watchListeners=t.watchListeners.filter(w=>w!==p),t.watchListeners.length===0&&await f()}},async unwatch(){t.watchListeners=[],await f()},mount(p,w){if(p=wo(p),p&&t.mounts[p])throw new Error(`already mounted at ${p}`);return p&&(t.mountpoints.push(p),t.mountpoints.sort((E,O)=>O.length-E.length)),t.mounts[p]=w,t.watching&&Promise.resolve(Il(w,o,p)).then(E=>{t.unwatch[p]=E}).catch(console.error),v},async unmount(p,w=!0){p=wo(p),!(!p||!t.mounts[p])&&(t.watching&&p in t.unwatch&&(t.unwatch[p](),delete t.unwatch[p]),w&&await xl(t.mounts[p]),t.mountpoints=t.mountpoints.filter(E=>E!==p),delete t.mounts[p])},getMount(p=""){p=pr(p)+":";const w=r(p);return{driver:w.driver,base:w.base}},getMounts(p="",w={}){return p=pr(p),n(p,w.parents).map(O=>({driver:O.driver,base:O.mountpoint}))}};return v}function Il(s,t,r){return s.watch?s.watch((n,o)=>t(n,r+o)):()=>{}}async function xl(s){typeof s.dispose=="function"&&await zt(s.dispose)}function Wi(s){return new Promise((t,r)=>{s.oncomplete=s.onsuccess=()=>t(s.result),s.onabort=s.onerror=()=>r(s.error)})}function jf(s,t){const r=indexedDB.open(s);r.onupgradeneeded=()=>r.result.createObjectStore(t);const n=Wi(r);return(o,u)=>n.then(f=>u(f.transaction(t,o).objectStore(t)))}let hc;function us(){return hc||(hc=jf("keyval-store","keyval")),hc}function Sl(s,t=us()){return t("readonly",r=>Wi(r.get(s)))}function Qw(s,t,r=us()){return r("readwrite",n=>(n.put(t,s),Wi(n.transaction)))}function Yw(s,t=us()){return t("readwrite",r=>(r.delete(s),Wi(r.transaction)))}function Zw(s=us()){return s("readwrite",t=>(t.clear(),Wi(t.transaction)))}function Xw(s,t){return s.openCursor().onsuccess=function(){this.result&&(t(this.result),this.result.continue())},Wi(s.transaction)}function eb(s=us()){return s("readonly",t=>{if(t.getAllKeys)return Wi(t.getAllKeys());const r=[];return Xw(t,n=>r.push(n.key)).then(()=>r)})}const tb="idb-keyval";var rb=(s={})=>{const t=s.base&&s.base.length>0?`${s.base}:`:"",r=o=>t+o;let n;return s.dbName&&s.storeName&&(n=jf(s.dbName,s.storeName)),{name:tb,options:s,async hasItem(o){return!(typeof await Sl(r(o),n)>"u")},async getItem(o){return await Sl(r(o),n)??null},setItem(o,u){return Qw(r(o),u,n)},removeItem(o){return Yw(r(o),n)},getKeys(){return eb(n)},clear(){return Zw(n)}}};const ib="WALLET_CONNECT_V2_INDEXED_DB",nb="keyvaluestorage";let sb=class{constructor(){this.indexedDb=Jw({driver:rb({dbName:ib,storeName:nb})})}async getKeys(){return this.indexedDb.getKeys()}async getEntries(){return(await this.indexedDb.getItems(await this.indexedDb.getKeys())).map(t=>[t.key,t.value])}async getItem(t){const r=await this.indexedDb.getItem(t);if(r!==null)return r}async setItem(t,r){await this.indexedDb.setItem(t,os(r))}async removeItem(t){await this.indexedDb.removeItem(t)}};var lc=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Po={exports:{}};(function(){let s;function t(){}s=t,s.prototype.getItem=function(r){return this.hasOwnProperty(r)?String(this[r]):null},s.prototype.setItem=function(r,n){this[r]=String(n)},s.prototype.removeItem=function(r){delete this[r]},s.prototype.clear=function(){const r=this;Object.keys(r).forEach(function(n){r[n]=void 0,delete r[n]})},s.prototype.key=function(r){return r=r||0,Object.keys(this)[r]},s.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof lc<"u"&&lc.localStorage?Po.exports=lc.localStorage:typeof window<"u"&&window.localStorage?Po.exports=window.localStorage:Po.exports=new t})();function ob(s){var t;return[s[0],$o((t=s[1])!=null?t:"")]}class ab{constructor(){this.localStorage=Po.exports}async getKeys(){return Object.keys(this.localStorage)}async getEntries(){return Object.entries(this.localStorage).map(ob)}async getItem(t){const r=this.localStorage.getItem(t);if(r!==null)return $o(r)}async setItem(t,r){this.localStorage.setItem(t,os(r))}async removeItem(t){this.localStorage.removeItem(t)}}const cb="wc_storage_version",Pl=1,ub=async(s,t,r)=>{const n=cb,o=await t.getItem(n);if(o&&o>=Pl){r(t);return}const u=await s.getKeys();if(!u.length){r(t);return}const f=[];for(;u.length;){const g=u.shift();if(!g)continue;const v=g.toLowerCase();if(v.includes("wc@")||v.includes("walletconnect")||v.includes("wc_")||v.includes("wallet_connect")){const p=await s.getItem(g);await t.setItem(g,p),f.push(g)}}await t.setItem(n,Pl),r(t),hb(s,f)},hb=async(s,t)=>{t.length&&t.forEach(async r=>{await s.removeItem(r)})};let lb=class{constructor(){this.initialized=!1,this.setInitialized=r=>{this.storage=r,this.initialized=!0};const t=new ab;this.storage=t;try{const r=new sb;ub(t,r,this.setInitialized)}catch{this.initialized=!0}}async getKeys(){return await this.initialize(),this.storage.getKeys()}async getEntries(){return await this.initialize(),this.storage.getEntries()}async getItem(t){return await this.initialize(),this.storage.getItem(t)}async setItem(t,r){return await this.initialize(),this.storage.setItem(t,r)}async removeItem(t){return await this.initialize(),this.storage.removeItem(t)}async initialize(){this.initialized||await new Promise(t=>{const r=setInterval(()=>{this.initialized&&(clearInterval(r),t())},20)})}};var Sn={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Tc=function(s,t){return Tc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},Tc(s,t)};function fb(s,t){Tc(s,t);function r(){this.constructor=s}s.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Nc=function(){return Nc=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},Nc.apply(this,arguments)};function pb(s,t){var r={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&t.indexOf(n)<0&&(r[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(s);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(s,n[o])&&(r[n[o]]=s[n[o]]);return r}function db(s,t,r,n){var o=arguments.length,u=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,t,r,n);else for(var g=s.length-1;g>=0;g--)(f=s[g])&&(u=(o<3?f(u):o>3?f(t,r,u):f(t,r))||u);return o>3&&u&&Object.defineProperty(t,r,u),u}function gb(s,t){return function(r,n){t(r,n,s)}}function yb(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}function mb(s,t,r,n){function o(u){return u instanceof r?u:new r(function(f){f(u)})}return new(r||(r=Promise))(function(u,f){function g(w){try{p(n.next(w))}catch(E){f(E)}}function v(w){try{p(n.throw(w))}catch(E){f(E)}}function p(w){w.done?u(w.value):o(w.value).then(g,v)}p((n=n.apply(s,t||[])).next())})}function vb(s,t){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},n,o,u,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(w){return v([p,w])}}function v(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,o=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(u=r.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){r.label=p[1];break}if(p[0]===6&&r.label<u[1]){r.label=u[1],u=p;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(p);break}u[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(s,r)}catch(w){p=[6,w],o=0}finally{n=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function wb(s,t,r,n){n===void 0&&(n=r),s[n]=t[r]}function bb(s,t){for(var r in s)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=s[r])}function $c(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Lf(s,t){var r=typeof Symbol=="function"&&s[Symbol.iterator];if(!r)return s;var n=r.call(s),o,u=[],f;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)u.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return u}function _b(){for(var s=[],t=0;t<arguments.length;t++)s=s.concat(Lf(arguments[t]));return s}function Eb(){for(var s=0,t=0,r=arguments.length;t<r;t++)s+=arguments[t].length;for(var n=Array(s),o=0,t=0;t<r;t++)for(var u=arguments[t],f=0,g=u.length;f<g;f++,o++)n[o]=u[f];return n}function ns(s){return this instanceof ns?(this.v=s,this):new ns(s)}function Ib(s,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(s,t||[]),o,u=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(O){n[O]&&(o[O]=function(q){return new Promise(function(D,J){u.push([O,q,D,J])>1||g(O,q)})})}function g(O,q){try{v(n[O](q))}catch(D){E(u[0][3],D)}}function v(O){O.value instanceof ns?Promise.resolve(O.value.v).then(p,w):E(u[0][2],O)}function p(O){g("next",O)}function w(O){g("throw",O)}function E(O,q){O(q),u.shift(),u.length&&g(u[0][0],u[0][1])}}function xb(s){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,u){t[o]=s[o]?function(f){return(r=!r)?{value:ns(s[o](f)),done:o==="return"}:u?u(f):f}:u}}function Sb(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=s[Symbol.asyncIterator],r;return t?t.call(s):(s=typeof $c=="function"?$c(s):s[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(u){r[u]=s[u]&&function(f){return new Promise(function(g,v){f=s[u](f),o(g,v,f.done,f.value)})}}function o(u,f,g,v){Promise.resolve(v).then(function(p){u({value:p,done:g})},f)}}function Pb(s,t){return Object.defineProperty?Object.defineProperty(s,"raw",{value:t}):s.raw=t,s}function Ob(s){if(s&&s.__esModule)return s;var t={};if(s!=null)for(var r in s)Object.hasOwnProperty.call(s,r)&&(t[r]=s[r]);return t.default=s,t}function Cb(s){return s&&s.__esModule?s:{default:s}}function Ab(s,t){if(!t.has(s))throw new TypeError("attempted to get private field on non-instance");return t.get(s)}function Rb(s,t,r){if(!t.has(s))throw new TypeError("attempted to set private field on non-instance");return t.set(s,r),r}const Tb=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Nc},__asyncDelegator:xb,__asyncGenerator:Ib,__asyncValues:Sb,__await:ns,__awaiter:mb,__classPrivateFieldGet:Ab,__classPrivateFieldSet:Rb,__createBinding:wb,__decorate:db,__exportStar:bb,__extends:fb,__generator:vb,__importDefault:Cb,__importStar:Ob,__makeTemplateObject:Pb,__metadata:yb,__param:gb,__read:Lf,__rest:pb,__spread:_b,__spreadArrays:Eb,__values:$c},Symbol.toStringTag,{value:"Module"})),Fo=Kc(Tb);var Vn={},fc={},Bn={};class Ji{}const Nb=Object.freeze(Object.defineProperty({__proto__:null,IEvents:Ji},Symbol.toStringTag,{value:"Module"})),$b=Kc(Nb);var Ol;function Fb(){if(Ol)return Bn;Ol=1,Object.defineProperty(Bn,"__esModule",{value:!0}),Bn.IHeartBeat=void 0;const s=$b;class t extends s.IEvents{constructor(n){super()}}return Bn.IHeartBeat=t,Bn}var Cl;function qf(){return Cl||(Cl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),Fo.__exportStar(Fb(),s)}(fc)),fc}var pc={},Ki={},Al;function Db(){if(Al)return Ki;Al=1,Object.defineProperty(Ki,"__esModule",{value:!0}),Ki.HEARTBEAT_EVENTS=Ki.HEARTBEAT_INTERVAL=void 0;const s=se;return Ki.HEARTBEAT_INTERVAL=s.FIVE_SECONDS,Ki.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},Ki}var Rl;function Mf(){return Rl||(Rl=1,function(s){Object.defineProperty(s,"__esModule",{value:!0}),Fo.__exportStar(Db(),s)}(pc)),pc}var Tl;function jb(){if(Tl)return Vn;Tl=1,Object.defineProperty(Vn,"__esModule",{value:!0}),Vn.HeartBeat=void 0;const s=Fo,t=Qr,r=se,n=qf(),o=Mf();class u extends n.IHeartBeat{constructor(g){super(g),this.events=new t.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(g==null?void 0:g.interval)||o.HEARTBEAT_INTERVAL}static init(g){return s.__awaiter(this,void 0,void 0,function*(){const v=new u(g);return yield v.init(),v})}init(){return s.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(g,v){this.events.on(g,v)}once(g,v){this.events.once(g,v)}off(g,v){this.events.off(g,v)}removeListener(g,v){this.events.removeListener(g,v)}initialize(){return s.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),r.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return Vn.HeartBeat=u,Vn}(function(s){Object.defineProperty(s,"__esModule",{value:!0});const t=Fo;t.__exportStar(jb(),s),t.__exportStar(qf(),s),t.__exportStar(Mf(),s)})(Sn);var Ce={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Fc=function(s,t){return Fc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var o in n)n.hasOwnProperty(o)&&(r[o]=n[o])},Fc(s,t)};function Lb(s,t){Fc(s,t);function r(){this.constructor=s}s.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var Dc=function(){return Dc=Object.assign||function(t){for(var r,n=1,o=arguments.length;n<o;n++){r=arguments[n];for(var u in r)Object.prototype.hasOwnProperty.call(r,u)&&(t[u]=r[u])}return t},Dc.apply(this,arguments)};function qb(s,t){var r={};for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&t.indexOf(n)<0&&(r[n]=s[n]);if(s!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,n=Object.getOwnPropertySymbols(s);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(s,n[o])&&(r[n[o]]=s[n[o]]);return r}function Mb(s,t,r,n){var o=arguments.length,u=o<3?t:n===null?n=Object.getOwnPropertyDescriptor(t,r):n,f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")u=Reflect.decorate(s,t,r,n);else for(var g=s.length-1;g>=0;g--)(f=s[g])&&(u=(o<3?f(u):o>3?f(t,r,u):f(t,r))||u);return o>3&&u&&Object.defineProperty(t,r,u),u}function Ub(s,t){return function(r,n){t(r,n,s)}}function zb(s,t){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(s,t)}function Hb(s,t,r,n){function o(u){return u instanceof r?u:new r(function(f){f(u)})}return new(r||(r=Promise))(function(u,f){function g(w){try{p(n.next(w))}catch(E){f(E)}}function v(w){try{p(n.throw(w))}catch(E){f(E)}}function p(w){w.done?u(w.value):o(w.value).then(g,v)}p((n=n.apply(s,t||[])).next())})}function kb(s,t){var r={label:0,sent:function(){if(u[0]&1)throw u[1];return u[1]},trys:[],ops:[]},n,o,u,f;return f={next:g(0),throw:g(1),return:g(2)},typeof Symbol=="function"&&(f[Symbol.iterator]=function(){return this}),f;function g(p){return function(w){return v([p,w])}}function v(p){if(n)throw new TypeError("Generator is already executing.");for(;r;)try{if(n=1,o&&(u=p[0]&2?o.return:p[0]?o.throw||((u=o.return)&&u.call(o),0):o.next)&&!(u=u.call(o,p[1])).done)return u;switch(o=0,u&&(p=[p[0]&2,u.value]),p[0]){case 0:case 1:u=p;break;case 4:return r.label++,{value:p[1],done:!1};case 5:r.label++,o=p[1],p=[0];continue;case 7:p=r.ops.pop(),r.trys.pop();continue;default:if(u=r.trys,!(u=u.length>0&&u[u.length-1])&&(p[0]===6||p[0]===2)){r=0;continue}if(p[0]===3&&(!u||p[1]>u[0]&&p[1]<u[3])){r.label=p[1];break}if(p[0]===6&&r.label<u[1]){r.label=u[1],u=p;break}if(u&&r.label<u[2]){r.label=u[2],r.ops.push(p);break}u[2]&&r.ops.pop(),r.trys.pop();continue}p=t.call(s,r)}catch(w){p=[6,w],o=0}finally{n=u=0}if(p[0]&5)throw p[1];return{value:p[0]?p[1]:void 0,done:!0}}}function Kb(s,t,r,n){n===void 0&&(n=r),s[n]=t[r]}function Vb(s,t){for(var r in s)r!=="default"&&!t.hasOwnProperty(r)&&(t[r]=s[r])}function jc(s){var t=typeof Symbol=="function"&&Symbol.iterator,r=t&&s[t],n=0;if(r)return r.call(s);if(s&&typeof s.length=="number")return{next:function(){return s&&n>=s.length&&(s=void 0),{value:s&&s[n++],done:!s}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Uf(s,t){var r=typeof Symbol=="function"&&s[Symbol.iterator];if(!r)return s;var n=r.call(s),o,u=[],f;try{for(;(t===void 0||t-- >0)&&!(o=n.next()).done;)u.push(o.value)}catch(g){f={error:g}}finally{try{o&&!o.done&&(r=n.return)&&r.call(n)}finally{if(f)throw f.error}}return u}function Bb(){for(var s=[],t=0;t<arguments.length;t++)s=s.concat(Uf(arguments[t]));return s}function Gb(){for(var s=0,t=0,r=arguments.length;t<r;t++)s+=arguments[t].length;for(var n=Array(s),o=0,t=0;t<r;t++)for(var u=arguments[t],f=0,g=u.length;f<g;f++,o++)n[o]=u[f];return n}function ss(s){return this instanceof ss?(this.v=s,this):new ss(s)}function Wb(s,t,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(s,t||[]),o,u=[];return o={},f("next"),f("throw"),f("return"),o[Symbol.asyncIterator]=function(){return this},o;function f(O){n[O]&&(o[O]=function(q){return new Promise(function(D,J){u.push([O,q,D,J])>1||g(O,q)})})}function g(O,q){try{v(n[O](q))}catch(D){E(u[0][3],D)}}function v(O){O.value instanceof ss?Promise.resolve(O.value.v).then(p,w):E(u[0][2],O)}function p(O){g("next",O)}function w(O){g("throw",O)}function E(O,q){O(q),u.shift(),u.length&&g(u[0][0],u[0][1])}}function Jb(s){var t,r;return t={},n("next"),n("throw",function(o){throw o}),n("return"),t[Symbol.iterator]=function(){return this},t;function n(o,u){t[o]=s[o]?function(f){return(r=!r)?{value:ss(s[o](f)),done:o==="return"}:u?u(f):f}:u}}function Qb(s){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=s[Symbol.asyncIterator],r;return t?t.call(s):(s=typeof jc=="function"?jc(s):s[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(u){r[u]=s[u]&&function(f){return new Promise(function(g,v){f=s[u](f),o(g,v,f.done,f.value)})}}function o(u,f,g,v){Promise.resolve(v).then(function(p){u({value:p,done:g})},f)}}function Yb(s,t){return Object.defineProperty?Object.defineProperty(s,"raw",{value:t}):s.raw=t,s}function Zb(s){if(s&&s.__esModule)return s;var t={};if(s!=null)for(var r in s)Object.hasOwnProperty.call(s,r)&&(t[r]=s[r]);return t.default=s,t}function Xb(s){return s&&s.__esModule?s:{default:s}}function e_(s,t){if(!t.has(s))throw new TypeError("attempted to get private field on non-instance");return t.get(s)}function t_(s,t,r){if(!t.has(s))throw new TypeError("attempted to set private field on non-instance");return t.set(s,r),r}const r_=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Dc},__asyncDelegator:Jb,__asyncGenerator:Wb,__asyncValues:Qb,__await:ss,__awaiter:Hb,__classPrivateFieldGet:e_,__classPrivateFieldSet:t_,__createBinding:Kb,__decorate:Mb,__exportStar:Vb,__extends:Lb,__generator:kb,__importDefault:Xb,__importStar:Zb,__makeTemplateObject:Yb,__metadata:zb,__param:Ub,__read:Uf,__rest:qb,__spread:Bb,__spreadArrays:Gb,__values:jc},Symbol.toStringTag,{value:"Module"})),i_=Kc(r_);var dc,Nl;function n_(){if(Nl)return dc;Nl=1;function s(r){try{return JSON.stringify(r)}catch{return'"[Circular]"'}}dc=t;function t(r,n,o){var u=o&&o.stringify||s,f=1;if(typeof r=="object"&&r!==null){var g=n.length+f;if(g===1)return r;var v=new Array(g);v[0]=u(r);for(var p=1;p<g;p++)v[p]=u(n[p]);return v.join(" ")}if(typeof r!="string")return r;var w=n.length;if(w===0)return r;for(var E="",O=1-f,q=-1,D=r&&r.length||0,J=0;J<D;){if(r.charCodeAt(J)===37&&J+1<D){switch(q=q>-1?q:0,r.charCodeAt(J+1)){case 100:case 102:if(O>=w||n[O]==null)break;q<J&&(E+=r.slice(q,J)),E+=Number(n[O]),q=J+2,J++;break;case 105:if(O>=w||n[O]==null)break;q<J&&(E+=r.slice(q,J)),E+=Math.floor(Number(n[O])),q=J+2,J++;break;case 79:case 111:case 106:if(O>=w||n[O]===void 0)break;q<J&&(E+=r.slice(q,J));var oe=typeof n[O];if(oe==="string"){E+="'"+n[O]+"'",q=J+2,J++;break}if(oe==="function"){E+=n[O].name||"<anonymous>",q=J+2,J++;break}E+=u(n[O]),q=J+2,J++;break;case 115:if(O>=w)break;q<J&&(E+=r.slice(q,J)),E+=String(n[O]),q=J+2,J++;break;case 37:q<J&&(E+=r.slice(q,J)),E+="%",q=J+2,J++,O--;break}++O}++J}return q===-1?r:(q<D&&(E+=r.slice(q)),E)}return dc}var gc,$l;function s_(){if($l)return gc;$l=1;const s=n_();gc=o;const t=M().console||{},r={mapHttpRequest:D,mapHttpResponse:D,wrapRequestSerializer:J,wrapResponseSerializer:J,wrapErrorSerializer:J,req:D,res:D,err:O};function n(x,j){return Array.isArray(x)?x.filter(function(ce){return ce!=="!stdSerializers.err"}):x===!0?Object.keys(j):!1}function o(x){x=x||{},x.browser=x.browser||{};const j=x.browser.transmit;if(j&&typeof j.send!="function")throw Error("pino: transmit option must have a send function");const K=x.browser.write||t;x.browser.write&&(x.browser.asObject=!0);const ce=x.serializers||{},ae=n(x.browser.serialize,ce);let Ee=x.browser.serialize;Array.isArray(x.browser.serialize)&&x.browser.serialize.indexOf("!stdSerializers.err")>-1&&(Ee=!1);const Ae=["error","fatal","warn","info","debug","trace"];typeof K=="function"&&(K.error=K.fatal=K.warn=K.info=K.debug=K.trace=K),x.enabled===!1&&(x.level="silent");const et=x.level||"info",N=Object.create(K);N.log||(N.log=oe),Object.defineProperty(N,"levelVal",{get:Me}),Object.defineProperty(N,"level",{get:Re,set:ee});const V={transmit:j,serialize:ae,asObject:x.browser.asObject,levels:Ae,timestamp:q(x)};N.levels=o.levels,N.level=et,N.setMaxListeners=N.getMaxListeners=N.emit=N.addListener=N.on=N.prependListener=N.once=N.prependOnceListener=N.removeListener=N.removeAllListeners=N.listeners=N.listenerCount=N.eventNames=N.write=N.flush=oe,N.serializers=ce,N._serialize=ae,N._stdErrSerialize=Ee,N.child=Q,j&&(N._logEvent=E());function Me(){return this.level==="silent"?1/0:this.levels.values[this.level]}function Re(){return this._level}function ee(W){if(W!=="silent"&&!this.levels.values[W])throw Error("unknown level "+W);this._level=W,u(V,N,"error","log"),u(V,N,"fatal","error"),u(V,N,"warn","error"),u(V,N,"info","log"),u(V,N,"debug","log"),u(V,N,"trace","log")}function Q(W,Y){if(!W)throw new Error("missing bindings for child Pino");Y=Y||{},ae&&W.serializers&&(Y.serializers=W.serializers);const ut=Y.serializers;if(ae&&ut){var He=Object.assign({},ce,ut),zr=x.browser.serialize===!0?Object.keys(He):ae;delete W.serializers,v([W],zr,He,this._stdErrSerialize)}function be(xt){this._childLevel=(xt._childLevel|0)+1,this.error=p(xt,W,"error"),this.fatal=p(xt,W,"fatal"),this.warn=p(xt,W,"warn"),this.info=p(xt,W,"info"),this.debug=p(xt,W,"debug"),this.trace=p(xt,W,"trace"),He&&(this.serializers=He,this._serialize=zr),j&&(this._logEvent=E([].concat(xt._logEvent.bindings,W)))}return be.prototype=this,new be(this)}return N}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=r,o.stdTimeFunctions=Object.assign({},{nullTime:fe,epochTime:A,unixTime:$,isoTime:U});function u(x,j,K,ce){const ae=Object.getPrototypeOf(j);j[K]=j.levelVal>j.levels.values[K]?oe:ae[K]?ae[K]:t[K]||t[ce]||oe,f(x,j,K)}function f(x,j,K){!x.transmit&&j[K]===oe||(j[K]=function(ce){return function(){const Ee=x.timestamp(),Ae=new Array(arguments.length),et=Object.getPrototypeOf&&Object.getPrototypeOf(this)===t?t:this;for(var N=0;N<Ae.length;N++)Ae[N]=arguments[N];if(x.serialize&&!x.asObject&&v(Ae,this._serialize,this.serializers,this._stdErrSerialize),x.asObject?ce.call(et,g(this,K,Ae,Ee)):ce.apply(et,Ae),x.transmit){const V=x.transmit.level||j.level,Me=o.levels.values[V],Re=o.levels.values[K];if(Re<Me)return;w(this,{ts:Ee,methodLevel:K,methodValue:Re,transmitLevel:V,transmitValue:o.levels.values[x.transmit.level||j.level],send:x.transmit.send,val:j.levelVal},Ae)}}}(j[K]))}function g(x,j,K,ce){x._serialize&&v(K,x._serialize,x.serializers,x._stdErrSerialize);const ae=K.slice();let Ee=ae[0];const Ae={};ce&&(Ae.time=ce),Ae.level=o.levels.values[j];let et=(x._childLevel|0)+1;if(et<1&&(et=1),Ee!==null&&typeof Ee=="object"){for(;et--&&typeof ae[0]=="object";)Object.assign(Ae,ae.shift());Ee=ae.length?s(ae.shift(),ae):void 0}else typeof Ee=="string"&&(Ee=s(ae.shift(),ae));return Ee!==void 0&&(Ae.msg=Ee),Ae}function v(x,j,K,ce){for(const ae in x)if(ce&&x[ae]instanceof Error)x[ae]=o.stdSerializers.err(x[ae]);else if(typeof x[ae]=="object"&&!Array.isArray(x[ae]))for(const Ee in x[ae])j&&j.indexOf(Ee)>-1&&Ee in K&&(x[ae][Ee]=K[Ee](x[ae][Ee]))}function p(x,j,K){return function(){const ce=new Array(1+arguments.length);ce[0]=j;for(var ae=1;ae<ce.length;ae++)ce[ae]=arguments[ae-1];return x[K].apply(this,ce)}}function w(x,j,K){const ce=j.send,ae=j.ts,Ee=j.methodLevel,Ae=j.methodValue,et=j.val,N=x._logEvent.bindings;v(K,x._serialize||Object.keys(x.serializers),x.serializers,x._stdErrSerialize===void 0?!0:x._stdErrSerialize),x._logEvent.ts=ae,x._logEvent.messages=K.filter(function(V){return N.indexOf(V)===-1}),x._logEvent.level.label=Ee,x._logEvent.level.value=Ae,ce(Ee,x._logEvent,et),x._logEvent=E(N)}function E(x){return{ts:0,messages:[],bindings:x||[],level:{label:"",value:0}}}function O(x){const j={type:x.constructor.name,msg:x.message,stack:x.stack};for(const K in x)j[K]===void 0&&(j[K]=x[K]);return j}function q(x){return typeof x.timestamp=="function"?x.timestamp:x.timestamp===!1?fe:A}function D(){return{}}function J(x){return x}function oe(){}function fe(){return!1}function A(){return Date.now()}function $(){return Math.round(Date.now()/1e3)}function U(){return new Date(Date.now()).toISOString()}function M(){function x(j){return typeof j<"u"&&j}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return x(self)||x(window)||x(this)||{}}}return gc}var Vi={},Fl;function zf(){return Fl||(Fl=1,Object.defineProperty(Vi,"__esModule",{value:!0}),Vi.PINO_CUSTOM_CONTEXT_KEY=Vi.PINO_LOGGER_DEFAULTS=void 0,Vi.PINO_LOGGER_DEFAULTS={level:"info"},Vi.PINO_CUSTOM_CONTEXT_KEY="custom_context"),Vi}var rr={},Dl;function o_(){if(Dl)return rr;Dl=1,Object.defineProperty(rr,"__esModule",{value:!0}),rr.generateChildLogger=rr.formatChildLoggerContext=rr.getLoggerContext=rr.setBrowserLoggerContext=rr.getBrowserLoggerContext=rr.getDefaultLoggerOptions=void 0;const s=zf();function t(g){return Object.assign(Object.assign({},g),{level:(g==null?void 0:g.level)||s.PINO_LOGGER_DEFAULTS.level})}rr.getDefaultLoggerOptions=t;function r(g,v=s.PINO_CUSTOM_CONTEXT_KEY){return g[v]||""}rr.getBrowserLoggerContext=r;function n(g,v,p=s.PINO_CUSTOM_CONTEXT_KEY){return g[p]=v,g}rr.setBrowserLoggerContext=n;function o(g,v=s.PINO_CUSTOM_CONTEXT_KEY){let p="";return typeof g.bindings>"u"?p=r(g,v):p=g.bindings().context||"",p}rr.getLoggerContext=o;function u(g,v,p=s.PINO_CUSTOM_CONTEXT_KEY){const w=o(g,p);return w.trim()?`${w}/${v}`:v}rr.formatChildLoggerContext=u;function f(g,v,p=s.PINO_CUSTOM_CONTEXT_KEY){const w=u(g,v,p),E=g.child({context:w});return n(E,w,p)}return rr.generateChildLogger=f,rr}(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.pino=void 0;const t=i_,r=t.__importDefault(s_());Object.defineProperty(s,"pino",{enumerable:!0,get:function(){return r.default}}),t.__exportStar(zf(),s),t.__exportStar(o_(),s)})(Ce);class a_ extends Ji{constructor(t){super(),this.opts=t,this.protocol="wc",this.version=2}}let c_=class extends Ji{constructor(t,r){super(),this.core=t,this.logger=r,this.records=new Map}},u_=class{constructor(t,r){this.logger=t,this.core=r}},h_=class extends Ji{constructor(t,r){super(),this.relayer=t,this.logger=r}},l_=class extends Ji{constructor(t){super()}},f_=class{constructor(t,r,n,o){this.core=t,this.logger=r,this.name=n}};class p_ extends Ji{constructor(t,r){super(),this.relayer=t,this.logger=r}}let d_=class extends Ji{constructor(t,r){super(),this.core=t,this.logger=r}},g_=class{constructor(t,r){this.projectId=t,this.logger=r}},y_=class{constructor(t){this.opts=t,this.protocol="wc",this.version=2}},m_=class{constructor(t){this.client=t}};var ru={},Hf={};(function(s){Object.defineProperty(s,"__esModule",{value:!0});var t=c1,r=_f;s.DIGEST_LENGTH=64,s.BLOCK_SIZE=128;var n=function(){function g(){this.digestLength=s.DIGEST_LENGTH,this.blockSize=s.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return g.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},g.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},g.prototype.clean=function(){r.wipe(this._buffer),r.wipe(this._tempHi),r.wipe(this._tempLo),this.reset()},g.prototype.update=function(v,p){if(p===void 0&&(p=v.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var w=0;if(this._bytesHashed+=p,this._bufferLength>0){for(;this._bufferLength<s.BLOCK_SIZE&&p>0;)this._buffer[this._bufferLength++]=v[w++],p--;this._bufferLength===this.blockSize&&(u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(p>=this.blockSize&&(w=u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,v,w,p),p%=this.blockSize);p>0;)this._buffer[this._bufferLength++]=v[w++],p--;return this},g.prototype.finish=function(v){if(!this._finished){var p=this._bytesHashed,w=this._bufferLength,E=p/536870912|0,O=p<<3,q=p%128<112?128:256;this._buffer[w]=128;for(var D=w+1;D<q-8;D++)this._buffer[D]=0;t.writeUint32BE(E,this._buffer,q-8),t.writeUint32BE(O,this._buffer,q-4),u(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,q),this._finished=!0}for(var D=0;D<this.digestLength/8;D++)t.writeUint32BE(this._stateHi[D],v,D*8),t.writeUint32BE(this._stateLo[D],v,D*8+4);return this},g.prototype.digest=function(){var v=new Uint8Array(this.digestLength);return this.finish(v),v},g.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},g.prototype.restoreState=function(v){return this._stateHi.set(v.stateHi),this._stateLo.set(v.stateLo),this._bufferLength=v.bufferLength,v.buffer&&this._buffer.set(v.buffer),this._bytesHashed=v.bytesHashed,this._finished=!1,this},g.prototype.cleanSavedState=function(v){r.wipe(v.stateHi),r.wipe(v.stateLo),v.buffer&&r.wipe(v.buffer),v.bufferLength=0,v.bytesHashed=0},g}();s.SHA512=n;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function u(g,v,p,w,E,O,q){for(var D=p[0],J=p[1],oe=p[2],fe=p[3],A=p[4],$=p[5],U=p[6],M=p[7],x=w[0],j=w[1],K=w[2],ce=w[3],ae=w[4],Ee=w[5],Ae=w[6],et=w[7],N,V,Me,Re,ee,Q,W,Y;q>=128;){for(var ut=0;ut<16;ut++){var He=8*ut+O;g[ut]=t.readUint32BE(E,He),v[ut]=t.readUint32BE(E,He+4)}for(var ut=0;ut<80;ut++){var zr=D,be=J,xt=oe,L=fe,F=A,R=$,h=U,I=M,ie=x,pe=j,ve=K,Te=ce,$e=ae,xe=Ee,St=Ae,vt=et;if(N=M,V=et,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=(A>>>14|ae<<32-14)^(A>>>18|ae<<32-18)^(ae>>>41-32|A<<32-(41-32)),V=(ae>>>14|A<<32-14)^(ae>>>18|A<<32-18)^(A>>>41-32|ae<<32-(41-32)),ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,N=A&$^~A&U,V=ae&Ee^~ae&Ae,ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,N=o[ut*2],V=o[ut*2+1],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,N=g[ut%16],V=v[ut%16],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,Me=W&65535|Y<<16,Re=ee&65535|Q<<16,N=Me,V=Re,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=(D>>>28|x<<32-28)^(x>>>34-32|D<<32-(34-32))^(x>>>39-32|D<<32-(39-32)),V=(x>>>28|D<<32-28)^(D>>>34-32|x<<32-(34-32))^(D>>>39-32|x<<32-(39-32)),ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,N=D&J^D&oe^J&oe,V=x&j^x&K^j&K,ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,I=W&65535|Y<<16,vt=ee&65535|Q<<16,N=L,V=Te,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=Me,V=Re,ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,L=W&65535|Y<<16,Te=ee&65535|Q<<16,J=zr,oe=be,fe=xt,A=L,$=F,U=R,M=h,D=I,j=ie,K=pe,ce=ve,ae=Te,Ee=$e,Ae=xe,et=St,x=vt,ut%16===15)for(var He=0;He<16;He++)N=g[He],V=v[He],ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=g[(He+9)%16],V=v[(He+9)%16],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Me=g[(He+1)%16],Re=v[(He+1)%16],N=(Me>>>1|Re<<32-1)^(Me>>>8|Re<<32-8)^Me>>>7,V=(Re>>>1|Me<<32-1)^(Re>>>8|Me<<32-8)^(Re>>>7|Me<<32-7),ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Me=g[(He+14)%16],Re=v[(He+14)%16],N=(Me>>>19|Re<<32-19)^(Re>>>61-32|Me<<32-(61-32))^Me>>>6,V=(Re>>>19|Me<<32-19)^(Me>>>61-32|Re<<32-(61-32))^(Re>>>6|Me<<32-6),ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,g[He]=W&65535|Y<<16,v[He]=ee&65535|Q<<16}N=D,V=x,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=p[0],V=w[0],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,p[0]=D=W&65535|Y<<16,w[0]=x=ee&65535|Q<<16,N=J,V=j,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=p[1],V=w[1],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,p[1]=J=W&65535|Y<<16,w[1]=j=ee&65535|Q<<16,N=oe,V=K,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=p[2],V=w[2],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,p[2]=oe=W&65535|Y<<16,w[2]=K=ee&65535|Q<<16,N=fe,V=ce,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=p[3],V=w[3],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,p[3]=fe=W&65535|Y<<16,w[3]=ce=ee&65535|Q<<16,N=A,V=ae,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=p[4],V=w[4],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,p[4]=A=W&65535|Y<<16,w[4]=ae=ee&65535|Q<<16,N=$,V=Ee,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=p[5],V=w[5],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,p[5]=$=W&65535|Y<<16,w[5]=Ee=ee&65535|Q<<16,N=U,V=Ae,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=p[6],V=w[6],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,p[6]=U=W&65535|Y<<16,w[6]=Ae=ee&65535|Q<<16,N=M,V=et,ee=V&65535,Q=V>>>16,W=N&65535,Y=N>>>16,N=p[7],V=w[7],ee+=V&65535,Q+=V>>>16,W+=N&65535,Y+=N>>>16,Q+=ee>>>16,W+=Q>>>16,Y+=W>>>16,p[7]=M=W&65535|Y<<16,w[7]=et=ee&65535|Q<<16,O+=128,q-=128}return O}function f(g){var v=new n;v.update(g);var p=v.digest();return v.clean(),p}s.hash=f})(Hf);(function(s){Object.defineProperty(s,"__esModule",{value:!0}),s.convertSecretKeyToX25519=s.convertPublicKeyToX25519=s.verify=s.sign=s.extractPublicKeyFromSecretKey=s.generateKeyPair=s.generateKeyPairFromSeed=s.SEED_LENGTH=s.SECRET_KEY_LENGTH=s.PUBLIC_KEY_LENGTH=s.SIGNATURE_LENGTH=void 0;const t=No,r=Hf,n=_f;s.SIGNATURE_LENGTH=64,s.PUBLIC_KEY_LENGTH=32,s.SECRET_KEY_LENGTH=64,s.SEED_LENGTH=32;function o(L){const F=new Float64Array(16);if(L)for(let R=0;R<L.length;R++)F[R]=L[R];return F}const u=new Uint8Array(32);u[0]=9;const f=o(),g=o([1]),v=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),p=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),w=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),E=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),O=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function q(L,F){for(let R=0;R<16;R++)L[R]=F[R]|0}function D(L){let F=1;for(let R=0;R<16;R++){let h=L[R]+F+65535;F=Math.floor(h/65536),L[R]=h-F*65536}L[0]+=F-1+37*(F-1)}function J(L,F,R){const h=~(R-1);for(let I=0;I<16;I++){const ie=h&(L[I]^F[I]);L[I]^=ie,F[I]^=ie}}function oe(L,F){const R=o(),h=o();for(let I=0;I<16;I++)h[I]=F[I];D(h),D(h),D(h);for(let I=0;I<2;I++){R[0]=h[0]-65517;for(let pe=1;pe<15;pe++)R[pe]=h[pe]-65535-(R[pe-1]>>16&1),R[pe-1]&=65535;R[15]=h[15]-32767-(R[14]>>16&1);const ie=R[15]>>16&1;R[14]&=65535,J(h,R,1-ie)}for(let I=0;I<16;I++)L[2*I]=h[I]&255,L[2*I+1]=h[I]>>8}function fe(L,F){let R=0;for(let h=0;h<32;h++)R|=L[h]^F[h];return(1&R-1>>>8)-1}function A(L,F){const R=new Uint8Array(32),h=new Uint8Array(32);return oe(R,L),oe(h,F),fe(R,h)}function $(L){const F=new Uint8Array(32);return oe(F,L),F[0]&1}function U(L,F){for(let R=0;R<16;R++)L[R]=F[2*R]+(F[2*R+1]<<8);L[15]&=32767}function M(L,F,R){for(let h=0;h<16;h++)L[h]=F[h]+R[h]}function x(L,F,R){for(let h=0;h<16;h++)L[h]=F[h]-R[h]}function j(L,F,R){let h,I,ie=0,pe=0,ve=0,Te=0,$e=0,xe=0,St=0,vt=0,st=0,De=0,Je=0,Qe=0,ot=0,Ue=0,Ye=0,Ne=0,ke=0,ht=0,Le=0,Pt=0,Dt=0,kt=0,Kt=0,qt=0,Qt=0,or=0,Hr=0,Yt=0,Yr=0,di=0,Ri=0,lt=R[0],tt=R[1],ft=R[2],pt=R[3],at=R[4],rt=R[5],Ot=R[6],Ct=R[7],dt=R[8],At=R[9],gt=R[10],wt=R[11],yt=R[12],We=R[13],Rt=R[14],Tt=R[15];h=F[0],ie+=h*lt,pe+=h*tt,ve+=h*ft,Te+=h*pt,$e+=h*at,xe+=h*rt,St+=h*Ot,vt+=h*Ct,st+=h*dt,De+=h*At,Je+=h*gt,Qe+=h*wt,ot+=h*yt,Ue+=h*We,Ye+=h*Rt,Ne+=h*Tt,h=F[1],pe+=h*lt,ve+=h*tt,Te+=h*ft,$e+=h*pt,xe+=h*at,St+=h*rt,vt+=h*Ot,st+=h*Ct,De+=h*dt,Je+=h*At,Qe+=h*gt,ot+=h*wt,Ue+=h*yt,Ye+=h*We,Ne+=h*Rt,ke+=h*Tt,h=F[2],ve+=h*lt,Te+=h*tt,$e+=h*ft,xe+=h*pt,St+=h*at,vt+=h*rt,st+=h*Ot,De+=h*Ct,Je+=h*dt,Qe+=h*At,ot+=h*gt,Ue+=h*wt,Ye+=h*yt,Ne+=h*We,ke+=h*Rt,ht+=h*Tt,h=F[3],Te+=h*lt,$e+=h*tt,xe+=h*ft,St+=h*pt,vt+=h*at,st+=h*rt,De+=h*Ot,Je+=h*Ct,Qe+=h*dt,ot+=h*At,Ue+=h*gt,Ye+=h*wt,Ne+=h*yt,ke+=h*We,ht+=h*Rt,Le+=h*Tt,h=F[4],$e+=h*lt,xe+=h*tt,St+=h*ft,vt+=h*pt,st+=h*at,De+=h*rt,Je+=h*Ot,Qe+=h*Ct,ot+=h*dt,Ue+=h*At,Ye+=h*gt,Ne+=h*wt,ke+=h*yt,ht+=h*We,Le+=h*Rt,Pt+=h*Tt,h=F[5],xe+=h*lt,St+=h*tt,vt+=h*ft,st+=h*pt,De+=h*at,Je+=h*rt,Qe+=h*Ot,ot+=h*Ct,Ue+=h*dt,Ye+=h*At,Ne+=h*gt,ke+=h*wt,ht+=h*yt,Le+=h*We,Pt+=h*Rt,Dt+=h*Tt,h=F[6],St+=h*lt,vt+=h*tt,st+=h*ft,De+=h*pt,Je+=h*at,Qe+=h*rt,ot+=h*Ot,Ue+=h*Ct,Ye+=h*dt,Ne+=h*At,ke+=h*gt,ht+=h*wt,Le+=h*yt,Pt+=h*We,Dt+=h*Rt,kt+=h*Tt,h=F[7],vt+=h*lt,st+=h*tt,De+=h*ft,Je+=h*pt,Qe+=h*at,ot+=h*rt,Ue+=h*Ot,Ye+=h*Ct,Ne+=h*dt,ke+=h*At,ht+=h*gt,Le+=h*wt,Pt+=h*yt,Dt+=h*We,kt+=h*Rt,Kt+=h*Tt,h=F[8],st+=h*lt,De+=h*tt,Je+=h*ft,Qe+=h*pt,ot+=h*at,Ue+=h*rt,Ye+=h*Ot,Ne+=h*Ct,ke+=h*dt,ht+=h*At,Le+=h*gt,Pt+=h*wt,Dt+=h*yt,kt+=h*We,Kt+=h*Rt,qt+=h*Tt,h=F[9],De+=h*lt,Je+=h*tt,Qe+=h*ft,ot+=h*pt,Ue+=h*at,Ye+=h*rt,Ne+=h*Ot,ke+=h*Ct,ht+=h*dt,Le+=h*At,Pt+=h*gt,Dt+=h*wt,kt+=h*yt,Kt+=h*We,qt+=h*Rt,Qt+=h*Tt,h=F[10],Je+=h*lt,Qe+=h*tt,ot+=h*ft,Ue+=h*pt,Ye+=h*at,Ne+=h*rt,ke+=h*Ot,ht+=h*Ct,Le+=h*dt,Pt+=h*At,Dt+=h*gt,kt+=h*wt,Kt+=h*yt,qt+=h*We,Qt+=h*Rt,or+=h*Tt,h=F[11],Qe+=h*lt,ot+=h*tt,Ue+=h*ft,Ye+=h*pt,Ne+=h*at,ke+=h*rt,ht+=h*Ot,Le+=h*Ct,Pt+=h*dt,Dt+=h*At,kt+=h*gt,Kt+=h*wt,qt+=h*yt,Qt+=h*We,or+=h*Rt,Hr+=h*Tt,h=F[12],ot+=h*lt,Ue+=h*tt,Ye+=h*ft,Ne+=h*pt,ke+=h*at,ht+=h*rt,Le+=h*Ot,Pt+=h*Ct,Dt+=h*dt,kt+=h*At,Kt+=h*gt,qt+=h*wt,Qt+=h*yt,or+=h*We,Hr+=h*Rt,Yt+=h*Tt,h=F[13],Ue+=h*lt,Ye+=h*tt,Ne+=h*ft,ke+=h*pt,ht+=h*at,Le+=h*rt,Pt+=h*Ot,Dt+=h*Ct,kt+=h*dt,Kt+=h*At,qt+=h*gt,Qt+=h*wt,or+=h*yt,Hr+=h*We,Yt+=h*Rt,Yr+=h*Tt,h=F[14],Ye+=h*lt,Ne+=h*tt,ke+=h*ft,ht+=h*pt,Le+=h*at,Pt+=h*rt,Dt+=h*Ot,kt+=h*Ct,Kt+=h*dt,qt+=h*At,Qt+=h*gt,or+=h*wt,Hr+=h*yt,Yt+=h*We,Yr+=h*Rt,di+=h*Tt,h=F[15],Ne+=h*lt,ke+=h*tt,ht+=h*ft,Le+=h*pt,Pt+=h*at,Dt+=h*rt,kt+=h*Ot,Kt+=h*Ct,qt+=h*dt,Qt+=h*At,or+=h*gt,Hr+=h*wt,Yt+=h*yt,Yr+=h*We,di+=h*Rt,Ri+=h*Tt,ie+=38*ke,pe+=38*ht,ve+=38*Le,Te+=38*Pt,$e+=38*Dt,xe+=38*kt,St+=38*Kt,vt+=38*qt,st+=38*Qt,De+=38*or,Je+=38*Hr,Qe+=38*Yt,ot+=38*Yr,Ue+=38*di,Ye+=38*Ri,I=1,h=ie+I+65535,I=Math.floor(h/65536),ie=h-I*65536,h=pe+I+65535,I=Math.floor(h/65536),pe=h-I*65536,h=ve+I+65535,I=Math.floor(h/65536),ve=h-I*65536,h=Te+I+65535,I=Math.floor(h/65536),Te=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=xe+I+65535,I=Math.floor(h/65536),xe=h-I*65536,h=St+I+65535,I=Math.floor(h/65536),St=h-I*65536,h=vt+I+65535,I=Math.floor(h/65536),vt=h-I*65536,h=st+I+65535,I=Math.floor(h/65536),st=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,h=Je+I+65535,I=Math.floor(h/65536),Je=h-I*65536,h=Qe+I+65535,I=Math.floor(h/65536),Qe=h-I*65536,h=ot+I+65535,I=Math.floor(h/65536),ot=h-I*65536,h=Ue+I+65535,I=Math.floor(h/65536),Ue=h-I*65536,h=Ye+I+65535,I=Math.floor(h/65536),Ye=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,ie+=I-1+37*(I-1),I=1,h=ie+I+65535,I=Math.floor(h/65536),ie=h-I*65536,h=pe+I+65535,I=Math.floor(h/65536),pe=h-I*65536,h=ve+I+65535,I=Math.floor(h/65536),ve=h-I*65536,h=Te+I+65535,I=Math.floor(h/65536),Te=h-I*65536,h=$e+I+65535,I=Math.floor(h/65536),$e=h-I*65536,h=xe+I+65535,I=Math.floor(h/65536),xe=h-I*65536,h=St+I+65535,I=Math.floor(h/65536),St=h-I*65536,h=vt+I+65535,I=Math.floor(h/65536),vt=h-I*65536,h=st+I+65535,I=Math.floor(h/65536),st=h-I*65536,h=De+I+65535,I=Math.floor(h/65536),De=h-I*65536,h=Je+I+65535,I=Math.floor(h/65536),Je=h-I*65536,h=Qe+I+65535,I=Math.floor(h/65536),Qe=h-I*65536,h=ot+I+65535,I=Math.floor(h/65536),ot=h-I*65536,h=Ue+I+65535,I=Math.floor(h/65536),Ue=h-I*65536,h=Ye+I+65535,I=Math.floor(h/65536),Ye=h-I*65536,h=Ne+I+65535,I=Math.floor(h/65536),Ne=h-I*65536,ie+=I-1+37*(I-1),L[0]=ie,L[1]=pe,L[2]=ve,L[3]=Te,L[4]=$e,L[5]=xe,L[6]=St,L[7]=vt,L[8]=st,L[9]=De,L[10]=Je,L[11]=Qe,L[12]=ot,L[13]=Ue,L[14]=Ye,L[15]=Ne}function K(L,F){j(L,F,F)}function ce(L,F){const R=o();let h;for(h=0;h<16;h++)R[h]=F[h];for(h=253;h>=0;h--)K(R,R),h!==2&&h!==4&&j(R,R,F);for(h=0;h<16;h++)L[h]=R[h]}function ae(L,F){const R=o();let h;for(h=0;h<16;h++)R[h]=F[h];for(h=250;h>=0;h--)K(R,R),h!==1&&j(R,R,F);for(h=0;h<16;h++)L[h]=R[h]}function Ee(L,F){const R=o(),h=o(),I=o(),ie=o(),pe=o(),ve=o(),Te=o(),$e=o(),xe=o();x(R,L[1],L[0]),x(xe,F[1],F[0]),j(R,R,xe),M(h,L[0],L[1]),M(xe,F[0],F[1]),j(h,h,xe),j(I,L[3],F[3]),j(I,I,p),j(ie,L[2],F[2]),M(ie,ie,ie),x(pe,h,R),x(ve,ie,I),M(Te,ie,I),M($e,h,R),j(L[0],pe,ve),j(L[1],$e,Te),j(L[2],Te,ve),j(L[3],pe,$e)}function Ae(L,F,R){for(let h=0;h<4;h++)J(L[h],F[h],R)}function et(L,F){const R=o(),h=o(),I=o();ce(I,F[2]),j(R,F[0],I),j(h,F[1],I),oe(L,h),L[31]^=$(R)<<7}function N(L,F,R){q(L[0],f),q(L[1],g),q(L[2],g),q(L[3],f);for(let h=255;h>=0;--h){const I=R[h/8|0]>>(h&7)&1;Ae(L,F,I),Ee(F,L),Ee(L,L),Ae(L,F,I)}}function V(L,F){const R=[o(),o(),o(),o()];q(R[0],w),q(R[1],E),q(R[2],g),j(R[3],w,E),N(L,R,F)}function Me(L){if(L.length!==s.SEED_LENGTH)throw new Error(`ed25519: seed must be ${s.SEED_LENGTH} bytes`);const F=(0,r.hash)(L);F[0]&=248,F[31]&=127,F[31]|=64;const R=new Uint8Array(32),h=[o(),o(),o(),o()];V(h,F),et(R,h);const I=new Uint8Array(64);return I.set(L),I.set(R,32),{publicKey:R,secretKey:I}}s.generateKeyPairFromSeed=Me;function Re(L){const F=(0,t.randomBytes)(32,L),R=Me(F);return(0,n.wipe)(F),R}s.generateKeyPair=Re;function ee(L){if(L.length!==s.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${s.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(L.subarray(32))}s.extractPublicKeyFromSecretKey=ee;const Q=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function W(L,F){let R,h,I,ie;for(h=63;h>=32;--h){for(R=0,I=h-32,ie=h-12;I<ie;++I)F[I]+=R-16*F[h]*Q[I-(h-32)],R=Math.floor((F[I]+128)/256),F[I]-=R*256;F[I]+=R,F[h]=0}for(R=0,I=0;I<32;I++)F[I]+=R-(F[31]>>4)*Q[I],R=F[I]>>8,F[I]&=255;for(I=0;I<32;I++)F[I]-=R*Q[I];for(h=0;h<32;h++)F[h+1]+=F[h]>>8,L[h]=F[h]&255}function Y(L){const F=new Float64Array(64);for(let R=0;R<64;R++)F[R]=L[R];for(let R=0;R<64;R++)L[R]=0;W(L,F)}function ut(L,F){const R=new Float64Array(64),h=[o(),o(),o(),o()],I=(0,r.hash)(L.subarray(0,32));I[0]&=248,I[31]&=127,I[31]|=64;const ie=new Uint8Array(64);ie.set(I.subarray(32),32);const pe=new r.SHA512;pe.update(ie.subarray(32)),pe.update(F);const ve=pe.digest();pe.clean(),Y(ve),V(h,ve),et(ie,h),pe.reset(),pe.update(ie.subarray(0,32)),pe.update(L.subarray(32)),pe.update(F);const Te=pe.digest();Y(Te);for(let $e=0;$e<32;$e++)R[$e]=ve[$e];for(let $e=0;$e<32;$e++)for(let xe=0;xe<32;xe++)R[$e+xe]+=Te[$e]*I[xe];return W(ie.subarray(32),R),ie}s.sign=ut;function He(L,F){const R=o(),h=o(),I=o(),ie=o(),pe=o(),ve=o(),Te=o();return q(L[2],g),U(L[1],F),K(I,L[1]),j(ie,I,v),x(I,I,L[2]),M(ie,L[2],ie),K(pe,ie),K(ve,pe),j(Te,ve,pe),j(R,Te,I),j(R,R,ie),ae(R,R),j(R,R,I),j(R,R,ie),j(R,R,ie),j(L[0],R,ie),K(h,L[0]),j(h,h,ie),A(h,I)&&j(L[0],L[0],O),K(h,L[0]),j(h,h,ie),A(h,I)?-1:($(L[0])===F[31]>>7&&x(L[0],f,L[0]),j(L[3],L[0],L[1]),0)}function zr(L,F,R){const h=new Uint8Array(32),I=[o(),o(),o(),o()],ie=[o(),o(),o(),o()];if(R.length!==s.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${s.SIGNATURE_LENGTH} bytes`);if(He(ie,L))return!1;const pe=new r.SHA512;pe.update(R.subarray(0,32)),pe.update(L),pe.update(F);const ve=pe.digest();return Y(ve),N(I,ie,ve),V(ie,R.subarray(32)),Ee(I,ie),et(h,I),!fe(R,h)}s.verify=zr;function be(L){let F=[o(),o(),o(),o()];if(He(F,L))throw new Error("Ed25519: invalid public key");let R=o(),h=o(),I=F[1];M(R,g,I),x(h,g,I),ce(h,h),j(R,R,h);let ie=new Uint8Array(32);return oe(ie,R),ie}s.convertPublicKeyToX25519=be;function xt(L){const F=(0,r.hash)(L.subarray(0,32));F[0]&=248,F[31]&=127,F[31]|=64;const R=new Uint8Array(F.subarray(0,32));return(0,n.wipe)(F),R}s.convertSecretKeyToX25519=xt})(ru);const v_="EdDSA",w_="JWT",kf=".",Kf="base64url",b_="utf8",__="utf8",E_=":",I_="did",x_="key",jl="base58btc",S_="z",P_="K36",O_=32;function Ao(s){return sr(gr(os(s),b_),Kf)}function Vf(s){const t=gr(P_,jl),r=S_+sr(Sc([t,s]),jl);return[I_,x_,r].join(E_)}function C_(s){return sr(s,Kf)}function A_(s){return gr([Ao(s.header),Ao(s.payload)].join(kf),__)}function R_(s){return[Ao(s.header),Ao(s.payload),C_(s.signature)].join(kf)}function Ll(s=No.randomBytes(O_)){return ru.generateKeyPairFromSeed(s)}async function T_(s,t,r,n,o=se.fromMiliseconds(Date.now())){const u={alg:v_,typ:w_},f=Vf(n.publicKey),g=o+r,v={iss:f,sub:s,aud:t,iat:o,exp:g},p=A_({header:u,payload:v}),w=ru.sign(n.secretKey,p);return R_({header:u,payload:v,signature:w})}const N_=()=>typeof WebSocket<"u"?WebSocket:typeof global<"u"&&typeof global.WebSocket<"u"?global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),$_=()=>typeof WebSocket<"u"||typeof global<"u"&&typeof global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",ql=s=>s.split("?")[0],Ml=10,F_=N_();let D_=class{constructor(t){if(this.url=t,this.events=new Qr.EventEmitter,this.registering=!1,!al(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);this.url=t}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async open(t=this.url){await this.register(t)}async close(){return new Promise((t,r)=>{if(typeof this.socket>"u"){r(new Error("Connection already closed"));return}this.socket.onclose=n=>{this.onClose(n),t()},this.socket.close()})}async send(t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(os(t))}catch(r){this.onError(t.id,r)}}register(t=this.url){if(!al(t))throw new Error(`Provided URL is not compatible with WebSocket connection: ${t}`);if(this.registering){const r=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=r||this.events.listenerCount("open")>=r)&&this.events.setMaxListeners(r+1),new Promise((n,o)=>{this.events.once("register_error",u=>{this.resetMaxListeners(),o(u)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));n(this.socket)})})}return this.url=t,this.registering=!0,new Promise((r,n)=>{const o=new URLSearchParams(t).get("origin"),u=f1.isReactNative()?{headers:{origin:o}}:{rejectUnauthorized:!p1(t)},f=new F_(t,[],u);$_()?f.onerror=g=>{const v=g;n(this.emitError(v.error))}:f.on("error",g=>{n(this.emitError(g))}),f.onopen=()=>{this.onOpen(f),r(f)}})}onOpen(t){t.onmessage=r=>this.onPayload(r),t.onclose=r=>this.onClose(r),this.socket=t,this.registering=!1,this.events.emit("open")}onClose(t){this.socket=void 0,this.registering=!1,this.events.emit("close",t)}onPayload(t){if(typeof t.data>"u")return;const r=typeof t.data=="string"?$o(t.data):t.data;this.events.emit("payload",r)}onError(t,r){const n=this.parseError(r),o=n.message||n.toString(),u=Bc(t,o);this.events.emit("payload",u)}parseError(t,r=this.url){return d1(t,ql(r),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Ml&&this.events.setMaxListeners(Ml)}emitError(t){const r=this.parseError(new Error((t==null?void 0:t.message)||`WebSocket connection failed for host: ${ql(this.url)}`));return this.events.emit("register_error",r),r}};var Ro={exports:{}};Ro.exports;(function(s,t){var r=200,n="__lodash_hash_undefined__",o=1,u=2,f=9007199254740991,g="[object Arguments]",v="[object Array]",p="[object AsyncFunction]",w="[object Boolean]",E="[object Date]",O="[object Error]",q="[object Function]",D="[object GeneratorFunction]",J="[object Map]",oe="[object Number]",fe="[object Null]",A="[object Object]",$="[object Promise]",U="[object Proxy]",M="[object RegExp]",x="[object Set]",j="[object String]",K="[object Symbol]",ce="[object Undefined]",ae="[object WeakMap]",Ee="[object ArrayBuffer]",Ae="[object DataView]",et="[object Float32Array]",N="[object Float64Array]",V="[object Int8Array]",Me="[object Int16Array]",Re="[object Int32Array]",ee="[object Uint8Array]",Q="[object Uint8ClampedArray]",W="[object Uint16Array]",Y="[object Uint32Array]",ut=/[\\^$.*+?()[\]{}|]/g,He=/^\[object .+?Constructor\]$/,zr=/^(?:0|[1-9]\d*)$/,be={};be[et]=be[N]=be[V]=be[Me]=be[Re]=be[ee]=be[Q]=be[W]=be[Y]=!0,be[g]=be[v]=be[Ee]=be[w]=be[Ae]=be[E]=be[O]=be[q]=be[J]=be[oe]=be[A]=be[M]=be[x]=be[j]=be[ae]=!1;var xt=typeof yo=="object"&&yo&&yo.Object===Object&&yo,L=typeof self=="object"&&self&&self.Object===Object&&self,F=xt||L||Function("return this")(),R=t&&!t.nodeType&&t,h=R&&!0&&s&&!s.nodeType&&s,I=h&&h.exports===R,ie=I&&xt.process,pe=function(){try{return ie&&ie.binding&&ie.binding("util")}catch{}}(),ve=pe&&pe.isTypedArray;function Te(m,S){for(var B=-1,te=m==null?0:m.length,Ve=0,ge=[];++B<te;){var Ze=m[B];S(Ze,B,m)&&(ge[Ve++]=Ze)}return ge}function $e(m,S){for(var B=-1,te=S.length,Ve=m.length;++B<te;)m[Ve+B]=S[B];return m}function xe(m,S){for(var B=-1,te=m==null?0:m.length;++B<te;)if(S(m[B],B,m))return!0;return!1}function St(m,S){for(var B=-1,te=Array(m);++B<m;)te[B]=S(B);return te}function vt(m){return function(S){return m(S)}}function st(m,S){return m.has(S)}function De(m,S){return m==null?void 0:m[S]}function Je(m){var S=-1,B=Array(m.size);return m.forEach(function(te,Ve){B[++S]=[Ve,te]}),B}function Qe(m,S){return function(B){return m(S(B))}}function ot(m){var S=-1,B=Array(m.size);return m.forEach(function(te){B[++S]=te}),B}var Ue=Array.prototype,Ye=Function.prototype,Ne=Object.prototype,ke=F["__core-js_shared__"],ht=Ye.toString,Le=Ne.hasOwnProperty,Pt=function(){var m=/[^.]+$/.exec(ke&&ke.keys&&ke.keys.IE_PROTO||"");return m?"Symbol(src)_1."+m:""}(),Dt=Ne.toString,kt=RegExp("^"+ht.call(Le).replace(ut,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Kt=I?F.Buffer:void 0,qt=F.Symbol,Qt=F.Uint8Array,or=Ne.propertyIsEnumerable,Hr=Ue.splice,Yt=qt?qt.toStringTag:void 0,Yr=Object.getOwnPropertySymbols,di=Kt?Kt.isBuffer:void 0,Ri=Qe(Object.keys,Object),lt=yr(F,"DataView"),tt=yr(F,"Map"),ft=yr(F,"Promise"),pt=yr(F,"Set"),at=yr(F,"WeakMap"),rt=yr(Object,"create"),Ot=Xr(lt),Ct=Xr(tt),dt=Xr(ft),At=Xr(pt),gt=Xr(at),wt=qt?qt.prototype:void 0,yt=wt?wt.valueOf:void 0;function We(m){var S=-1,B=m==null?0:m.length;for(this.clear();++S<B;){var te=m[S];this.set(te[0],te[1])}}function Rt(){this.__data__=rt?rt(null):{},this.size=0}function Tt(m){var S=this.has(m)&&delete this.__data__[m];return this.size-=S?1:0,S}function Lo(m){var S=this.__data__;if(rt){var B=S[m];return B===n?void 0:B}return Le.call(S,m)?S[m]:void 0}function qo(m){var S=this.__data__;return rt?S[m]!==void 0:Le.call(S,m)}function Mo(m,S){var B=this.__data__;return this.size+=this.has(m)?0:1,B[m]=rt&&S===void 0?n:S,this}We.prototype.clear=Rt,We.prototype.delete=Tt,We.prototype.get=Lo,We.prototype.has=qo,We.prototype.set=Mo;function Ir(m){var S=-1,B=m==null?0:m.length;for(this.clear();++S<B;){var te=m[S];this.set(te[0],te[1])}}function Uo(){this.__data__=[],this.size=0}function zo(m){var S=this.__data__,B=Ti(S,m);if(B<0)return!1;var te=S.length-1;return B==te?S.pop():Hr.call(S,B,1),--this.size,!0}function Ho(m){var S=this.__data__,B=Ti(S,m);return B<0?void 0:S[B][1]}function ko(m){return Ti(this.__data__,m)>-1}function Ko(m,S){var B=this.__data__,te=Ti(B,m);return te<0?(++this.size,B.push([m,S])):B[te][1]=S,this}Ir.prototype.clear=Uo,Ir.prototype.delete=zo,Ir.prototype.get=Ho,Ir.prototype.has=ko,Ir.prototype.set=Ko;function Zr(m){var S=-1,B=m==null?0:m.length;for(this.clear();++S<B;){var te=m[S];this.set(te[0],te[1])}}function Yi(){this.size=0,this.__data__={hash:new We,map:new(tt||Ir),string:new We}}function Vo(m){var S=gi(this,m).delete(m);return this.size-=S?1:0,S}function Zi(m){return gi(this,m).get(m)}function Bo(m){return gi(this,m).has(m)}function Go(m,S){var B=gi(this,m),te=B.size;return B.set(m,S),this.size+=B.size==te?0:1,this}Zr.prototype.clear=Yi,Zr.prototype.delete=Vo,Zr.prototype.get=Zi,Zr.prototype.has=Bo,Zr.prototype.set=Go;function Xi(m){var S=-1,B=m==null?0:m.length;for(this.__data__=new Zr;++S<B;)this.add(m[S])}function ls(m){return this.__data__.set(m,n),this}function fs(m){return this.__data__.has(m)}Xi.prototype.add=Xi.prototype.push=ls,Xi.prototype.has=fs;function $r(m){var S=this.__data__=new Ir(m);this.size=S.size}function Wo(){this.__data__=new Ir,this.size=0}function Jo(m){var S=this.__data__,B=S.delete(m);return this.size=S.size,B}function Qo(m){return this.__data__.get(m)}function Yo(m){return this.__data__.has(m)}function ps(m,S){var B=this.__data__;if(B instanceof Ir){var te=B.__data__;if(!tt||te.length<r-1)return te.push([m,S]),this.size=++B.size,this;B=this.__data__=new Zr(te)}return B.set(m,S),this.size=B.size,this}$r.prototype.clear=Wo,$r.prototype.delete=Jo,$r.prototype.get=Qo,$r.prototype.has=Yo,$r.prototype.set=ps;function ds(m,S){var B=rn(m),te=!B&&Ps(m),Ve=!B&&!te&&Cn(m),ge=!B&&!te&&!Ve&&As(m),Ze=B||te||Ve||ge,Nt=Ze?St(m.length,String):[],Pe=Nt.length;for(var Be in m)(S||Le.call(m,Be))&&!(Ze&&(Be=="length"||Ve&&(Be=="offset"||Be=="parent")||ge&&(Be=="buffer"||Be=="byteLength"||Be=="byteOffset")||_s(Be,Pe)))&&Nt.push(Be);return Nt}function Ti(m,S){for(var B=m.length;B--;)if(Ss(m[B][0],S))return B;return-1}function Pn(m,S,B){var te=S(m);return rn(m)?te:$e(te,B(m))}function Ni(m){return m==null?m===void 0?ce:fe:Yt&&Yt in Object(m)?ws(m):ea(m)}function On(m){return Fi(m)&&Ni(m)==g}function $i(m,S,B,te,Ve){return m===S?!0:m==null||S==null||!Fi(m)&&!Fi(S)?m!==m&&S!==S:gs(m,S,B,te,$i,Ve)}function gs(m,S,B,te,Ve,ge){var Ze=rn(m),Nt=rn(S),Pe=Ze?v:kr(m),Be=Nt?v:kr(S);Pe=Pe==g?A:Pe,Be=Be==g?A:Be;var bt=Pe==A,ar=Be==A,$t=Pe==Be;if($t&&Cn(m)){if(!Cn(S))return!1;Ze=!0,bt=!1}if($t&&!bt)return ge||(ge=new $r),Ze||As(m)?en(m,S,B,te,Ve,ge):Xo(m,S,Pe,B,te,Ve,ge);if(!(B&o)){var Xe=bt&&Le.call(m,"__wrapped__"),Zt=ar&&Le.call(S,"__wrapped__");if(Xe||Zt){var Fr=Xe?m.value():m,xr=Zt?S.value():S;return ge||(ge=new $r),Ve(Fr,xr,B,te,ge)}}return $t?(ge||(ge=new $r),vs(m,S,B,te,Ve,ge)):!1}function Zo(m){if(!Cs(m)||Is(m))return!1;var S=nn(m)?kt:He;return S.test(Xr(m))}function ys(m){return Fi(m)&&Os(m.length)&&!!be[Ni(m)]}function ms(m){if(!xs(m))return Ri(m);var S=[];for(var B in Object(m))Le.call(m,B)&&B!="constructor"&&S.push(B);return S}function en(m,S,B,te,Ve,ge){var Ze=B&o,Nt=m.length,Pe=S.length;if(Nt!=Pe&&!(Ze&&Pe>Nt))return!1;var Be=ge.get(m);if(Be&&ge.get(S))return Be==S;var bt=-1,ar=!0,$t=B&u?new Xi:void 0;for(ge.set(m,S),ge.set(S,m);++bt<Nt;){var Xe=m[bt],Zt=S[bt];if(te)var Fr=Ze?te(Zt,Xe,bt,S,m,ge):te(Xe,Zt,bt,m,S,ge);if(Fr!==void 0){if(Fr)continue;ar=!1;break}if($t){if(!xe(S,function(xr,Kr){if(!st($t,Kr)&&(Xe===xr||Ve(Xe,xr,B,te,ge)))return $t.push(Kr)})){ar=!1;break}}else if(!(Xe===Zt||Ve(Xe,Zt,B,te,ge))){ar=!1;break}}return ge.delete(m),ge.delete(S),ar}function Xo(m,S,B,te,Ve,ge,Ze){switch(B){case Ae:if(m.byteLength!=S.byteLength||m.byteOffset!=S.byteOffset)return!1;m=m.buffer,S=S.buffer;case Ee:return!(m.byteLength!=S.byteLength||!ge(new Qt(m),new Qt(S)));case w:case E:case oe:return Ss(+m,+S);case O:return m.name==S.name&&m.message==S.message;case M:case j:return m==S+"";case J:var Nt=Je;case x:var Pe=te&o;if(Nt||(Nt=ot),m.size!=S.size&&!Pe)return!1;var Be=Ze.get(m);if(Be)return Be==S;te|=u,Ze.set(m,S);var bt=en(Nt(m),Nt(S),te,Ve,ge,Ze);return Ze.delete(m),bt;case K:if(yt)return yt.call(m)==yt.call(S)}return!1}function vs(m,S,B,te,Ve,ge){var Ze=B&o,Nt=tn(m),Pe=Nt.length,Be=tn(S),bt=Be.length;if(Pe!=bt&&!Ze)return!1;for(var ar=Pe;ar--;){var $t=Nt[ar];if(!(Ze?$t in S:Le.call(S,$t)))return!1}var Xe=ge.get(m);if(Xe&&ge.get(S))return Xe==S;var Zt=!0;ge.set(m,S),ge.set(S,m);for(var Fr=Ze;++ar<Pe;){$t=Nt[ar];var xr=m[$t],Kr=S[$t];if(te)var An=Ze?te(Kr,xr,$t,S,m,ge):te(xr,Kr,$t,m,S,ge);if(!(An===void 0?xr===Kr||Ve(xr,Kr,B,te,ge):An)){Zt=!1;break}Fr||(Fr=$t=="constructor")}if(Zt&&!Fr){var Di=m.constructor,Mt=S.constructor;Di!=Mt&&"constructor"in m&&"constructor"in S&&!(typeof Di=="function"&&Di instanceof Di&&typeof Mt=="function"&&Mt instanceof Mt)&&(Zt=!1)}return ge.delete(m),ge.delete(S),Zt}function tn(m){return Pn(m,ia,bs)}function gi(m,S){var B=m.__data__;return Es(S)?B[typeof S=="string"?"string":"hash"]:B.map}function yr(m,S){var B=De(m,S);return Zo(B)?B:void 0}function ws(m){var S=Le.call(m,Yt),B=m[Yt];try{m[Yt]=void 0;var te=!0}catch{}var Ve=Dt.call(m);return te&&(S?m[Yt]=B:delete m[Yt]),Ve}var bs=Yr?function(m){return m==null?[]:(m=Object(m),Te(Yr(m),function(S){return or.call(m,S)}))}:Ke,kr=Ni;(lt&&kr(new lt(new ArrayBuffer(1)))!=Ae||tt&&kr(new tt)!=J||ft&&kr(ft.resolve())!=$||pt&&kr(new pt)!=x||at&&kr(new at)!=ae)&&(kr=function(m){var S=Ni(m),B=S==A?m.constructor:void 0,te=B?Xr(B):"";if(te)switch(te){case Ot:return Ae;case Ct:return J;case dt:return $;case At:return x;case gt:return ae}return S});function _s(m,S){return S=S??f,!!S&&(typeof m=="number"||zr.test(m))&&m>-1&&m%1==0&&m<S}function Es(m){var S=typeof m;return S=="string"||S=="number"||S=="symbol"||S=="boolean"?m!=="__proto__":m===null}function Is(m){return!!Pt&&Pt in m}function xs(m){var S=m&&m.constructor,B=typeof S=="function"&&S.prototype||Ne;return m===B}function ea(m){return Dt.call(m)}function Xr(m){if(m!=null){try{return ht.call(m)}catch{}try{return m+""}catch{}}return""}function Ss(m,S){return m===S||m!==m&&S!==S}var Ps=On(function(){return arguments}())?On:function(m){return Fi(m)&&Le.call(m,"callee")&&!or.call(m,"callee")},rn=Array.isArray;function ta(m){return m!=null&&Os(m.length)&&!nn(m)}var Cn=di||ze;function ra(m,S){return $i(m,S)}function nn(m){if(!Cs(m))return!1;var S=Ni(m);return S==q||S==D||S==p||S==U}function Os(m){return typeof m=="number"&&m>-1&&m%1==0&&m<=f}function Cs(m){var S=typeof m;return m!=null&&(S=="object"||S=="function")}function Fi(m){return m!=null&&typeof m=="object"}var As=ve?vt(ve):ys;function ia(m){return ta(m)?ds(m):ms(m)}function Ke(){return[]}function ze(){return!1}s.exports=ra})(Ro,Ro.exports);var j_=Ro.exports;const L_=u1(j_);function q_(s,t){if(s.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var o=0;o<s.length;o++){var u=s.charAt(o),f=u.charCodeAt(0);if(r[f]!==255)throw new TypeError(u+" is ambiguous");r[f]=o}var g=s.length,v=s.charAt(0),p=Math.log(g)/Math.log(256),w=Math.log(256)/Math.log(g);function E(D){if(D instanceof Uint8Array||(ArrayBuffer.isView(D)?D=new Uint8Array(D.buffer,D.byteOffset,D.byteLength):Array.isArray(D)&&(D=Uint8Array.from(D))),!(D instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(D.length===0)return"";for(var J=0,oe=0,fe=0,A=D.length;fe!==A&&D[fe]===0;)fe++,J++;for(var $=(A-fe)*w+1>>>0,U=new Uint8Array($);fe!==A;){for(var M=D[fe],x=0,j=$-1;(M!==0||x<oe)&&j!==-1;j--,x++)M+=256*U[j]>>>0,U[j]=M%g>>>0,M=M/g>>>0;if(M!==0)throw new Error("Non-zero carry");oe=x,fe++}for(var K=$-oe;K!==$&&U[K]===0;)K++;for(var ce=v.repeat(J);K<$;++K)ce+=s.charAt(U[K]);return ce}function O(D){if(typeof D!="string")throw new TypeError("Expected String");if(D.length===0)return new Uint8Array;var J=0;if(D[J]!==" "){for(var oe=0,fe=0;D[J]===v;)oe++,J++;for(var A=(D.length-J)*p+1>>>0,$=new Uint8Array(A);D[J];){var U=r[D.charCodeAt(J)];if(U===255)return;for(var M=0,x=A-1;(U!==0||M<fe)&&x!==-1;x--,M++)U+=g*$[x]>>>0,$[x]=U%256>>>0,U=U/256>>>0;if(U!==0)throw new Error("Non-zero carry");fe=M,J++}if(D[J]!==" "){for(var j=A-fe;j!==A&&$[j]===0;)j++;for(var K=new Uint8Array(oe+(A-j)),ce=oe;j!==A;)K[ce++]=$[j++];return K}}}function q(D){var J=O(D);if(J)return J;throw new Error(`Non-${t} character`)}return{encode:E,decodeUnsafe:O,decode:q}}var M_=q_,U_=M_;const Bf=s=>{if(s instanceof Uint8Array&&s.constructor.name==="Uint8Array")return s;if(s instanceof ArrayBuffer)return new Uint8Array(s);if(ArrayBuffer.isView(s))return new Uint8Array(s.buffer,s.byteOffset,s.byteLength);throw new Error("Unknown type, must be binary type")},z_=s=>new TextEncoder().encode(s),H_=s=>new TextDecoder().decode(s);class k_{constructor(t,r,n){this.name=t,this.prefix=r,this.baseEncode=n}encode(t){if(t instanceof Uint8Array)return`${this.prefix}${this.baseEncode(t)}`;throw Error("Unknown type, must be binary type")}}class K_{constructor(t,r,n){if(this.name=t,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(t){if(typeof t=="string"){if(t.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(t)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(t.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(t){return Gf(this,t)}}let V_=class{constructor(t){this.decoders=t}or(t){return Gf(this,t)}decode(t){const r=t[0],n=this.decoders[r];if(n)return n.decode(t);throw RangeError(`Unable to decode multibase string ${JSON.stringify(t)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};const Gf=(s,t)=>new V_({...s.decoders||{[s.prefix]:s},...t.decoders||{[t.prefix]:t}});class B_{constructor(t,r,n,o){this.name=t,this.prefix=r,this.baseEncode=n,this.baseDecode=o,this.encoder=new k_(t,r,n),this.decoder=new K_(t,r,o)}encode(t){return this.encoder.encode(t)}decode(t){return this.decoder.decode(t)}}const Do=({name:s,prefix:t,encode:r,decode:n})=>new B_(s,t,r,n),hs=({prefix:s,name:t,alphabet:r})=>{const{encode:n,decode:o}=U_(r,t);return Do({prefix:s,name:t,encode:n,decode:u=>Bf(o(u))})},G_=(s,t,r,n)=>{const o={};for(let w=0;w<t.length;++w)o[t[w]]=w;let u=s.length;for(;s[u-1]==="=";)--u;const f=new Uint8Array(u*r/8|0);let g=0,v=0,p=0;for(let w=0;w<u;++w){const E=o[s[w]];if(E===void 0)throw new SyntaxError(`Non-${n} character`);v=v<<r|E,g+=r,g>=8&&(g-=8,f[p++]=255&v>>g)}if(g>=r||255&v<<8-g)throw new SyntaxError("Unexpected end of data");return f},W_=(s,t,r)=>{const n=t[t.length-1]==="=",o=(1<<r)-1;let u="",f=0,g=0;for(let v=0;v<s.length;++v)for(g=g<<8|s[v],f+=8;f>r;)f-=r,u+=t[o&g>>f];if(f&&(u+=t[o&g<<r-f]),n)for(;u.length*r&7;)u+="=";return u},Bt=({name:s,prefix:t,bitsPerChar:r,alphabet:n})=>Do({prefix:t,name:s,encode(o){return W_(o,n,r)},decode(o){return G_(o,n,r,s)}}),J_=Do({prefix:"\0",name:"identity",encode:s=>H_(s),decode:s=>z_(s)});var Q_=Object.freeze({__proto__:null,identity:J_});const Y_=Bt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var Z_=Object.freeze({__proto__:null,base2:Y_});const X_=Bt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var eE=Object.freeze({__proto__:null,base8:X_});const tE=hs({prefix:"9",name:"base10",alphabet:"0123456789"});var rE=Object.freeze({__proto__:null,base10:tE});const iE=Bt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),nE=Bt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var sE=Object.freeze({__proto__:null,base16:iE,base16upper:nE});const oE=Bt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),aE=Bt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),cE=Bt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),uE=Bt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),hE=Bt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),lE=Bt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),fE=Bt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),pE=Bt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),dE=Bt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var gE=Object.freeze({__proto__:null,base32:oE,base32upper:aE,base32pad:cE,base32padupper:uE,base32hex:hE,base32hexupper:lE,base32hexpad:fE,base32hexpadupper:pE,base32z:dE});const yE=hs({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),mE=hs({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var vE=Object.freeze({__proto__:null,base36:yE,base36upper:mE});const wE=hs({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),bE=hs({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var _E=Object.freeze({__proto__:null,base58btc:wE,base58flickr:bE});const EE=Bt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),IE=Bt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),xE=Bt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),SE=Bt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var PE=Object.freeze({__proto__:null,base64:EE,base64pad:IE,base64url:xE,base64urlpad:SE});const Wf=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),OE=Wf.reduce((s,t,r)=>(s[r]=t,s),[]),CE=Wf.reduce((s,t,r)=>(s[t.codePointAt(0)]=r,s),[]);function AE(s){return s.reduce((t,r)=>(t+=OE[r],t),"")}function RE(s){const t=[];for(const r of s){const n=CE[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);t.push(n)}return new Uint8Array(t)}const TE=Do({prefix:"🚀",name:"base256emoji",encode:AE,decode:RE});var NE=Object.freeze({__proto__:null,base256emoji:TE}),$E=Jf,Ul=128,FE=127,DE=~FE,jE=Math.pow(2,31);function Jf(s,t,r){t=t||[],r=r||0;for(var n=r;s>=jE;)t[r++]=s&255|Ul,s/=128;for(;s&DE;)t[r++]=s&255|Ul,s>>>=7;return t[r]=s|0,Jf.bytes=r-n+1,t}var LE=Lc,qE=128,zl=127;function Lc(s,n){var r=0,n=n||0,o=0,u=n,f,g=s.length;do{if(u>=g)throw Lc.bytes=0,new RangeError("Could not decode varint");f=s[u++],r+=o<28?(f&zl)<<o:(f&zl)*Math.pow(2,o),o+=7}while(f>=qE);return Lc.bytes=u-n,r}var ME=Math.pow(2,7),UE=Math.pow(2,14),zE=Math.pow(2,21),HE=Math.pow(2,28),kE=Math.pow(2,35),KE=Math.pow(2,42),VE=Math.pow(2,49),BE=Math.pow(2,56),GE=Math.pow(2,63),WE=function(s){return s<ME?1:s<UE?2:s<zE?3:s<HE?4:s<kE?5:s<KE?6:s<VE?7:s<BE?8:s<GE?9:10},JE={encode:$E,decode:LE,encodingLength:WE},Qf=JE;const Hl=(s,t,r=0)=>(Qf.encode(s,t,r),t),kl=s=>Qf.encodingLength(s),qc=(s,t)=>{const r=t.byteLength,n=kl(s),o=n+kl(r),u=new Uint8Array(o+r);return Hl(s,u,0),Hl(r,u,n),u.set(t,o),new QE(s,r,t,u)};class QE{constructor(t,r,n,o){this.code=t,this.size=r,this.digest=n,this.bytes=o}}const Yf=({name:s,code:t,encode:r})=>new YE(s,t,r);class YE{constructor(t,r,n){this.name=t,this.code=r,this.encode=n}digest(t){if(t instanceof Uint8Array){const r=this.encode(t);return r instanceof Uint8Array?qc(this.code,r):r.then(n=>qc(this.code,n))}else throw Error("Unknown type, must be binary type")}}const Zf=s=>async t=>new Uint8Array(await crypto.subtle.digest(s,t)),ZE=Yf({name:"sha2-256",code:18,encode:Zf("SHA-256")}),XE=Yf({name:"sha2-512",code:19,encode:Zf("SHA-512")});var eI=Object.freeze({__proto__:null,sha256:ZE,sha512:XE});const Xf=0,tI="identity",ep=Bf,rI=s=>qc(Xf,ep(s)),iI={code:Xf,name:tI,encode:ep,digest:rI};var nI=Object.freeze({__proto__:null,identity:iI});new TextEncoder,new TextDecoder;const Kl={...Q_,...Z_,...eE,...rE,...sE,...gE,...vE,..._E,...PE,...NE};({...eI,...nI});function tp(s){return globalThis.Buffer!=null?new Uint8Array(s.buffer,s.byteOffset,s.byteLength):s}function sI(s=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?tp(globalThis.Buffer.allocUnsafe(s)):new Uint8Array(s)}function rp(s,t,r,n){return{name:s,prefix:t,encoder:{name:s,prefix:t,encode:r},decoder:{decode:n}}}const Vl=rp("utf8","u",s=>"u"+new TextDecoder("utf8").decode(s),s=>new TextEncoder().encode(s.substring(1))),yc=rp("ascii","a",s=>{let t="a";for(let r=0;r<s.length;r++)t+=String.fromCharCode(s[r]);return t},s=>{s=s.substring(1);const t=sI(s.length);for(let r=0;r<s.length;r++)t[r]=s.charCodeAt(r);return t}),oI={utf8:Vl,"utf-8":Vl,hex:Kl.base16,latin1:yc,ascii:yc,binary:yc,...Kl};function aI(s,t="utf8"){const r=oI[t];if(!r)throw new Error(`Unsupported encoding "${t}"`);return(t==="utf8"||t==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?tp(globalThis.Buffer.from(s,"utf-8")):r.decoder.decode(`${r.prefix}${s}`)}const ip="wc",cI=2,iu="core",Oi=`${ip}@2:${iu}:`,uI={name:iu,logger:"error"},hI={database:":memory:"},lI="crypto",Bl="client_ed25519_seed",fI=se.ONE_DAY,pI="keychain",dI="0.3",gI="messages",yI="0.3",mI=se.SIX_HOURS,vI="publisher",np="irn",wI="error",sp="wss://relay.walletconnect.com",Gl="wss://relay.walletconnect.org",bI="relayer",Jt={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},_I="_subscription",ui={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},EI=se.ONE_SECOND,II="2.10.6",xI=1e4,SI="0.3",PI="WALLETCONNECT_CLIENT_ID",Mr={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},OI="subscription",CI="0.3",AI=se.FIVE_SECONDS*1e3,RI="pairing",TI="0.3",Gn={wc_pairingDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:se.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:se.ONE_DAY,prompt:!1,tag:0},res:{ttl:se.ONE_DAY,prompt:!1,tag:0}}},Xn={create:"pairing_create",expire:"pairing_expire",delete:"pairing_delete",ping:"pairing_ping"},Wr={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},NI="history",$I="0.3",FI="expirer",Nr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},DI="0.3",mc="verify-api",wn="https://verify.walletconnect.com",Mc="https://verify.walletconnect.org",jI=[wn,Mc];class LI{constructor(t,r){this.core=t,this.logger=r,this.keychain=new Map,this.name=pI,this.version=dI,this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{if(!this.initialized){const n=await this.getKeyChain();typeof n<"u"&&(this.keychain=n),this.initialized=!0}},this.has=n=>(this.isInitialized(),this.keychain.has(n)),this.set=async(n,o)=>{this.isInitialized(),this.keychain.set(n,o),await this.persist()},this.get=n=>{this.isInitialized();const o=this.keychain.get(n);if(typeof o>"u"){const{message:u}=Z("NO_MATCHING_KEY",`${this.name}: ${n}`);throw new Error(u)}return o},this.del=async n=>{this.isInitialized(),this.keychain.delete(n),await this.persist()},this.core=t,this.logger=Ce.generateChildLogger(r,this.name)}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setKeyChain(t){await this.core.storage.setItem(this.storageKey,Af(t))}async getKeyChain(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Rf(t):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class qI{constructor(t,r,n){this.core=t,this.logger=r,this.name=lI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),u=Ll(o);return Vf(u.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=E1();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const u=await this.getClientSeed(),f=Ll(u),g=Cc();return await T_(g,o,fI,f)},this.generateSharedKey=(o,u,f)=>{this.isInitialized();const g=this.getPrivateKey(o),v=I1(g,u);return this.setSymKey(v,f)},this.setSymKey=async(o,u)=>{this.isInitialized();const f=u||x1(o);return await this.keychain.set(f,o),f},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,u,f)=>{this.isInitialized();const g=Cf(f),v=os(u);if(ll(g)){const O=g.senderPublicKey,q=g.receiverPublicKey;o=await this.generateSharedKey(O,q)}const p=this.getSymKey(o),{type:w,senderPublicKey:E}=g;return P1({type:w,symKey:p,message:v,senderPublicKey:E})},this.decode=async(o,u,f)=>{this.isInitialized();const g=A1(u,f);if(ll(g)){const v=g.receiverPublicKey,p=g.senderPublicKey;o=await this.generateSharedKey(v,p)}try{const v=this.getSymKey(o),p=O1({symKey:v,encoded:u});return $o(p)}catch(v){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(v)}},this.getPayloadType=o=>{const u=Oo(o);return as(u.type)},this.getPayloadSenderPublicKey=o=>{const u=Oo(o);return u.senderPublicKey?sr(u.senderPublicKey,nr):void 0},this.core=t,this.logger=Ce.generateChildLogger(r,this.name),this.keychain=n||new LI(this.core,this.logger)}get context(){return Ce.getLoggerContext(this.logger)}async setPrivateKey(t,r){return await this.keychain.set(t,r),t}getPrivateKey(t){return this.keychain.get(t)}async getClientSeed(){let t="";try{t=this.keychain.get(Bl)}catch{t=Cc(),await this.keychain.set(Bl,t)}return aI(t,"base16")}getSymKey(t){return this.keychain.get(t)}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class MI extends u_{constructor(t,r){super(t,r),this.logger=t,this.core=r,this.messages=new Map,this.name=gI,this.version=yI,this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const n=await this.getRelayerMessages();typeof n<"u"&&(this.messages=n),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(n){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(n)}finally{this.initialized=!0}}},this.set=async(n,o)=>{this.isInitialized();const u=bn(o);let f=this.messages.get(n);return typeof f>"u"&&(f={}),typeof f[u]<"u"||(f[u]=o,this.messages.set(n,f),await this.persist()),u},this.get=n=>{this.isInitialized();let o=this.messages.get(n);return typeof o>"u"&&(o={}),o},this.has=(n,o)=>{this.isInitialized();const u=this.get(n),f=bn(o);return typeof u[f]<"u"},this.del=async n=>{this.isInitialized(),this.messages.delete(n),await this.persist()},this.logger=Ce.generateChildLogger(t,this.name),this.core=r}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}async setRelayerMessages(t){await this.core.storage.setItem(this.storageKey,Af(t))}async getRelayerMessages(){const t=await this.core.storage.getItem(this.storageKey);return typeof t<"u"?Rf(t):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class UI extends h_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.events=new Qr.EventEmitter,this.name=vI,this.queue=new Map,this.publishTimeout=se.toMiliseconds(se.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(n,o,u)=>{var f;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:u}});try{const g=(u==null?void 0:u.ttl)||mI,v=Ac(u),p=(u==null?void 0:u.prompt)||!1,w=(u==null?void 0:u.tag)||0,E=(u==null?void 0:u.id)||g1().toString(),O={topic:n,message:o,opts:{ttl:g,relay:v,prompt:p,tag:w,id:E}},q=setTimeout(()=>this.queue.set(E,O),this.publishTimeout);try{await await is(this.rpcPublish(n,o,g,v,p,w,E),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(E),this.relayer.events.emit(Jt.publish,O)}catch(D){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(f=u==null?void 0:u.internal)!=null&&f.throwOnFailedPublish)throw this.removeRequestFromQueue(E),D;return}finally{clearTimeout(q)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:n,message:o,opts:u}})}catch(g){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(g),g}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.relayer=t,this.logger=Ce.generateChildLogger(r,this.name),this.registerEventListeners()}get context(){return Ce.getLoggerContext(this.logger)}rpcPublish(t,r,n,o,u,f,g){var v,p,w,E;const O={method:Io(o.protocol).publish,params:{topic:t,message:r,ttl:n,prompt:u,tag:f},id:g};return ir((v=O.params)==null?void 0:v.prompt)&&((p=O.params)==null||delete p.prompt),ir((w=O.params)==null?void 0:w.tag)&&((E=O.params)==null||delete E.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:O}),this.relayer.request(O)}removeRequestFromQueue(t){this.queue.delete(t)}checkQueue(){this.queue.forEach(async t=>{const{topic:r,message:n,opts:o}=t;await this.publish(r,n,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(Sn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(Jt.connection_stalled);return}this.checkQueue()}),this.relayer.on(Jt.message_ack,t=>{this.removeRequestFromQueue(t.id.toString())})}}class zI{constructor(){this.map=new Map,this.set=(t,r)=>{const n=this.get(t);this.exists(t,r)||this.map.set(t,[...n,r])},this.get=t=>this.map.get(t)||[],this.exists=(t,r)=>this.get(t).includes(r),this.delete=(t,r)=>{if(typeof r>"u"){this.map.delete(t);return}if(!this.map.has(t))return;const n=this.get(t);if(!this.exists(t,r))return;const o=n.filter(u=>u!==r);if(!o.length){this.map.delete(t);return}this.map.set(t,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var HI=Object.defineProperty,kI=Object.defineProperties,KI=Object.getOwnPropertyDescriptors,Wl=Object.getOwnPropertySymbols,VI=Object.prototype.hasOwnProperty,BI=Object.prototype.propertyIsEnumerable,Jl=(s,t,r)=>t in s?HI(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Wn=(s,t)=>{for(var r in t||(t={}))VI.call(t,r)&&Jl(s,r,t[r]);if(Wl)for(var r of Wl(t))BI.call(t,r)&&Jl(s,r,t[r]);return s},vc=(s,t)=>kI(s,KI(t));class GI extends p_{constructor(t,r){super(t,r),this.relayer=t,this.logger=r,this.subscriptions=new Map,this.topicMap=new zI,this.events=new Qr.EventEmitter,this.name=OI,this.version=CI,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Oi,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}});try{const u=Ac(o),f={topic:n,relay:u};this.pending.set(n,f);const g=await this.rpcSubscribe(n,u);return this.onSubscribe(g,f),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:n,opts:o}}),g}catch(u){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(u),u}},this.unsubscribe=async(n,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(n,o.id,o):await this.unsubscribeByTopic(n,o)},this.isSubscribed=async n=>this.topics.includes(n)?!0:await new Promise((o,u)=>{const f=new se.Watch;f.start(this.pendingSubscriptionWatchLabel);const g=setInterval(()=>{!this.pending.has(n)&&this.topics.includes(n)&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),o(!0)),f.elapsed(this.pendingSubscriptionWatchLabel)>=AI&&(clearInterval(g),f.stop(this.pendingSubscriptionWatchLabel),u(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=t,this.logger=Ce.generateChildLogger(r,this.name),this.clientId=""}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.relayer.core.customStoragePrefix+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(t,r){let n=!1;try{n=this.getSubscription(t).topic===r}catch{}return n}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(t,r){const n=this.topicMap.get(t);await Promise.all(n.map(async o=>await this.unsubscribeById(t,o,r)))}async unsubscribeById(t,r,n){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}});try{const o=Ac(n);await this.rpcUnsubscribe(t,r,o);const u=It("USER_DISCONNECTED",`${this.name}, ${t}`);await this.onUnsubscribe(t,r,u),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:t,id:r,opts:n}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(t,r){const n={method:Io(r.protocol).subscribe,params:{topic:t}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{await await is(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}return bn(t+this.clientId)}async rpcBatchSubscribe(t){if(!t.length)return;const r=t[0].relay,n={method:Io(r.protocol).batchSubscribe,params:{topics:t.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:n});try{return await await is(this.relayer.request(n),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(Jt.connection_stalled)}}rpcUnsubscribe(t,r,n){const o={method:Io(n.protocol).unsubscribe,params:{topic:t,id:r}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(t,r){this.setSubscription(t,vc(Wn({},r),{id:t})),this.pending.delete(r.topic)}onBatchSubscribe(t){t.length&&t.forEach(r=>{this.setSubscription(r.id,Wn({},r)),this.pending.delete(r.topic)})}async onUnsubscribe(t,r,n){this.events.removeAllListeners(r),this.hasSubscription(r,t)&&this.deleteSubscription(r,n),await this.relayer.messages.del(t)}async setRelayerSubscriptions(t){await this.relayer.core.storage.setItem(this.storageKey,t)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(t,r){this.subscriptions.has(t)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:t,subscription:r}),this.addSubscription(t,r))}addSubscription(t,r){this.subscriptions.set(t,Wn({},r)),this.topicMap.set(r.topic,t),this.events.emit(Mr.created,r)}getSubscription(t){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:t});const r=this.subscriptions.get(t);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}deleteSubscription(t,r){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:t,reason:r});const n=this.getSubscription(t);this.subscriptions.delete(t),this.topicMap.delete(n.topic,t),this.events.emit(Mr.deleted,vc(Wn({},n),{reason:r}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(Mr.sync)}async reset(){if(this.cached.length){const t=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let r=0;r<t;r++){const n=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(n)}}this.events.emit(Mr.resubscribed)}async restore(){try{const t=await this.getRelayerSubscriptions();if(typeof t>"u"||!t.length)return;if(this.subscriptions.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(t){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(t)}}async batchSubscribe(t){if(!t.length)return;const r=await this.rpcBatchSubscribe(t);Jr(r)&&this.onBatchSubscribe(r.map((n,o)=>vc(Wn({},t[o]),{id:n})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const t=[];this.pending.forEach(r=>{t.push(r)}),await this.batchSubscribe(t)}registerEventListeners(){this.relayer.core.heartbeat.on(Sn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(Jt.connect,async()=>{await this.onConnect()}),this.relayer.on(Jt.disconnect,()=>{this.onDisconnect()}),this.events.on(Mr.created,async t=>{const r=Mr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()}),this.events.on(Mr.deleted,async t=>{const r=Mr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}async restartToComplete(){this.restartInProgress&&await new Promise(t=>{const r=setInterval(()=>{this.restartInProgress||(clearInterval(r),t())},this.pollingInterval)})}}var WI=Object.defineProperty,Ql=Object.getOwnPropertySymbols,JI=Object.prototype.hasOwnProperty,QI=Object.prototype.propertyIsEnumerable,Yl=(s,t,r)=>t in s?WI(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,YI=(s,t)=>{for(var r in t||(t={}))JI.call(t,r)&&Yl(s,r,t[r]);if(Ql)for(var r of Ql(t))QI.call(t,r)&&Yl(s,r,t[r]);return s};class ZI extends l_{constructor(t){super(t),this.protocol="wc",this.version=2,this.events=new Qr.EventEmitter,this.name=bI,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async r=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(r)}catch(n){throw this.logger.debug("Failed to Publish Request"),this.logger.error(n),n}},this.onPayloadHandler=r=>{this.onProviderPayload(r)},this.onConnectHandler=()=>{this.events.emit(Jt.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=r=>{this.logger.error(r),this.events.emit(Jt.error,r),this.logger.info("Fatal socket error received, closing transport"),this.transportClose()},this.registerProviderListeners=()=>{this.provider.on(ui.payload,this.onPayloadHandler),this.provider.on(ui.connect,this.onConnectHandler),this.provider.on(ui.disconnect,this.onDisconnectHandler),this.provider.on(ui.error,this.onProviderErrorHandler)},this.core=t.core,this.logger=typeof t.logger<"u"&&typeof t.logger!="string"?Ce.generateChildLogger(t.logger,this.name):Ce.pino(Ce.getDefaultLoggerOptions({level:t.logger||wI})),this.messages=new MI(this.logger,t.core),this.subscriber=new GI(this,this.logger),this.publisher=new UI(this,this.logger),this.relayUrl=(t==null?void 0:t.relayUrl)||sp,this.projectId=t.projectId,this.bundleId=D1(),this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Gl}...`),await this.restartTransport(Gl)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},xI)}get context(){return Ce.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(t,r,n){this.isInitialized(),await this.publisher.publish(t,r,n),await this.recordMessageEvent({topic:t,message:r,publishedAt:Date.now()})}async subscribe(t,r){var n;this.isInitialized();let o=((n=this.subscriber.topicMap.get(t))==null?void 0:n[0])||"";if(o)return o;let u;const f=g=>{g.topic===t&&(this.subscriber.off(Mr.created,f),u())};return await Promise.all([new Promise(g=>{u=g,this.subscriber.on(Mr.created,f)}),new Promise(async g=>{o=await this.subscriber.subscribe(t,r),g()})]),o}async unsubscribe(t,r){this.isInitialized(),await this.subscriber.unsubscribe(t,r)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}off(t,r){this.events.off(t,r)}removeListener(t,r){this.events.removeListener(t,r)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await is(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(t){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){t&&t!==this.relayUrl&&(this.relayUrl=t,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(r=>{if(!this.initialized)return r();this.subscriber.once(Mr.resubscribed,()=>{r()})}),new Promise(async(r,n)=>{try{await is(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){n(o);return}r()})])}catch(r){this.logger.error(r);const n=r;if(!this.isConnectionStalled(n.message))throw r;this.provider.events.emit(ui.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(t){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=t||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await El())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(t){return this.staleConnectionErrors.some(r=>t.includes(r))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const t=await this.core.crypto.signJWT(this.relayUrl);this.provider=new fi(new D_(z1({sdkVersion:II,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:t,useOnCloseEvent:!0,bundleId:this.bundleId}))),this.registerProviderListeners()}async recordMessageEvent(t){const{topic:r,message:n}=t;await this.messages.set(r,n)}async shouldIgnoreMessageEvent(t){const{topic:r,message:n}=t;if(!n||n.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${n}`),!0;if(!await this.subscriber.isSubscribed(r))return this.logger.debug(`Ignoring message for non-subscribed topic ${r}`),!0;const o=this.messages.has(r,n);return o&&this.logger.debug(`Ignoring duplicate message: ${n}`),o}async onProviderPayload(t){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:t}),Gc(t)){if(!t.method.endsWith(_I))return;const r=t.params,{topic:n,message:o,publishedAt:u}=r.data,f={topic:n,message:o,publishedAt:u};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(YI({type:"event",event:r.id},f)),this.events.emit(r.id,f),await this.acknowledgePayload(t),await this.onMessageEvent(f)}else Wc(t)&&this.events.emit(Jt.message_ack,t)}async onMessageEvent(t){await this.shouldIgnoreMessageEvent(t)||(this.events.emit(Jt.message,t),await this.recordMessageEvent(t))}async acknowledgePayload(t){const r=Jc(t.id,!0);await this.provider.connection.send(r)}unregisterProviderListeners(){this.provider.off(ui.payload,this.onPayloadHandler),this.provider.off(ui.connect,this.onConnectHandler),this.provider.off(ui.disconnect,this.onDisconnectHandler),this.provider.off(ui.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(Jt.connection_stalled,()=>{this.restartTransport().catch(r=>this.logger.error(r))});let t=await El();$w(async r=>{this.initialized&&t!==r&&(t=r,r?await this.restartTransport().catch(n=>this.logger.error(n)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(n=>this.logger.error(n))))})}onProviderDisconnect(){this.events.emit(Jt.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(t=>this.logger.error(t))},se.toMiliseconds(EI)))}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(t=>{const r=setInterval(()=>{this.connected&&(clearInterval(r),t())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var XI=Object.defineProperty,Zl=Object.getOwnPropertySymbols,ex=Object.prototype.hasOwnProperty,tx=Object.prototype.propertyIsEnumerable,Xl=(s,t,r)=>t in s?XI(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,ef=(s,t)=>{for(var r in t||(t={}))ex.call(t,r)&&Xl(s,r,t[r]);if(Zl)for(var r of Zl(t))tx.call(t,r)&&Xl(s,r,t[r]);return s};class jo extends f_{constructor(t,r,n,o=Oi,u=void 0){super(t,r,n,o),this.core=t,this.logger=r,this.name=n,this.map=new Map,this.version=SI,this.cached=[],this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(f=>{this.getKey&&f!==null&&!ir(f)?this.map.set(this.getKey(f),f):hw(f)?this.map.set(f.id,f):lw(f)&&this.map.set(f.topic,f)}),this.cached=[],this.initialized=!0)},this.set=async(f,g)=>{this.isInitialized(),this.map.has(f)?await this.update(f,g):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:f,value:g}),this.map.set(f,g),await this.persist())},this.get=f=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:f}),this.getData(f)),this.getAll=f=>(this.isInitialized(),f?this.values.filter(g=>Object.keys(f).every(v=>L_(g[v],f[v]))):this.values),this.update=async(f,g)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:f,update:g});const v=ef(ef({},this.getData(f)),g);this.map.set(f,v),await this.persist()},this.delete=async(f,g)=>{this.isInitialized(),this.map.has(f)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:f,reason:g}),this.map.delete(f),await this.persist())},this.logger=Ce.generateChildLogger(r,this.name),this.storagePrefix=o,this.getKey=u}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(t){await this.core.storage.setItem(this.storageKey,t)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(t){const r=this.map.get(t);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}async persist(){await this.setDataStore(this.values)}async restore(){try{const t=await this.getDataStore();if(typeof t>"u"||!t.length)return;if(this.map.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(t){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(t)}}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class rx{constructor(t,r){this.core=t,this.logger=r,this.name=RI,this.version=TI,this.events=new Vc,this.initialized=!1,this.storagePrefix=Oi,this.ignoredPayloadTypes=[Gi],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:n})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...n])]},this.create=async()=>{this.isInitialized();const n=Cc(),o=await this.core.crypto.setSymKey(n),u=Ur(se.FIVE_MINUTES),f={protocol:np},g={topic:o,expiry:u,relay:f,active:!1},v=ew({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:n,relay:f});return await this.pairings.set(o,g),await this.core.relayer.subscribe(o),this.core.expirer.set(o,u),{topic:o,uri:v}},this.pair=async n=>{this.isInitialized(),this.isValidPair(n);const{topic:o,symKey:u,relay:f}=ml(n.uri);let g;if(this.pairings.keys.includes(o)&&(g=this.pairings.get(o),g.active))throw new Error(`Pairing already exists: ${o}. Please try again with a new connection URI.`);const v=Ur(se.FIVE_MINUTES),p={topic:o,relay:f,expiry:v,active:!1};return await this.pairings.set(o,p),this.core.expirer.set(o,v),n.activatePairing&&await this.activate({topic:o}),this.events.emit(Xn.create,p),this.core.crypto.keychain.has(o)||(await this.core.crypto.setSymKey(u,o),await this.core.relayer.subscribe(o,{relay:f})),p},this.activate=async({topic:n})=>{this.isInitialized();const o=Ur(se.THIRTY_DAYS);await this.pairings.update(n,{active:!0,expiry:o}),this.core.expirer.set(n,o)},this.ping=async n=>{this.isInitialized(),await this.isValidPing(n);const{topic:o}=n;if(this.pairings.keys.includes(o)){const u=await this.sendRequest(o,"wc_pairingPing",{}),{done:f,resolve:g,reject:v}=vn();this.events.once(Ft("pairing_ping",u),({error:p})=>{p?v(p):g()}),await f()}},this.updateExpiry=async({topic:n,expiry:o})=>{this.isInitialized(),await this.pairings.update(n,{expiry:o})},this.updateMetadata=async({topic:n,metadata:o})=>{this.isInitialized(),await this.pairings.update(n,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async n=>{this.isInitialized(),await this.isValidDisconnect(n);const{topic:o}=n;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",It("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(n,o,u)=>{const f=ts(o,u),g=await this.core.crypto.encode(n,f),v=Gn[o].req;return this.core.history.set(n,f),this.core.relayer.publish(n,g,v),f.id},this.sendResult=async(n,o,u)=>{const f=Jc(n,u),g=await this.core.crypto.encode(o,f),v=await this.core.history.get(o,n),p=Gn[v.request.method].res;await this.core.relayer.publish(o,g,p),await this.core.history.resolve(f)},this.sendError=async(n,o,u)=>{const f=Bc(n,u),g=await this.core.crypto.encode(o,f),v=await this.core.history.get(o,n),p=Gn[v.request.method]?Gn[v.request.method].res:Gn.unregistered_method.res;await this.core.relayer.publish(o,g,p),await this.core.history.resolve(f)},this.deletePairing=async(n,o)=>{await this.core.relayer.unsubscribe(n),await Promise.all([this.pairings.delete(n,It("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(n),o?Promise.resolve():this.core.expirer.del(n)])},this.cleanup=async()=>{const n=this.pairings.getAll().filter(o=>Pi(o.expiry));await Promise.all(n.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=n=>{const{topic:o,payload:u}=n;switch(u.method){case"wc_pairingPing":return this.onPairingPingRequest(o,u);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,u);default:return this.onUnknownRpcMethodRequest(o,u)}},this.onRelayEventResponse=async n=>{const{topic:o,payload:u}=n,f=(await this.core.history.get(o,u.id)).request.method;switch(f){case"wc_pairingPing":return this.onPairingPingResponse(o,u);default:return this.onUnknownRpcMethodResponse(f)}},this.onPairingPingRequest=async(n,o)=>{const{id:u}=o;try{this.isValidPing({topic:n}),await this.sendResult(u,n,!0),this.events.emit(Xn.ping,{id:u,topic:n})}catch(f){await this.sendError(u,n,f),this.logger.error(f)}},this.onPairingPingResponse=(n,o)=>{const{id:u}=o;setTimeout(()=>{Si(o)?this.events.emit(Ft("pairing_ping",u),{}):li(o)&&this.events.emit(Ft("pairing_ping",u),{error:o.error})},500)},this.onPairingDeleteRequest=async(n,o)=>{const{id:u}=o;try{this.isValidDisconnect({topic:n}),await this.deletePairing(n),this.events.emit(Xn.delete,{id:u,topic:n})}catch(f){await this.sendError(u,n,f),this.logger.error(f)}},this.onUnknownRpcMethodRequest=async(n,o)=>{const{id:u,method:f}=o;try{if(this.registeredMethods.includes(f))return;const g=It("WC_METHOD_UNSUPPORTED",f);await this.sendError(u,n,g),this.logger.error(g)}catch(g){await this.sendError(u,n,g),this.logger.error(g)}},this.onUnknownRpcMethodResponse=n=>{this.registeredMethods.includes(n)||this.logger.error(It("WC_METHOD_UNSUPPORTED",n))},this.isValidPair=n=>{var o;if(!dr(n)){const{message:f}=Z("MISSING_OR_INVALID",`pair() params: ${n}`);throw new Error(f)}if(!uw(n.uri)){const{message:f}=Z("MISSING_OR_INVALID",`pair() uri: ${n.uri}`);throw new Error(f)}const u=ml(n.uri);if(!((o=u==null?void 0:u.relay)!=null&&o.protocol)){const{message:f}=Z("MISSING_OR_INVALID","pair() uri#relay-protocol");throw new Error(f)}if(!(u!=null&&u.symKey)){const{message:f}=Z("MISSING_OR_INVALID","pair() uri#symKey");throw new Error(f)}},this.isValidPing=async n=>{if(!dr(n)){const{message:u}=Z("MISSING_OR_INVALID",`ping() params: ${n}`);throw new Error(u)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidDisconnect=async n=>{if(!dr(n)){const{message:u}=Z("MISSING_OR_INVALID",`disconnect() params: ${n}`);throw new Error(u)}const{topic:o}=n;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async n=>{if(!Ht(n,!1)){const{message:o}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${n}`);throw new Error(o)}if(!this.pairings.keys.includes(n)){const{message:o}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${n}`);throw new Error(o)}if(Pi(this.pairings.get(n).expiry)){await this.deletePairing(n);const{message:o}=Z("EXPIRED",`pairing topic: ${n}`);throw new Error(o)}},this.core=t,this.logger=Ce.generateChildLogger(r,this.name),this.pairings=new jo(this.core,this.logger,this.name,this.storagePrefix)}get context(){return Ce.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}registerRelayerEvents(){this.core.relayer.on(Jt.message,async t=>{const{topic:r,message:n}=t;if(!this.pairings.keys.includes(r)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(n)))return;const o=await this.core.crypto.decode(r,n);try{Gc(o)?(this.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Wc(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.core.history.delete(r,o.id))}catch(u){this.logger.error(u)}})}registerExpirerEvents(){this.core.expirer.on(Nr.expired,async t=>{const{topic:r}=Nf(t.target);r&&this.pairings.keys.includes(r)&&(await this.deletePairing(r,!0),this.events.emit(Xn.expire,{topic:r}))})}}class ix extends c_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.records=new Map,this.events=new Qr.EventEmitter,this.name=NI,this.version=$I,this.cached=[],this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.records.set(n.id,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(n,o,u)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:n,request:o,chainId:u}),this.records.has(o.id))return;const f={id:o.id,topic:n,request:{method:o.method,params:o.params||null},chainId:u,expiry:Ur(se.THIRTY_DAYS)};this.records.set(f.id,f),this.events.emit(Wr.created,f)},this.resolve=async n=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:n}),!this.records.has(n.id))return;const o=await this.getRecord(n.id);typeof o.response>"u"&&(o.response=li(n)?{error:n.error}:{result:n.result},this.records.set(o.id,o),this.events.emit(Wr.updated,o))},this.get=async(n,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:n,id:o}),await this.getRecord(o)),this.delete=(n,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(u=>{if(u.topic===n){if(typeof o<"u"&&u.id!==o)return;this.records.delete(u.id),this.events.emit(Wr.deleted,u)}})},this.exists=async(n,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===n:!1),this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Ce.generateChildLogger(r,this.name)}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const t=[];return this.values.forEach(r=>{if(typeof r.response<"u")return;const n={topic:r.topic,request:ts(r.request.method,r.request.params,r.id),chainId:r.chainId};return t.push(n)}),t}async setJsonRpcRecords(t){await this.core.storage.setItem(this.storageKey,t)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(t){this.isInitialized();const r=this.records.get(t);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw new Error(n)}return r}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(Wr.sync)}async restore(){try{const t=await this.getJsonRpcRecords();if(typeof t>"u"||!t.length)return;if(this.records.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(t){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(t)}}registerEventListeners(){this.events.on(Wr.created,t=>{const r=Wr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Wr.updated,t=>{const r=Wr.updated;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.events.on(Wr.deleted,t=>{const r=Wr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,record:t}),this.persist()}),this.core.heartbeat.on(Sn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(t=>{se.toMiliseconds(t.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${t.id}`),this.delete(t.topic,t.id))})}catch(t){this.logger.warn(t)}}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class nx extends d_{constructor(t,r){super(t,r),this.core=t,this.logger=r,this.expirations=new Map,this.events=new Qr.EventEmitter,this.name=FI,this.version=DI,this.cached=[],this.initialized=!1,this.storagePrefix=Oi,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(n=>this.expirations.set(n.target,n)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=n=>{try{const o=this.formatTarget(n);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(n,o)=>{this.isInitialized();const u=this.formatTarget(n),f={target:u,expiry:o};this.expirations.set(u,f),this.checkExpiry(u,f),this.events.emit(Nr.created,{target:u,expiration:f})},this.get=n=>{this.isInitialized();const o=this.formatTarget(n);return this.getExpiration(o)},this.del=n=>{if(this.isInitialized(),this.has(n)){const o=this.formatTarget(n),u=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Nr.deleted,{target:o,expiration:u})}},this.on=(n,o)=>{this.events.on(n,o)},this.once=(n,o)=>{this.events.once(n,o)},this.off=(n,o)=>{this.events.off(n,o)},this.removeListener=(n,o)=>{this.events.removeListener(n,o)},this.logger=Ce.generateChildLogger(r,this.name)}get context(){return Ce.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+this.core.customStoragePrefix+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(t){if(typeof t=="string")return H1(t);if(typeof t=="number")return k1(t);const{message:r}=Z("UNKNOWN_TYPE",`Target type: ${typeof t}`);throw new Error(r)}async setExpirations(t){await this.core.storage.setItem(this.storageKey,t)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Nr.sync)}async restore(){try{const t=await this.getExpirations();if(typeof t>"u"||!t.length)return;if(this.expirations.size){const{message:r}=Z("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(r),new Error(r)}this.cached=t,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(t){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(t)}}getExpiration(t){const r=this.expirations.get(t);if(!r){const{message:n}=Z("NO_MATCHING_KEY",`${this.name}: ${t}`);throw this.logger.error(n),new Error(n)}return r}checkExpiry(t,r){const{expiry:n}=r;se.toMiliseconds(n)-Date.now()<=0&&this.expire(t,r)}expire(t,r){this.expirations.delete(t),this.events.emit(Nr.expired,{target:t,expiration:r})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((t,r)=>this.checkExpiry(r,t))}registerEventListeners(){this.core.heartbeat.on(Sn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Nr.created,t=>{const r=Nr.created;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nr.expired,t=>{const r=Nr.expired;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()}),this.events.on(Nr.deleted,t=>{const r=Nr.deleted;this.logger.info(`Emitting ${r}`),this.logger.debug({type:"event",event:r,data:t}),this.persist()})}isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}}}class sx extends g_{constructor(t,r){super(t,r),this.projectId=t,this.logger=r,this.name=mc,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async n=>{if(this.verifyDisabled||En()||!In())return;const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u)}if(!this.initialized){this.removeIframe(),this.verifyUrl=Mc;try{await this.createIframe()}catch(u){this.logger.info(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.info(u),this.verifyDisabled=!0}}},this.register=async n=>{this.initialized?this.sendPost(n.attestationId):(this.addToQueue(n.attestationId),await this.init())},this.resolve=async n=>{if(this.isDevEnv)return"";const o=this.getVerifyUrl(n==null?void 0:n.verifyUrl);let u;try{u=await this.fetchAttestation(n.attestationId,o)}catch(f){this.logger.info(`failed to resolve attestation: ${n.attestationId} from url: ${o}`),this.logger.info(f),u=await this.fetchAttestation(n.attestationId,Mc)}return u},this.fetchAttestation=async(n,o)=>{this.logger.info(`resolving attestation: ${n} from url: ${o}`);const u=this.startAbortTimer(se.ONE_SECOND*2),f=await fetch(`${o}/attestation/${n}`,{signal:this.abortController.signal});return clearTimeout(u),f.status===200?await f.json():void 0},this.addToQueue=n=>{this.queue.push(n)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(n=>this.sendPost(n)),this.queue=[])},this.sendPost=n=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(n,"*"),this.logger.info(`postMessage sent: ${n} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let n;const o=u=>{u.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),n())};await Promise.race([new Promise(u=>{if(document.getElementById(mc))return u();window.addEventListener("message",o);const f=document.createElement("iframe");f.id=mc,f.src=`${this.verifyUrl}/${this.projectId}`,f.style.display="none",document.body.append(f),this.iframe=f,n=u}),new Promise((u,f)=>setTimeout(()=>{window.removeEventListener("message",o),f("verify iframe load timeout")},se.toMiliseconds(se.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.getVerifyUrl=n=>{let o=n||wn;return jI.includes(o)||(this.logger.info(`verify url: ${o}, not included in trusted list, assigning default: ${wn}`),o=wn),o},this.logger=Ce.generateChildLogger(r,this.name),this.verifyUrl=wn,this.abortController=new AbortController,this.isDevEnv=Xc()&&{}.IS_VITEST}get context(){return Ce.getLoggerContext(this.logger)}startAbortTimer(t){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),se.toMiliseconds(t))}}var ox=Object.defineProperty,tf=Object.getOwnPropertySymbols,ax=Object.prototype.hasOwnProperty,cx=Object.prototype.propertyIsEnumerable,rf=(s,t,r)=>t in s?ox(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,nf=(s,t)=>{for(var r in t||(t={}))ax.call(t,r)&&rf(s,r,t[r]);if(tf)for(var r of tf(t))cx.call(t,r)&&rf(s,r,t[r]);return s};class nu extends a_{constructor(t){super(t),this.protocol=ip,this.version=cI,this.name=iu,this.events=new Qr.EventEmitter,this.initialized=!1,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.projectId=t==null?void 0:t.projectId,this.relayUrl=(t==null?void 0:t.relayUrl)||sp,this.customStoragePrefix=t!=null&&t.customStoragePrefix?`:${t.customStoragePrefix}`:"";const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ce.pino(Ce.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||uI.logger}));this.logger=Ce.generateChildLogger(r,this.name),this.heartbeat=new Sn.HeartBeat,this.crypto=new qI(this,this.logger,t==null?void 0:t.keychain),this.history=new ix(this,this.logger),this.expirer=new nx(this,this.logger),this.storage=t!=null&&t.storage?t.storage:new lb(nf(nf({},hI),t==null?void 0:t.storageOptions)),this.relayer=new ZI({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new rx(this,this.logger),this.verify=new sx(this.projectId||"",this.logger)}static async init(t){const r=new nu(t);await r.initialize();const n=await r.crypto.getClientId();return await r.storage.setItem(PI,n),r}get context(){return Ce.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(t){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,t),this.logger.error(t.message),t}}}const ux=nu,op="wc",ap=2,cp="client",su=`${op}@${ap}:${cp}:`,wc={name:cp,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},sf="WALLETCONNECT_DEEPLINK_CHOICE",hx="proposal",up="Proposal expired",lx="session",bo=se.SEVEN_DAYS,fx="engine",Jn={wc_sessionPropose:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1104},res:{ttl:se.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1106},res:{ttl:se.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:se.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:se.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:se.ONE_DAY,prompt:!1,tag:1112},res:{ttl:se.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:se.THIRTY_SECONDS,prompt:!1,tag:1115}}},bc={min:se.FIVE_MINUTES,max:se.SEVEN_DAYS},hi={idle:"IDLE",active:"ACTIVE"},px="request",dx=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var gx=Object.defineProperty,yx=Object.defineProperties,mx=Object.getOwnPropertyDescriptors,of=Object.getOwnPropertySymbols,vx=Object.prototype.hasOwnProperty,wx=Object.prototype.propertyIsEnumerable,af=(s,t,r)=>t in s?gx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,fr=(s,t)=>{for(var r in t||(t={}))vx.call(t,r)&&af(s,r,t[r]);if(of)for(var r of of(t))wx.call(t,r)&&af(s,r,t[r]);return s},Qn=(s,t)=>yx(s,mx(t));class bx extends m_{constructor(t){super(t),this.name=fx,this.events=new Vc,this.initialized=!1,this.ignoredPayloadTypes=[Gi],this.requestQueue={state:hi.idle,queue:[]},this.sessionRequestQueue={state:hi.idle,queue:[]},this.requestQueueDelay=se.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.registerPairingEvents(),this.client.core.pairing.register({methods:Object.keys(Jn)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},se.toMiliseconds(this.requestQueueDelay)))},this.connect=async r=>{await this.isInitialized();const n=Qn(fr({},r),{requiredNamespaces:r.requiredNamespaces||{},optionalNamespaces:r.optionalNamespaces||{}});await this.isValidConnect(n);const{pairingTopic:o,requiredNamespaces:u,optionalNamespaces:f,sessionProperties:g,relays:v}=n;let p=o,w,E=!1;if(p&&(E=this.client.core.pairing.pairings.get(p).active),!p||!E){const{topic:$,uri:U}=await this.client.core.pairing.create();p=$,w=U}const O=await this.client.core.crypto.generateKeyPair(),q=fr({requiredNamespaces:u,optionalNamespaces:f,relays:v??[{protocol:np}],proposer:{publicKey:O,metadata:this.client.metadata}},g&&{sessionProperties:g}),{reject:D,resolve:J,done:oe}=vn(se.FIVE_MINUTES,up);if(this.events.once(Ft("session_connect"),async({error:$,session:U})=>{if($)D($);else if(U){U.self.publicKey=O;const M=Qn(fr({},U),{requiredNamespaces:U.requiredNamespaces,optionalNamespaces:U.optionalNamespaces});await this.client.session.set(U.topic,M),await this.setExpiry(U.topic,U.expiry),p&&await this.client.core.pairing.updateMetadata({topic:p,metadata:U.peer.metadata}),J(M)}}),!p){const{message:$}=Z("NO_MATCHING_KEY",`connect() pairing topic: ${p}`);throw new Error($)}const fe=await this.sendRequest({topic:p,method:"wc_sessionPropose",params:q}),A=Ur(se.FIVE_MINUTES);return await this.setProposal(fe,fr({id:fe,expiry:A},q)),{uri:w,approval:oe}},this.pair=async r=>(await this.isInitialized(),await this.client.core.pairing.pair(r)),this.approve=async r=>{await this.isInitialized(),await this.isValidApprove(r);const{id:n,relayProtocol:o,namespaces:u,sessionProperties:f}=r,g=this.client.proposal.get(n);let{pairingTopic:v,proposer:p,requiredNamespaces:w,optionalNamespaces:E}=g;v=v||"",_n(w)||(w=nw(u,"approve()"));const O=await this.client.core.crypto.generateKeyPair(),q=p.publicKey,D=await this.client.core.crypto.generateSharedKey(O,q);v&&n&&(await this.client.core.pairing.updateMetadata({topic:v,metadata:p.metadata}),await this.sendResult({id:n,topic:v,result:{relay:{protocol:o??"irn"},responderPublicKey:O}}),await this.client.proposal.delete(n,It("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:v}));const J=fr({relay:{protocol:o??"irn"},namespaces:u,requiredNamespaces:w,optionalNamespaces:E,pairingTopic:v,controller:{publicKey:O,metadata:this.client.metadata},expiry:Ur(bo)},f&&{sessionProperties:f});await this.client.core.relayer.subscribe(D),await this.sendRequest({topic:D,method:"wc_sessionSettle",params:J,throwOnFailedPublish:!0});const oe=Qn(fr({},J),{topic:D,pairingTopic:v,acknowledged:!1,self:J.controller,peer:{publicKey:p.publicKey,metadata:p.metadata},controller:O});return await this.client.session.set(D,oe),await this.setExpiry(D,Ur(bo)),{topic:D,acknowledged:()=>new Promise(fe=>setTimeout(()=>fe(this.client.session.get(D)),500))}},this.reject=async r=>{await this.isInitialized(),await this.isValidReject(r);const{id:n,reason:o}=r,{pairingTopic:u}=this.client.proposal.get(n);u&&(await this.sendError(n,u,o),await this.client.proposal.delete(n,It("USER_DISCONNECTED")))},this.update=async r=>{await this.isInitialized(),await this.isValidUpdate(r);const{topic:n,namespaces:o}=r,u=await this.sendRequest({topic:n,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:f,resolve:g,reject:v}=vn();return this.events.once(Ft("session_update",u),({error:p})=>{p?v(p):g()}),await this.client.session.update(n,{namespaces:o}),{acknowledged:f}},this.extend=async r=>{await this.isInitialized(),await this.isValidExtend(r);const{topic:n}=r,o=await this.sendRequest({topic:n,method:"wc_sessionExtend",params:{}}),{done:u,resolve:f,reject:g}=vn();return this.events.once(Ft("session_extend",o),({error:v})=>{v?g(v):f()}),await this.setExpiry(n,Ur(bo)),{acknowledged:u}},this.request=async r=>{await this.isInitialized(),await this.isValidRequest(r);const{chainId:n,request:o,topic:u,expiry:f}=r,g=y1(),{done:v,resolve:p,reject:w}=vn(f,"Request expired. Please try again.");return this.events.once(Ft("session_request",g),({error:E,result:O})=>{E?w(E):p(O)}),await Promise.all([new Promise(async E=>{await this.sendRequest({clientRpcId:g,topic:u,method:"wc_sessionRequest",params:{request:o,chainId:n},expiry:f,throwOnFailedPublish:!0}).catch(O=>w(O)),this.client.events.emit("session_request_sent",{topic:u,request:o,chainId:n,id:g}),E()}),new Promise(async E=>{const O=await V1(this.client.core.storage,sf);K1({id:g,topic:u,wcDeepLink:O}),E()}),v()]).then(E=>E[2])},this.respond=async r=>{await this.isInitialized(),await this.isValidRespond(r);const{topic:n,response:o}=r,{id:u}=o;Si(o)?await this.sendResult({id:u,topic:n,result:o.result,throwOnFailedPublish:!0}):li(o)&&await this.sendError(u,n,o.error),this.cleanupAfterResponse(r)},this.ping=async r=>{await this.isInitialized(),await this.isValidPing(r);const{topic:n}=r;if(this.client.session.keys.includes(n)){const o=await this.sendRequest({topic:n,method:"wc_sessionPing",params:{}}),{done:u,resolve:f,reject:g}=vn();this.events.once(Ft("session_ping",o),({error:v})=>{v?g(v):f()}),await u()}else this.client.core.pairing.pairings.keys.includes(n)&&await this.client.core.pairing.ping({topic:n})},this.emit=async r=>{await this.isInitialized(),await this.isValidEmit(r);const{topic:n,event:o,chainId:u}=r;await this.sendRequest({topic:n,method:"wc_sessionEvent",params:{event:o,chainId:u}})},this.disconnect=async r=>{await this.isInitialized(),await this.isValidDisconnect(r);const{topic:n}=r;this.client.session.keys.includes(n)?(await this.sendRequest({topic:n,method:"wc_sessionDelete",params:It("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(n)):await this.client.core.pairing.disconnect({topic:n})},this.find=r=>(this.isInitialized(),this.client.session.getAll().filter(n=>aw(n,r))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async r=>{if(r.pairingTopic)try{const n=this.client.core.pairing.pairings.get(r.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(u=>{var f,g;return((f=u.peerMetadata)==null?void 0:f.url)&&((g=u.peerMetadata)==null?void 0:g.url)===r.peer.metadata.url&&u.topic&&u.topic!==n.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(u=>this.client.core.pairing.disconnect({topic:u.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(n){this.client.logger.error(n)}},this.deleteSession=async(r,n)=>{const{self:o}=this.client.session.get(r);await this.client.core.relayer.unsubscribe(r),this.client.session.delete(r,It("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(r)&&await this.client.core.crypto.deleteSymKey(r),n||this.client.core.expirer.del(r),this.client.core.storage.removeItem(sf).catch(u=>this.client.logger.warn(u))},this.deleteProposal=async(r,n)=>{await Promise.all([this.client.proposal.delete(r,It("USER_DISCONNECTED")),n?Promise.resolve():this.client.core.expirer.del(r)])},this.deletePendingSessionRequest=async(r,n,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(r,n),o?Promise.resolve():this.client.core.expirer.del(r)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(u=>u.id!==r),o&&(this.sessionRequestQueue.state=hi.idle)},this.setExpiry=async(r,n)=>{this.client.session.keys.includes(r)&&await this.client.session.update(r,{expiry:n}),this.client.core.expirer.set(r,n)},this.setProposal=async(r,n)=>{await this.client.proposal.set(r,n),this.client.core.expirer.set(r,n.expiry)},this.setPendingSessionRequest=async r=>{const n=Jn.wc_sessionRequest.req.ttl,{id:o,topic:u,params:f,verifyContext:g}=r;await this.client.pendingRequest.set(o,{id:o,topic:u,params:f,verifyContext:g}),n&&this.client.core.expirer.set(o,Ur(n))},this.sendRequest=async r=>{const{topic:n,method:o,params:u,expiry:f,relayRpcId:g,clientRpcId:v,throwOnFailedPublish:p}=r,w=ts(o,u,v);if(In()&&dx.includes(o)){const q=bn(JSON.stringify(w));this.client.core.verify.register({attestationId:q})}const E=await this.client.core.crypto.encode(n,w),O=Jn[o].req;return f&&(O.ttl=f),g&&(O.id=g),this.client.core.history.set(n,w),p?(O.internal=Qn(fr({},O.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(n,E,O)):this.client.core.relayer.publish(n,E,O).catch(q=>this.client.logger.error(q)),w.id},this.sendResult=async r=>{const{id:n,topic:o,result:u,throwOnFailedPublish:f}=r,g=Jc(n,u),v=await this.client.core.crypto.encode(o,g),p=await this.client.core.history.get(o,n),w=Jn[p.request.method].res;f?(w.internal=Qn(fr({},w.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,v,w)):this.client.core.relayer.publish(o,v,w).catch(E=>this.client.logger.error(E)),await this.client.core.history.resolve(g)},this.sendError=async(r,n,o)=>{const u=Bc(r,o),f=await this.client.core.crypto.encode(n,u),g=await this.client.core.history.get(n,r),v=Jn[g.request.method].res;this.client.core.relayer.publish(n,f,v),await this.client.core.history.resolve(u)},this.cleanup=async()=>{const r=[],n=[];this.client.session.getAll().forEach(o=>{Pi(o.expiry)&&r.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{Pi(o.expiry)&&n.push(o.id)}),await Promise.all([...r.map(o=>this.deleteSession(o)),...n.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async r=>{this.requestQueue.queue.push(r),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===hi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=hi.active;const r=this.requestQueue.queue.shift();if(r)try{this.processRequest(r),await new Promise(n=>setTimeout(n,300))}catch(n){this.client.logger.warn(n)}}this.requestQueue.state=hi.idle},this.processRequest=r=>{const{topic:n,payload:o}=r,u=o.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeRequest(n,o);case"wc_sessionSettle":return this.onSessionSettleRequest(n,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(n,o);case"wc_sessionExtend":return this.onSessionExtendRequest(n,o);case"wc_sessionPing":return this.onSessionPingRequest(n,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(n,o);case"wc_sessionRequest":return this.onSessionRequest(n,o);case"wc_sessionEvent":return this.onSessionEventRequest(n,o);default:return this.client.logger.info(`Unsupported request method ${u}`)}},this.onRelayEventResponse=async r=>{const{topic:n,payload:o}=r,u=(await this.client.core.history.get(n,o.id)).request.method;switch(u){case"wc_sessionPropose":return this.onSessionProposeResponse(n,o);case"wc_sessionSettle":return this.onSessionSettleResponse(n,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(n,o);case"wc_sessionExtend":return this.onSessionExtendResponse(n,o);case"wc_sessionPing":return this.onSessionPingResponse(n,o);case"wc_sessionRequest":return this.onSessionRequestResponse(n,o);default:return this.client.logger.info(`Unsupported response method ${u}`)}},this.onRelayEventUnknownPayload=r=>{const{topic:n}=r,{message:o}=Z("MISSING_OR_INVALID",`Decoded payload on topic ${n} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(r,n)=>{const{params:o,id:u}=n;try{this.isValidConnect(fr({},n.params));const f=Ur(se.FIVE_MINUTES),g=fr({id:u,pairingTopic:r,expiry:f},o);await this.setProposal(u,g);const v=bn(JSON.stringify(n)),p=await this.getVerifyContext(v,g.proposer.metadata);this.client.events.emit("session_proposal",{id:u,params:g,verifyContext:p})}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.onSessionProposeResponse=async(r,n)=>{const{id:o}=n;if(Si(n)){const{result:u}=n;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:u});const f=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:f});const g=f.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:g});const v=u.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:v});const p=await this.client.core.crypto.generateSharedKey(g,v);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:p});const w=await this.client.core.relayer.subscribe(p);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:w}),await this.client.core.pairing.activate({topic:r})}else li(n)&&(await this.client.proposal.delete(o,It("USER_DISCONNECTED")),this.events.emit(Ft("session_connect"),{error:n.error}))},this.onSessionSettleRequest=async(r,n)=>{const{id:o,params:u}=n;try{this.isValidSessionSettleRequest(u);const{relay:f,controller:g,expiry:v,namespaces:p,requiredNamespaces:w,optionalNamespaces:E,sessionProperties:O,pairingTopic:q}=n.params,D=fr({topic:r,relay:f,expiry:v,namespaces:p,acknowledged:!0,pairingTopic:q,requiredNamespaces:w,optionalNamespaces:E,controller:g.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:g.publicKey,metadata:g.metadata}},O&&{sessionProperties:O});await this.sendResult({id:n.id,topic:r,result:!0}),this.events.emit(Ft("session_connect"),{session:D}),this.cleanupDuplicatePairings(D)}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionSettleResponse=async(r,n)=>{const{id:o}=n;Si(n)?(await this.client.session.update(r,{acknowledged:!0}),this.events.emit(Ft("session_approve",o),{})):li(n)&&(await this.client.session.delete(r,It("USER_DISCONNECTED")),this.events.emit(Ft("session_approve",o),{error:n.error}))},this.onSessionUpdateRequest=async(r,n)=>{const{params:o,id:u}=n;try{const f=`${r}_session_update`,g=mo.get(f);if(g&&this.isRequestOutOfSync(g,u)){this.client.logger.info(`Discarding out of sync request - ${u}`);return}this.isValidUpdate(fr({topic:r},o)),await this.client.session.update(r,{namespaces:o.namespaces}),await this.sendResult({id:u,topic:r,result:!0}),this.client.events.emit("session_update",{id:u,topic:r,params:o}),mo.set(f,u)}catch(f){await this.sendError(u,r,f),this.client.logger.error(f)}},this.isRequestOutOfSync=(r,n)=>parseInt(n.toString().slice(0,-3))<=parseInt(r.toString().slice(0,-3)),this.onSessionUpdateResponse=(r,n)=>{const{id:o}=n;Si(n)?this.events.emit(Ft("session_update",o),{}):li(n)&&this.events.emit(Ft("session_update",o),{error:n.error})},this.onSessionExtendRequest=async(r,n)=>{const{id:o}=n;try{this.isValidExtend({topic:r}),await this.setExpiry(r,Ur(bo)),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_extend",{id:o,topic:r})}catch(u){await this.sendError(o,r,u),this.client.logger.error(u)}},this.onSessionExtendResponse=(r,n)=>{const{id:o}=n;Si(n)?this.events.emit(Ft("session_extend",o),{}):li(n)&&this.events.emit(Ft("session_extend",o),{error:n.error})},this.onSessionPingRequest=async(r,n)=>{const{id:o}=n;try{this.isValidPing({topic:r}),await this.sendResult({id:o,topic:r,result:!0}),this.client.events.emit("session_ping",{id:o,topic:r})}catch(u){await this.sendError(o,r,u),this.client.logger.error(u)}},this.onSessionPingResponse=(r,n)=>{const{id:o}=n;setTimeout(()=>{Si(n)?this.events.emit(Ft("session_ping",o),{}):li(n)&&this.events.emit(Ft("session_ping",o),{error:n.error})},500)},this.onSessionDeleteRequest=async(r,n)=>{const{id:o}=n;try{this.isValidDisconnect({topic:r,reason:n.params}),await Promise.all([new Promise(u=>{this.client.core.relayer.once(Jt.publish,async()=>{u(await this.deleteSession(r))})}),this.sendResult({id:o,topic:r,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:r})}catch(u){this.client.logger.error(u)}},this.onSessionRequest=async(r,n)=>{const{id:o,params:u}=n;try{this.isValidRequest(fr({topic:r},u));const f=bn(JSON.stringify(ts("wc_sessionRequest",u,o))),g=this.client.session.get(r),v=await this.getVerifyContext(f,g.peer.metadata),p={id:o,topic:r,params:u,verifyContext:v};await this.setPendingSessionRequest(p),this.addSessionRequestToSessionRequestQueue(p),this.processSessionRequestQueue()}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.onSessionRequestResponse=(r,n)=>{const{id:o}=n;Si(n)?this.events.emit(Ft("session_request",o),{result:n.result}):li(n)&&this.events.emit(Ft("session_request",o),{error:n.error})},this.onSessionEventRequest=async(r,n)=>{const{id:o,params:u}=n;try{const f=`${r}_session_event_${u.event.name}`,g=mo.get(f);if(g&&this.isRequestOutOfSync(g,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(fr({topic:r},u)),this.client.events.emit("session_event",{id:o,topic:r,params:u}),mo.set(f,o)}catch(f){await this.sendError(o,r,f),this.client.logger.error(f)}},this.addSessionRequestToSessionRequestQueue=r=>{this.sessionRequestQueue.queue.push(r)},this.cleanupAfterResponse=r=>{this.deletePendingSessionRequest(r.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=hi.idle,this.processSessionRequestQueue()},se.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=()=>{if(this.sessionRequestQueue.state===hi.active){this.client.logger.info("session request queue is already active.");return}const r=this.sessionRequestQueue.queue[0];if(!r){this.client.logger.info("session request queue is empty.");return}try{this.sessionRequestQueue.state=hi.active,this.client.events.emit("session_request",r)}catch(n){this.client.logger.error(n)}},this.onPairingCreated=r=>{if(r.active)return;const n=this.client.proposal.getAll().find(o=>o.pairingTopic===r.topic);n&&this.onSessionProposeRequest(r.topic,ts("wc_sessionPropose",{requiredNamespaces:n.requiredNamespaces,optionalNamespaces:n.optionalNamespaces,relays:n.relays,proposer:n.proposer,sessionProperties:n.sessionProperties},n.id))},this.isValidConnect=async r=>{if(!dr(r)){const{message:v}=Z("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(r)}`);throw new Error(v)}const{pairingTopic:n,requiredNamespaces:o,optionalNamespaces:u,sessionProperties:f,relays:g}=r;if(ir(n)||await this.isValidPairingTopic(n),!ww(g,!0)){const{message:v}=Z("MISSING_OR_INVALID",`connect() relays: ${g}`);throw new Error(v)}!ir(o)&&_n(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!ir(u)&&_n(u)!==0&&this.validateNamespaces(u,"optionalNamespaces"),ir(f)||this.validateSessionProps(f,"sessionProperties")},this.validateNamespaces=(r,n)=>{const o=vw(r,"connect()",n);if(o)throw new Error(o.message)},this.isValidApprove=async r=>{if(!dr(r))throw new Error(Z("MISSING_OR_INVALID",`approve() params: ${r}`).message);const{id:n,namespaces:o,relayProtocol:u,sessionProperties:f}=r;await this.isValidProposalId(n);const g=this.client.proposal.get(n),v=xo(o,"approve()");if(v)throw new Error(v.message);const p=bl(g.requiredNamespaces,o,"approve()");if(p)throw new Error(p.message);if(!Ht(u,!0)){const{message:w}=Z("MISSING_OR_INVALID",`approve() relayProtocol: ${u}`);throw new Error(w)}ir(f)||this.validateSessionProps(f,"sessionProperties")},this.isValidReject=async r=>{if(!dr(r)){const{message:u}=Z("MISSING_OR_INVALID",`reject() params: ${r}`);throw new Error(u)}const{id:n,reason:o}=r;if(await this.isValidProposalId(n),!_w(o)){const{message:u}=Z("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(u)}},this.isValidSessionSettleRequest=r=>{if(!dr(r)){const{message:p}=Z("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${r}`);throw new Error(p)}const{relay:n,controller:o,namespaces:u,expiry:f}=r;if(!Ff(n)){const{message:p}=Z("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(p)}const g=fw(o,"onSessionSettleRequest()");if(g)throw new Error(g.message);const v=xo(u,"onSessionSettleRequest()");if(v)throw new Error(v.message);if(Pi(f)){const{message:p}=Z("EXPIRED","onSessionSettleRequest()");throw new Error(p)}},this.isValidUpdate=async r=>{if(!dr(r)){const{message:v}=Z("MISSING_OR_INVALID",`update() params: ${r}`);throw new Error(v)}const{topic:n,namespaces:o}=r;await this.isValidSessionTopic(n);const u=this.client.session.get(n),f=xo(o,"update()");if(f)throw new Error(f.message);const g=bl(u.requiredNamespaces,o,"update()");if(g)throw new Error(g.message)},this.isValidExtend=async r=>{if(!dr(r)){const{message:o}=Z("MISSING_OR_INVALID",`extend() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionTopic(n)},this.isValidRequest=async r=>{if(!dr(r)){const{message:v}=Z("MISSING_OR_INVALID",`request() params: ${r}`);throw new Error(v)}const{topic:n,request:o,chainId:u,expiry:f}=r;await this.isValidSessionTopic(n);const{namespaces:g}=this.client.session.get(n);if(!wl(g,u)){const{message:v}=Z("MISSING_OR_INVALID",`request() chainId: ${u}`);throw new Error(v)}if(!Ew(o)){const{message:v}=Z("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(v)}if(!Sw(g,u,o.method)){const{message:v}=Z("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(v)}if(f&&!Aw(f,bc)){const{message:v}=Z("MISSING_OR_INVALID",`request() expiry: ${f}. Expiry must be a number (in seconds) between ${bc.min} and ${bc.max}`);throw new Error(v)}},this.isValidRespond=async r=>{if(!dr(r)){const{message:u}=Z("MISSING_OR_INVALID",`respond() params: ${r}`);throw new Error(u)}const{topic:n,response:o}=r;if(await this.isValidSessionTopic(n),!Iw(o)){const{message:u}=Z("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(u)}},this.isValidPing=async r=>{if(!dr(r)){const{message:o}=Z("MISSING_OR_INVALID",`ping() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.isValidEmit=async r=>{if(!dr(r)){const{message:g}=Z("MISSING_OR_INVALID",`emit() params: ${r}`);throw new Error(g)}const{topic:n,event:o,chainId:u}=r;await this.isValidSessionTopic(n);const{namespaces:f}=this.client.session.get(n);if(!wl(f,u)){const{message:g}=Z("MISSING_OR_INVALID",`emit() chainId: ${u}`);throw new Error(g)}if(!xw(o)){const{message:g}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}if(!Pw(f,u,o.name)){const{message:g}=Z("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(g)}},this.isValidDisconnect=async r=>{if(!dr(r)){const{message:o}=Z("MISSING_OR_INVALID",`disconnect() params: ${r}`);throw new Error(o)}const{topic:n}=r;await this.isValidSessionOrPairingTopic(n)},this.getVerifyContext=async(r,n)=>{const o={verified:{verifyUrl:n.verifyUrl||wn,validation:"UNKNOWN",origin:n.url||""}};try{const u=await this.client.core.verify.resolve({attestationId:r,verifyUrl:n.verifyUrl});u&&(o.verified.origin=u.origin,o.verified.isScam=u.isScam,o.verified.validation=u.origin===new URL(n.url).origin?"VALID":"INVALID")}catch(u){this.client.logger.info(u)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(r,n)=>{Object.values(r).forEach(o=>{if(!Ht(o,!1)){const{message:u}=Z("MISSING_OR_INVALID",`${n} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(u)}})}}async isInitialized(){if(!this.initialized){const{message:t}=Z("NOT_INITIALIZED",this.name);throw new Error(t)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(Jt.message,async t=>{const{topic:r,message:n}=t;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(n)))return;const o=await this.client.core.crypto.decode(r,n);try{Gc(o)?(this.client.core.history.set(r,o),this.onRelayEventRequest({topic:r,payload:o})):Wc(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:r,payload:o}),this.client.core.history.delete(r,o.id)):this.onRelayEventUnknownPayload({topic:r,payload:o})}catch(u){this.client.logger.error(u)}})}registerExpirerEvents(){this.client.core.expirer.on(Nr.expired,async t=>{const{topic:r,id:n}=Nf(t.target);if(n&&this.client.pendingRequest.keys.includes(n))return await this.deletePendingSessionRequest(n,Z("EXPIRED"),!0);r?this.client.session.keys.includes(r)&&(await this.deleteSession(r,!0),this.client.events.emit("session_expire",{topic:r})):n&&(await this.deleteProposal(n,!0),this.client.events.emit("proposal_expire",{id:n}))})}registerPairingEvents(){this.client.core.pairing.events.on(Xn.create,t=>this.onPairingCreated(t))}isValidPairingTopic(t){if(!Ht(t,!1)){const{message:r}=Z("MISSING_OR_INVALID",`pairing topic should be a string: ${t}`);throw new Error(r)}if(!this.client.core.pairing.pairings.keys.includes(t)){const{message:r}=Z("NO_MATCHING_KEY",`pairing topic doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.core.pairing.pairings.get(t).expiry)){const{message:r}=Z("EXPIRED",`pairing topic: ${t}`);throw new Error(r)}}async isValidSessionTopic(t){if(!Ht(t,!1)){const{message:r}=Z("MISSING_OR_INVALID",`session topic should be a string: ${t}`);throw new Error(r)}if(!this.client.session.keys.includes(t)){const{message:r}=Z("NO_MATCHING_KEY",`session topic doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.session.get(t).expiry)){await this.deleteSession(t);const{message:r}=Z("EXPIRED",`session topic: ${t}`);throw new Error(r)}}async isValidSessionOrPairingTopic(t){if(this.client.session.keys.includes(t))await this.isValidSessionTopic(t);else if(this.client.core.pairing.pairings.keys.includes(t))this.isValidPairingTopic(t);else if(Ht(t,!1)){const{message:r}=Z("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${t}`);throw new Error(r)}else{const{message:r}=Z("MISSING_OR_INVALID",`session or pairing topic should be a string: ${t}`);throw new Error(r)}}async isValidProposalId(t){if(!bw(t)){const{message:r}=Z("MISSING_OR_INVALID",`proposal id should be a number: ${t}`);throw new Error(r)}if(!this.client.proposal.keys.includes(t)){const{message:r}=Z("NO_MATCHING_KEY",`proposal id doesn't exist: ${t}`);throw new Error(r)}if(Pi(this.client.proposal.get(t).expiry)){await this.deleteProposal(t);const{message:r}=Z("EXPIRED",`proposal id: ${t}`);throw new Error(r)}}}class _x extends jo{constructor(t,r){super(t,r,hx,su),this.core=t,this.logger=r}}class Ex extends jo{constructor(t,r){super(t,r,lx,su),this.core=t,this.logger=r}}class Ix extends jo{constructor(t,r){super(t,r,px,su,n=>n.id),this.core=t,this.logger=r}}let xx=class hp extends y_{constructor(t){super(t),this.protocol=op,this.version=ap,this.name=wc.name,this.events=new Qr.EventEmitter,this.on=(n,o)=>this.events.on(n,o),this.once=(n,o)=>this.events.once(n,o),this.off=(n,o)=>this.events.off(n,o),this.removeListener=(n,o)=>this.events.removeListener(n,o),this.removeAllListeners=n=>this.events.removeAllListeners(n),this.connect=async n=>{try{return await this.engine.connect(n)}catch(o){throw this.logger.error(o.message),o}},this.pair=async n=>{try{return await this.engine.pair(n)}catch(o){throw this.logger.error(o.message),o}},this.approve=async n=>{try{return await this.engine.approve(n)}catch(o){throw this.logger.error(o.message),o}},this.reject=async n=>{try{return await this.engine.reject(n)}catch(o){throw this.logger.error(o.message),o}},this.update=async n=>{try{return await this.engine.update(n)}catch(o){throw this.logger.error(o.message),o}},this.extend=async n=>{try{return await this.engine.extend(n)}catch(o){throw this.logger.error(o.message),o}},this.request=async n=>{try{return await this.engine.request(n)}catch(o){throw this.logger.error(o.message),o}},this.respond=async n=>{try{return await this.engine.respond(n)}catch(o){throw this.logger.error(o.message),o}},this.ping=async n=>{try{return await this.engine.ping(n)}catch(o){throw this.logger.error(o.message),o}},this.emit=async n=>{try{return await this.engine.emit(n)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async n=>{try{return await this.engine.disconnect(n)}catch(o){throw this.logger.error(o.message),o}},this.find=n=>{try{return this.engine.find(n)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(n){throw this.logger.error(n.message),n}},this.name=(t==null?void 0:t.name)||wc.name,this.metadata=(t==null?void 0:t.metadata)||L1();const r=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ce.pino(Ce.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||wc.logger}));this.core=(t==null?void 0:t.core)||new ux(t),this.logger=Ce.generateChildLogger(r,this.name),this.session=new Ex(this.core,this.logger),this.proposal=new _x(this.core,this.logger),this.pendingRequest=new Ix(this.core,this.logger),this.engine=new bx(this)}static async init(t){const r=new hp(t);return await r.initialize(),r}get context(){return Ce.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(t){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(t.message),t}}};const cf="error",Sx="wss://relay.walletconnect.com",Px="wc",Ox="universal_provider",uf=`${Px}@2:${Ox}:`,Cx="https://rpc.walletconnect.com/v1/",pi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var Yn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},Uc={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(s,t){(function(){var r,n="4.17.21",o=200,u="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",f="Expected a function",g="Invalid `variable` option passed into `_.template`",v="__lodash_hash_undefined__",p=500,w="__lodash_placeholder__",E=1,O=2,q=4,D=1,J=2,oe=1,fe=2,A=4,$=8,U=16,M=32,x=64,j=128,K=256,ce=512,ae=30,Ee="...",Ae=800,et=16,N=1,V=2,Me=3,Re=1/0,ee=9007199254740991,Q=17976931348623157e292,W=0/0,Y=4294967295,ut=Y-1,He=Y>>>1,zr=[["ary",j],["bind",oe],["bindKey",fe],["curry",$],["curryRight",U],["flip",ce],["partial",M],["partialRight",x],["rearg",K]],be="[object Arguments]",xt="[object Array]",L="[object AsyncFunction]",F="[object Boolean]",R="[object Date]",h="[object DOMException]",I="[object Error]",ie="[object Function]",pe="[object GeneratorFunction]",ve="[object Map]",Te="[object Number]",$e="[object Null]",xe="[object Object]",St="[object Promise]",vt="[object Proxy]",st="[object RegExp]",De="[object Set]",Je="[object String]",Qe="[object Symbol]",ot="[object Undefined]",Ue="[object WeakMap]",Ye="[object WeakSet]",Ne="[object ArrayBuffer]",ke="[object DataView]",ht="[object Float32Array]",Le="[object Float64Array]",Pt="[object Int8Array]",Dt="[object Int16Array]",kt="[object Int32Array]",Kt="[object Uint8Array]",qt="[object Uint8ClampedArray]",Qt="[object Uint16Array]",or="[object Uint32Array]",Hr=/\b__p \+= '';/g,Yt=/\b(__p \+=) '' \+/g,Yr=/(__e\(.*?\)|\b__t\)) \+\n'';/g,di=/&(?:amp|lt|gt|quot|#39);/g,Ri=/[&<>"']/g,lt=RegExp(di.source),tt=RegExp(Ri.source),ft=/<%-([\s\S]+?)%>/g,pt=/<%([\s\S]+?)%>/g,at=/<%=([\s\S]+?)%>/g,rt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ot=/^\w*$/,Ct=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,dt=/[\\^$.*+?()[\]{}|]/g,At=RegExp(dt.source),gt=/^\s+/,wt=/\s/,yt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,We=/\{\n\/\* \[wrapped with (.+)\] \*/,Rt=/,? & /,Tt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,Lo=/[()=,{}\[\]\/\s]/,qo=/\\(\\)?/g,Mo=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Ir=/\w*$/,Uo=/^[-+]0x[0-9a-f]+$/i,zo=/^0b[01]+$/i,Ho=/^\[object .+?Constructor\]$/,ko=/^0o[0-7]+$/i,Ko=/^(?:0|[1-9]\d*)$/,Zr=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,Yi=/($^)/,Vo=/['\n\r\u2028\u2029\\]/g,Zi="\\ud800-\\udfff",Bo="\\u0300-\\u036f",Go="\\ufe20-\\ufe2f",Xi="\\u20d0-\\u20ff",ls=Bo+Go+Xi,fs="\\u2700-\\u27bf",$r="a-z\\xdf-\\xf6\\xf8-\\xff",Wo="\\xac\\xb1\\xd7\\xf7",Jo="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Qo="\\u2000-\\u206f",Yo=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",ps="A-Z\\xc0-\\xd6\\xd8-\\xde",ds="\\ufe0e\\ufe0f",Ti=Wo+Jo+Qo+Yo,Pn="['’]",Ni="["+Zi+"]",On="["+Ti+"]",$i="["+ls+"]",gs="\\d+",Zo="["+fs+"]",ys="["+$r+"]",ms="[^"+Zi+Ti+gs+fs+$r+ps+"]",en="\\ud83c[\\udffb-\\udfff]",Xo="(?:"+$i+"|"+en+")",vs="[^"+Zi+"]",tn="(?:\\ud83c[\\udde6-\\uddff]){2}",gi="[\\ud800-\\udbff][\\udc00-\\udfff]",yr="["+ps+"]",ws="\\u200d",bs="(?:"+ys+"|"+ms+")",kr="(?:"+yr+"|"+ms+")",_s="(?:"+Pn+"(?:d|ll|m|re|s|t|ve))?",Es="(?:"+Pn+"(?:D|LL|M|RE|S|T|VE))?",Is=Xo+"?",xs="["+ds+"]?",ea="(?:"+ws+"(?:"+[vs,tn,gi].join("|")+")"+xs+Is+")*",Xr="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Ss="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Ps=xs+Is+ea,rn="(?:"+[Zo,tn,gi].join("|")+")"+Ps,ta="(?:"+[vs+$i+"?",$i,tn,gi,Ni].join("|")+")",Cn=RegExp(Pn,"g"),ra=RegExp($i,"g"),nn=RegExp(en+"(?="+en+")|"+ta+Ps,"g"),Os=RegExp([yr+"?"+ys+"+"+_s+"(?="+[On,yr,"$"].join("|")+")",kr+"+"+Es+"(?="+[On,yr+bs,"$"].join("|")+")",yr+"?"+bs+"+"+_s,yr+"+"+Es,Ss,Xr,gs,rn].join("|"),"g"),Cs=RegExp("["+ws+Zi+ls+ds+"]"),Fi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,As=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],ia=-1,Ke={};Ke[ht]=Ke[Le]=Ke[Pt]=Ke[Dt]=Ke[kt]=Ke[Kt]=Ke[qt]=Ke[Qt]=Ke[or]=!0,Ke[be]=Ke[xt]=Ke[Ne]=Ke[F]=Ke[ke]=Ke[R]=Ke[I]=Ke[ie]=Ke[ve]=Ke[Te]=Ke[xe]=Ke[st]=Ke[De]=Ke[Je]=Ke[Ue]=!1;var ze={};ze[be]=ze[xt]=ze[Ne]=ze[ke]=ze[F]=ze[R]=ze[ht]=ze[Le]=ze[Pt]=ze[Dt]=ze[kt]=ze[ve]=ze[Te]=ze[xe]=ze[st]=ze[De]=ze[Je]=ze[Qe]=ze[Kt]=ze[qt]=ze[Qt]=ze[or]=!0,ze[I]=ze[ie]=ze[Ue]=!1;var m={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},S={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},B={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},te={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ve=parseFloat,ge=parseInt,Ze=typeof Yn=="object"&&Yn&&Yn.Object===Object&&Yn,Nt=typeof self=="object"&&self&&self.Object===Object&&self,Pe=Ze||Nt||Function("return this")(),Be=t&&!t.nodeType&&t,bt=Be&&!0&&s&&!s.nodeType&&s,ar=bt&&bt.exports===Be,$t=ar&&Ze.process,Xe=function(){try{var P=bt&&bt.require&&bt.require("util").types;return P||$t&&$t.binding&&$t.binding("util")}catch{}}(),Zt=Xe&&Xe.isArrayBuffer,Fr=Xe&&Xe.isDate,xr=Xe&&Xe.isMap,Kr=Xe&&Xe.isRegExp,An=Xe&&Xe.isSet,Di=Xe&&Xe.isTypedArray;function Mt(P,z,T){switch(T.length){case 0:return P.call(z);case 1:return P.call(z,T[0]);case 2:return P.call(z,T[0],T[1]);case 3:return P.call(z,T[0],T[1],T[2])}return P.apply(z,T)}function pp(P,z,T,re){for(var de=-1,Fe=P==null?0:P.length;++de<Fe;){var jt=P[de];z(re,jt,T(jt),P)}return re}function Sr(P,z){for(var T=-1,re=P==null?0:P.length;++T<re&&z(P[T],T,P)!==!1;);return P}function dp(P,z){for(var T=P==null?0:P.length;T--&&z(P[T],T,P)!==!1;);return P}function cu(P,z){for(var T=-1,re=P==null?0:P.length;++T<re;)if(!z(P[T],T,P))return!1;return!0}function yi(P,z){for(var T=-1,re=P==null?0:P.length,de=0,Fe=[];++T<re;){var jt=P[T];z(jt,T,P)&&(Fe[de++]=jt)}return Fe}function Rs(P,z){var T=P==null?0:P.length;return!!T&&sn(P,z,0)>-1}function na(P,z,T){for(var re=-1,de=P==null?0:P.length;++re<de;)if(T(z,P[re]))return!0;return!1}function it(P,z){for(var T=-1,re=P==null?0:P.length,de=Array(re);++T<re;)de[T]=z(P[T],T,P);return de}function mi(P,z){for(var T=-1,re=z.length,de=P.length;++T<re;)P[de+T]=z[T];return P}function sa(P,z,T,re){var de=-1,Fe=P==null?0:P.length;for(re&&Fe&&(T=P[++de]);++de<Fe;)T=z(T,P[de],de,P);return T}function gp(P,z,T,re){var de=P==null?0:P.length;for(re&&de&&(T=P[--de]);de--;)T=z(T,P[de],de,P);return T}function oa(P,z){for(var T=-1,re=P==null?0:P.length;++T<re;)if(z(P[T],T,P))return!0;return!1}var yp=aa("length");function mp(P){return P.split("")}function vp(P){return P.match(Tt)||[]}function uu(P,z,T){var re;return T(P,function(de,Fe,jt){if(z(de,Fe,jt))return re=Fe,!1}),re}function Ts(P,z,T,re){for(var de=P.length,Fe=T+(re?1:-1);re?Fe--:++Fe<de;)if(z(P[Fe],Fe,P))return Fe;return-1}function sn(P,z,T){return z===z?Rp(P,z,T):Ts(P,hu,T)}function wp(P,z,T,re){for(var de=T-1,Fe=P.length;++de<Fe;)if(re(P[de],z))return de;return-1}function hu(P){return P!==P}function lu(P,z){var T=P==null?0:P.length;return T?ua(P,z)/T:W}function aa(P){return function(z){return z==null?r:z[P]}}function ca(P){return function(z){return P==null?r:P[z]}}function fu(P,z,T,re,de){return de(P,function(Fe,jt,Ge){T=re?(re=!1,Fe):z(T,Fe,jt,Ge)}),T}function bp(P,z){var T=P.length;for(P.sort(z);T--;)P[T]=P[T].value;return P}function ua(P,z){for(var T,re=-1,de=P.length;++re<de;){var Fe=z(P[re]);Fe!==r&&(T=T===r?Fe:T+Fe)}return T}function ha(P,z){for(var T=-1,re=Array(P);++T<P;)re[T]=z(T);return re}function _p(P,z){return it(z,function(T){return[T,P[T]]})}function pu(P){return P&&P.slice(0,mu(P)+1).replace(gt,"")}function mr(P){return function(z){return P(z)}}function la(P,z){return it(z,function(T){return P[T]})}function Rn(P,z){return P.has(z)}function du(P,z){for(var T=-1,re=P.length;++T<re&&sn(z,P[T],0)>-1;);return T}function gu(P,z){for(var T=P.length;T--&&sn(z,P[T],0)>-1;);return T}function Ep(P,z){for(var T=P.length,re=0;T--;)P[T]===z&&++re;return re}var Ip=ca(m),xp=ca(S);function Sp(P){return"\\"+te[P]}function Pp(P,z){return P==null?r:P[z]}function on(P){return Cs.test(P)}function Op(P){return Fi.test(P)}function Cp(P){for(var z,T=[];!(z=P.next()).done;)T.push(z.value);return T}function fa(P){var z=-1,T=Array(P.size);return P.forEach(function(re,de){T[++z]=[de,re]}),T}function yu(P,z){return function(T){return P(z(T))}}function vi(P,z){for(var T=-1,re=P.length,de=0,Fe=[];++T<re;){var jt=P[T];(jt===z||jt===w)&&(P[T]=w,Fe[de++]=T)}return Fe}function Ns(P){var z=-1,T=Array(P.size);return P.forEach(function(re){T[++z]=re}),T}function Ap(P){var z=-1,T=Array(P.size);return P.forEach(function(re){T[++z]=[re,re]}),T}function Rp(P,z,T){for(var re=T-1,de=P.length;++re<de;)if(P[re]===z)return re;return-1}function Tp(P,z,T){for(var re=T+1;re--;)if(P[re]===z)return re;return re}function an(P){return on(P)?$p(P):yp(P)}function Dr(P){return on(P)?Fp(P):mp(P)}function mu(P){for(var z=P.length;z--&&wt.test(P.charAt(z)););return z}var Np=ca(B);function $p(P){for(var z=nn.lastIndex=0;nn.test(P);)++z;return z}function Fp(P){return P.match(nn)||[]}function Dp(P){return P.match(Os)||[]}var jp=function P(z){z=z==null?Pe:cn.defaults(Pe.Object(),z,cn.pick(Pe,As));var T=z.Array,re=z.Date,de=z.Error,Fe=z.Function,jt=z.Math,Ge=z.Object,pa=z.RegExp,Lp=z.String,Pr=z.TypeError,$s=T.prototype,qp=Fe.prototype,un=Ge.prototype,Fs=z["__core-js_shared__"],Ds=qp.toString,qe=un.hasOwnProperty,Mp=0,vu=function(){var e=/[^.]+$/.exec(Fs&&Fs.keys&&Fs.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),js=un.toString,Up=Ds.call(Ge),zp=Pe._,Hp=pa("^"+Ds.call(qe).replace(dt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Ls=ar?z.Buffer:r,wi=z.Symbol,qs=z.Uint8Array,wu=Ls?Ls.allocUnsafe:r,Ms=yu(Ge.getPrototypeOf,Ge),bu=Ge.create,_u=un.propertyIsEnumerable,Us=$s.splice,Eu=wi?wi.isConcatSpreadable:r,Tn=wi?wi.iterator:r,ji=wi?wi.toStringTag:r,zs=function(){try{var e=zi(Ge,"defineProperty");return e({},"",{}),e}catch{}}(),kp=z.clearTimeout!==Pe.clearTimeout&&z.clearTimeout,Kp=re&&re.now!==Pe.Date.now&&re.now,Vp=z.setTimeout!==Pe.setTimeout&&z.setTimeout,Hs=jt.ceil,ks=jt.floor,da=Ge.getOwnPropertySymbols,Bp=Ls?Ls.isBuffer:r,Iu=z.isFinite,Gp=$s.join,Wp=yu(Ge.keys,Ge),Lt=jt.max,Gt=jt.min,Jp=re.now,Qp=z.parseInt,xu=jt.random,Yp=$s.reverse,ga=zi(z,"DataView"),Nn=zi(z,"Map"),ya=zi(z,"Promise"),hn=zi(z,"Set"),$n=zi(z,"WeakMap"),Fn=zi(Ge,"create"),Ks=$n&&new $n,ln={},Zp=Hi(ga),Xp=Hi(Nn),ed=Hi(ya),td=Hi(hn),rd=Hi($n),Vs=wi?wi.prototype:r,Dn=Vs?Vs.valueOf:r,Su=Vs?Vs.toString:r;function d(e){if(mt(e)&&!ye(e)&&!(e instanceof Se)){if(e instanceof Or)return e;if(qe.call(e,"__wrapped__"))return Ph(e)}return new Or(e)}var fn=function(){function e(){}return function(i){if(!ct(i))return{};if(bu)return bu(i);e.prototype=i;var a=new e;return e.prototype=r,a}}();function Bs(){}function Or(e,i){this.__wrapped__=e,this.__actions__=[],this.__chain__=!!i,this.__index__=0,this.__values__=r}d.templateSettings={escape:ft,evaluate:pt,interpolate:at,variable:"",imports:{_:d}},d.prototype=Bs.prototype,d.prototype.constructor=d,Or.prototype=fn(Bs.prototype),Or.prototype.constructor=Or;function Se(e){this.__wrapped__=e,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=Y,this.__views__=[]}function id(){var e=new Se(this.__wrapped__);return e.__actions__=cr(this.__actions__),e.__dir__=this.__dir__,e.__filtered__=this.__filtered__,e.__iteratees__=cr(this.__iteratees__),e.__takeCount__=this.__takeCount__,e.__views__=cr(this.__views__),e}function nd(){if(this.__filtered__){var e=new Se(this);e.__dir__=-1,e.__filtered__=!0}else e=this.clone(),e.__dir__*=-1;return e}function sd(){var e=this.__wrapped__.value(),i=this.__dir__,a=ye(e),c=i<0,l=a?e.length:0,y=mg(0,l,this.__views__),b=y.start,_=y.end,C=_-b,H=c?_:b-1,k=this.__iteratees__,G=k.length,X=0,ne=Gt(C,this.__takeCount__);if(!a||!c&&l==C&&ne==C)return Ju(e,this.__actions__);var he=[];e:for(;C--&&X<ne;){H+=i;for(var we=-1,le=e[H];++we<G;){var Ie=k[we],Oe=Ie.iteratee,br=Ie.type,tr=Oe(le);if(br==V)le=tr;else if(!tr){if(br==N)continue e;break e}}he[X++]=le}return he}Se.prototype=fn(Bs.prototype),Se.prototype.constructor=Se;function Li(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var c=e[i];this.set(c[0],c[1])}}function od(){this.__data__=Fn?Fn(null):{},this.size=0}function ad(e){var i=this.has(e)&&delete this.__data__[e];return this.size-=i?1:0,i}function cd(e){var i=this.__data__;if(Fn){var a=i[e];return a===v?r:a}return qe.call(i,e)?i[e]:r}function ud(e){var i=this.__data__;return Fn?i[e]!==r:qe.call(i,e)}function hd(e,i){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=Fn&&i===r?v:i,this}Li.prototype.clear=od,Li.prototype.delete=ad,Li.prototype.get=cd,Li.prototype.has=ud,Li.prototype.set=hd;function ei(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var c=e[i];this.set(c[0],c[1])}}function ld(){this.__data__=[],this.size=0}function fd(e){var i=this.__data__,a=Gs(i,e);if(a<0)return!1;var c=i.length-1;return a==c?i.pop():Us.call(i,a,1),--this.size,!0}function pd(e){var i=this.__data__,a=Gs(i,e);return a<0?r:i[a][1]}function dd(e){return Gs(this.__data__,e)>-1}function gd(e,i){var a=this.__data__,c=Gs(a,e);return c<0?(++this.size,a.push([e,i])):a[c][1]=i,this}ei.prototype.clear=ld,ei.prototype.delete=fd,ei.prototype.get=pd,ei.prototype.has=dd,ei.prototype.set=gd;function ti(e){var i=-1,a=e==null?0:e.length;for(this.clear();++i<a;){var c=e[i];this.set(c[0],c[1])}}function yd(){this.size=0,this.__data__={hash:new Li,map:new(Nn||ei),string:new Li}}function md(e){var i=so(this,e).delete(e);return this.size-=i?1:0,i}function vd(e){return so(this,e).get(e)}function wd(e){return so(this,e).has(e)}function bd(e,i){var a=so(this,e),c=a.size;return a.set(e,i),this.size+=a.size==c?0:1,this}ti.prototype.clear=yd,ti.prototype.delete=md,ti.prototype.get=vd,ti.prototype.has=wd,ti.prototype.set=bd;function qi(e){var i=-1,a=e==null?0:e.length;for(this.__data__=new ti;++i<a;)this.add(e[i])}function _d(e){return this.__data__.set(e,v),this}function Ed(e){return this.__data__.has(e)}qi.prototype.add=qi.prototype.push=_d,qi.prototype.has=Ed;function jr(e){var i=this.__data__=new ei(e);this.size=i.size}function Id(){this.__data__=new ei,this.size=0}function xd(e){var i=this.__data__,a=i.delete(e);return this.size=i.size,a}function Sd(e){return this.__data__.get(e)}function Pd(e){return this.__data__.has(e)}function Od(e,i){var a=this.__data__;if(a instanceof ei){var c=a.__data__;if(!Nn||c.length<o-1)return c.push([e,i]),this.size=++a.size,this;a=this.__data__=new ti(c)}return a.set(e,i),this.size=a.size,this}jr.prototype.clear=Id,jr.prototype.delete=xd,jr.prototype.get=Sd,jr.prototype.has=Pd,jr.prototype.set=Od;function Pu(e,i){var a=ye(e),c=!a&&ki(e),l=!a&&!c&&xi(e),y=!a&&!c&&!l&&yn(e),b=a||c||l||y,_=b?ha(e.length,Lp):[],C=_.length;for(var H in e)(i||qe.call(e,H))&&!(b&&(H=="length"||l&&(H=="offset"||H=="parent")||y&&(H=="buffer"||H=="byteLength"||H=="byteOffset")||si(H,C)))&&_.push(H);return _}function Ou(e){var i=e.length;return i?e[Oa(0,i-1)]:r}function Cd(e,i){return oo(cr(e),Mi(i,0,e.length))}function Ad(e){return oo(cr(e))}function ma(e,i,a){(a!==r&&!Lr(e[i],a)||a===r&&!(i in e))&&ri(e,i,a)}function jn(e,i,a){var c=e[i];(!(qe.call(e,i)&&Lr(c,a))||a===r&&!(i in e))&&ri(e,i,a)}function Gs(e,i){for(var a=e.length;a--;)if(Lr(e[a][0],i))return a;return-1}function Rd(e,i,a,c){return bi(e,function(l,y,b){i(c,l,a(l),b)}),c}function Cu(e,i){return e&&Br(i,Ut(i),e)}function Td(e,i){return e&&Br(i,hr(i),e)}function ri(e,i,a){i=="__proto__"&&zs?zs(e,i,{configurable:!0,enumerable:!0,value:a,writable:!0}):e[i]=a}function va(e,i){for(var a=-1,c=i.length,l=T(c),y=e==null;++a<c;)l[a]=y?r:Za(e,i[a]);return l}function Mi(e,i,a){return e===e&&(a!==r&&(e=e<=a?e:a),i!==r&&(e=e>=i?e:i)),e}function Cr(e,i,a,c,l,y){var b,_=i&E,C=i&O,H=i&q;if(a&&(b=l?a(e,c,l,y):a(e)),b!==r)return b;if(!ct(e))return e;var k=ye(e);if(k){if(b=wg(e),!_)return cr(e,b)}else{var G=Wt(e),X=G==ie||G==pe;if(xi(e))return Zu(e,_);if(G==xe||G==be||X&&!l){if(b=C||X?{}:mh(e),!_)return C?cg(e,Td(b,e)):ag(e,Cu(b,e))}else{if(!ze[G])return l?e:{};b=bg(e,G,_)}}y||(y=new jr);var ne=y.get(e);if(ne)return ne;y.set(e,b),Bh(e)?e.forEach(function(le){b.add(Cr(le,i,a,le,e,y))}):Kh(e)&&e.forEach(function(le,Ie){b.set(Ie,Cr(le,i,a,Ie,e,y))});var he=H?C?qa:La:C?hr:Ut,we=k?r:he(e);return Sr(we||e,function(le,Ie){we&&(Ie=le,le=e[Ie]),jn(b,Ie,Cr(le,i,a,Ie,e,y))}),b}function Nd(e){var i=Ut(e);return function(a){return Au(a,e,i)}}function Au(e,i,a){var c=a.length;if(e==null)return!c;for(e=Ge(e);c--;){var l=a[c],y=i[l],b=e[l];if(b===r&&!(l in e)||!y(b))return!1}return!0}function Ru(e,i,a){if(typeof e!="function")throw new Pr(f);return kn(function(){e.apply(r,a)},i)}function Ln(e,i,a,c){var l=-1,y=Rs,b=!0,_=e.length,C=[],H=i.length;if(!_)return C;a&&(i=it(i,mr(a))),c?(y=na,b=!1):i.length>=o&&(y=Rn,b=!1,i=new qi(i));e:for(;++l<_;){var k=e[l],G=a==null?k:a(k);if(k=c||k!==0?k:0,b&&G===G){for(var X=H;X--;)if(i[X]===G)continue e;C.push(k)}else y(i,G,c)||C.push(k)}return C}var bi=ih(Vr),Tu=ih(ba,!0);function $d(e,i){var a=!0;return bi(e,function(c,l,y){return a=!!i(c,l,y),a}),a}function Ws(e,i,a){for(var c=-1,l=e.length;++c<l;){var y=e[c],b=i(y);if(b!=null&&(_===r?b===b&&!wr(b):a(b,_)))var _=b,C=y}return C}function Fd(e,i,a,c){var l=e.length;for(a=me(a),a<0&&(a=-a>l?0:l+a),c=c===r||c>l?l:me(c),c<0&&(c+=l),c=a>c?0:Wh(c);a<c;)e[a++]=i;return e}function Nu(e,i){var a=[];return bi(e,function(c,l,y){i(c,l,y)&&a.push(c)}),a}function Vt(e,i,a,c,l){var y=-1,b=e.length;for(a||(a=Eg),l||(l=[]);++y<b;){var _=e[y];i>0&&a(_)?i>1?Vt(_,i-1,a,c,l):mi(l,_):c||(l[l.length]=_)}return l}var wa=nh(),$u=nh(!0);function Vr(e,i){return e&&wa(e,i,Ut)}function ba(e,i){return e&&$u(e,i,Ut)}function Js(e,i){return yi(i,function(a){return oi(e[a])})}function Ui(e,i){i=Ei(i,e);for(var a=0,c=i.length;e!=null&&a<c;)e=e[Gr(i[a++])];return a&&a==c?e:r}function Fu(e,i,a){var c=i(e);return ye(e)?c:mi(c,a(e))}function Xt(e){return e==null?e===r?ot:$e:ji&&ji in Ge(e)?yg(e):Ag(e)}function _a(e,i){return e>i}function Dd(e,i){return e!=null&&qe.call(e,i)}function jd(e,i){return e!=null&&i in Ge(e)}function Ld(e,i,a){return e>=Gt(i,a)&&e<Lt(i,a)}function Ea(e,i,a){for(var c=a?na:Rs,l=e[0].length,y=e.length,b=y,_=T(y),C=1/0,H=[];b--;){var k=e[b];b&&i&&(k=it(k,mr(i))),C=Gt(k.length,C),_[b]=!a&&(i||l>=120&&k.length>=120)?new qi(b&&k):r}k=e[0];var G=-1,X=_[0];e:for(;++G<l&&H.length<C;){var ne=k[G],he=i?i(ne):ne;if(ne=a||ne!==0?ne:0,!(X?Rn(X,he):c(H,he,a))){for(b=y;--b;){var we=_[b];if(!(we?Rn(we,he):c(e[b],he,a)))continue e}X&&X.push(he),H.push(ne)}}return H}function qd(e,i,a,c){return Vr(e,function(l,y,b){i(c,a(l),y,b)}),c}function qn(e,i,a){i=Ei(i,e),e=_h(e,i);var c=e==null?e:e[Gr(Rr(i))];return c==null?r:Mt(c,e,a)}function Du(e){return mt(e)&&Xt(e)==be}function Md(e){return mt(e)&&Xt(e)==Ne}function Ud(e){return mt(e)&&Xt(e)==R}function Mn(e,i,a,c,l){return e===i?!0:e==null||i==null||!mt(e)&&!mt(i)?e!==e&&i!==i:zd(e,i,a,c,Mn,l)}function zd(e,i,a,c,l,y){var b=ye(e),_=ye(i),C=b?xt:Wt(e),H=_?xt:Wt(i);C=C==be?xe:C,H=H==be?xe:H;var k=C==xe,G=H==xe,X=C==H;if(X&&xi(e)){if(!xi(i))return!1;b=!0,k=!1}if(X&&!k)return y||(y=new jr),b||yn(e)?dh(e,i,a,c,l,y):dg(e,i,C,a,c,l,y);if(!(a&D)){var ne=k&&qe.call(e,"__wrapped__"),he=G&&qe.call(i,"__wrapped__");if(ne||he){var we=ne?e.value():e,le=he?i.value():i;return y||(y=new jr),l(we,le,a,c,y)}}return X?(y||(y=new jr),gg(e,i,a,c,l,y)):!1}function Hd(e){return mt(e)&&Wt(e)==ve}function Ia(e,i,a,c){var l=a.length,y=l,b=!c;if(e==null)return!y;for(e=Ge(e);l--;){var _=a[l];if(b&&_[2]?_[1]!==e[_[0]]:!(_[0]in e))return!1}for(;++l<y;){_=a[l];var C=_[0],H=e[C],k=_[1];if(b&&_[2]){if(H===r&&!(C in e))return!1}else{var G=new jr;if(c)var X=c(H,k,C,e,i,G);if(!(X===r?Mn(k,H,D|J,c,G):X))return!1}}return!0}function ju(e){if(!ct(e)||xg(e))return!1;var i=oi(e)?Hp:Ho;return i.test(Hi(e))}function kd(e){return mt(e)&&Xt(e)==st}function Kd(e){return mt(e)&&Wt(e)==De}function Vd(e){return mt(e)&&fo(e.length)&&!!Ke[Xt(e)]}function Lu(e){return typeof e=="function"?e:e==null?lr:typeof e=="object"?ye(e)?Uu(e[0],e[1]):Mu(e):sl(e)}function xa(e){if(!Hn(e))return Wp(e);var i=[];for(var a in Ge(e))qe.call(e,a)&&a!="constructor"&&i.push(a);return i}function Bd(e){if(!ct(e))return Cg(e);var i=Hn(e),a=[];for(var c in e)c=="constructor"&&(i||!qe.call(e,c))||a.push(c);return a}function Sa(e,i){return e<i}function qu(e,i){var a=-1,c=ur(e)?T(e.length):[];return bi(e,function(l,y,b){c[++a]=i(l,y,b)}),c}function Mu(e){var i=Ua(e);return i.length==1&&i[0][2]?wh(i[0][0],i[0][1]):function(a){return a===e||Ia(a,e,i)}}function Uu(e,i){return Ha(e)&&vh(i)?wh(Gr(e),i):function(a){var c=Za(a,e);return c===r&&c===i?Xa(a,e):Mn(i,c,D|J)}}function Qs(e,i,a,c,l){e!==i&&wa(i,function(y,b){if(l||(l=new jr),ct(y))Gd(e,i,b,a,Qs,c,l);else{var _=c?c(Ka(e,b),y,b+"",e,i,l):r;_===r&&(_=y),ma(e,b,_)}},hr)}function Gd(e,i,a,c,l,y,b){var _=Ka(e,a),C=Ka(i,a),H=b.get(C);if(H){ma(e,a,H);return}var k=y?y(_,C,a+"",e,i,b):r,G=k===r;if(G){var X=ye(C),ne=!X&&xi(C),he=!X&&!ne&&yn(C);k=C,X||ne||he?ye(_)?k=_:_t(_)?k=cr(_):ne?(G=!1,k=Zu(C,!0)):he?(G=!1,k=Xu(C,!0)):k=[]:Kn(C)||ki(C)?(k=_,ki(_)?k=Jh(_):(!ct(_)||oi(_))&&(k=mh(C))):G=!1}G&&(b.set(C,k),l(k,C,c,y,b),b.delete(C)),ma(e,a,k)}function zu(e,i){var a=e.length;if(a)return i+=i<0?a:0,si(i,a)?e[i]:r}function Hu(e,i,a){i.length?i=it(i,function(y){return ye(y)?function(b){return Ui(b,y.length===1?y[0]:y)}:y}):i=[lr];var c=-1;i=it(i,mr(ue()));var l=qu(e,function(y,b,_){var C=it(i,function(H){return H(y)});return{criteria:C,index:++c,value:y}});return bp(l,function(y,b){return og(y,b,a)})}function Wd(e,i){return ku(e,i,function(a,c){return Xa(e,c)})}function ku(e,i,a){for(var c=-1,l=i.length,y={};++c<l;){var b=i[c],_=Ui(e,b);a(_,b)&&Un(y,Ei(b,e),_)}return y}function Jd(e){return function(i){return Ui(i,e)}}function Pa(e,i,a,c){var l=c?wp:sn,y=-1,b=i.length,_=e;for(e===i&&(i=cr(i)),a&&(_=it(e,mr(a)));++y<b;)for(var C=0,H=i[y],k=a?a(H):H;(C=l(_,k,C,c))>-1;)_!==e&&Us.call(_,C,1),Us.call(e,C,1);return e}function Ku(e,i){for(var a=e?i.length:0,c=a-1;a--;){var l=i[a];if(a==c||l!==y){var y=l;si(l)?Us.call(e,l,1):Ra(e,l)}}return e}function Oa(e,i){return e+ks(xu()*(i-e+1))}function Qd(e,i,a,c){for(var l=-1,y=Lt(Hs((i-e)/(a||1)),0),b=T(y);y--;)b[c?y:++l]=e,e+=a;return b}function Ca(e,i){var a="";if(!e||i<1||i>ee)return a;do i%2&&(a+=e),i=ks(i/2),i&&(e+=e);while(i);return a}function _e(e,i){return Va(bh(e,i,lr),e+"")}function Yd(e){return Ou(mn(e))}function Zd(e,i){var a=mn(e);return oo(a,Mi(i,0,a.length))}function Un(e,i,a,c){if(!ct(e))return e;i=Ei(i,e);for(var l=-1,y=i.length,b=y-1,_=e;_!=null&&++l<y;){var C=Gr(i[l]),H=a;if(C==="__proto__"||C==="constructor"||C==="prototype")return e;if(l!=b){var k=_[C];H=c?c(k,C,_):r,H===r&&(H=ct(k)?k:si(i[l+1])?[]:{})}jn(_,C,H),_=_[C]}return e}var Vu=Ks?function(e,i){return Ks.set(e,i),e}:lr,Xd=zs?function(e,i){return zs(e,"toString",{configurable:!0,enumerable:!1,value:tc(i),writable:!0})}:lr;function eg(e){return oo(mn(e))}function Ar(e,i,a){var c=-1,l=e.length;i<0&&(i=-i>l?0:l+i),a=a>l?l:a,a<0&&(a+=l),l=i>a?0:a-i>>>0,i>>>=0;for(var y=T(l);++c<l;)y[c]=e[c+i];return y}function tg(e,i){var a;return bi(e,function(c,l,y){return a=i(c,l,y),!a}),!!a}function Ys(e,i,a){var c=0,l=e==null?c:e.length;if(typeof i=="number"&&i===i&&l<=He){for(;c<l;){var y=c+l>>>1,b=e[y];b!==null&&!wr(b)&&(a?b<=i:b<i)?c=y+1:l=y}return l}return Aa(e,i,lr,a)}function Aa(e,i,a,c){var l=0,y=e==null?0:e.length;if(y===0)return 0;i=a(i);for(var b=i!==i,_=i===null,C=wr(i),H=i===r;l<y;){var k=ks((l+y)/2),G=a(e[k]),X=G!==r,ne=G===null,he=G===G,we=wr(G);if(b)var le=c||he;else H?le=he&&(c||X):_?le=he&&X&&(c||!ne):C?le=he&&X&&!ne&&(c||!we):ne||we?le=!1:le=c?G<=i:G<i;le?l=k+1:y=k}return Gt(y,ut)}function Bu(e,i){for(var a=-1,c=e.length,l=0,y=[];++a<c;){var b=e[a],_=i?i(b):b;if(!a||!Lr(_,C)){var C=_;y[l++]=b===0?0:b}}return y}function Gu(e){return typeof e=="number"?e:wr(e)?W:+e}function vr(e){if(typeof e=="string")return e;if(ye(e))return it(e,vr)+"";if(wr(e))return Su?Su.call(e):"";var i=e+"";return i=="0"&&1/e==-Re?"-0":i}function _i(e,i,a){var c=-1,l=Rs,y=e.length,b=!0,_=[],C=_;if(a)b=!1,l=na;else if(y>=o){var H=i?null:fg(e);if(H)return Ns(H);b=!1,l=Rn,C=new qi}else C=i?[]:_;e:for(;++c<y;){var k=e[c],G=i?i(k):k;if(k=a||k!==0?k:0,b&&G===G){for(var X=C.length;X--;)if(C[X]===G)continue e;i&&C.push(G),_.push(k)}else l(C,G,a)||(C!==_&&C.push(G),_.push(k))}return _}function Ra(e,i){return i=Ei(i,e),e=_h(e,i),e==null||delete e[Gr(Rr(i))]}function Wu(e,i,a,c){return Un(e,i,a(Ui(e,i)),c)}function Zs(e,i,a,c){for(var l=e.length,y=c?l:-1;(c?y--:++y<l)&&i(e[y],y,e););return a?Ar(e,c?0:y,c?y+1:l):Ar(e,c?y+1:0,c?l:y)}function Ju(e,i){var a=e;return a instanceof Se&&(a=a.value()),sa(i,function(c,l){return l.func.apply(l.thisArg,mi([c],l.args))},a)}function Ta(e,i,a){var c=e.length;if(c<2)return c?_i(e[0]):[];for(var l=-1,y=T(c);++l<c;)for(var b=e[l],_=-1;++_<c;)_!=l&&(y[l]=Ln(y[l]||b,e[_],i,a));return _i(Vt(y,1),i,a)}function Qu(e,i,a){for(var c=-1,l=e.length,y=i.length,b={};++c<l;){var _=c<y?i[c]:r;a(b,e[c],_)}return b}function Na(e){return _t(e)?e:[]}function $a(e){return typeof e=="function"?e:lr}function Ei(e,i){return ye(e)?e:Ha(e,i)?[e]:Sh(je(e))}var rg=_e;function Ii(e,i,a){var c=e.length;return a=a===r?c:a,!i&&a>=c?e:Ar(e,i,a)}var Yu=kp||function(e){return Pe.clearTimeout(e)};function Zu(e,i){if(i)return e.slice();var a=e.length,c=wu?wu(a):new e.constructor(a);return e.copy(c),c}function Fa(e){var i=new e.constructor(e.byteLength);return new qs(i).set(new qs(e)),i}function ig(e,i){var a=i?Fa(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.byteLength)}function ng(e){var i=new e.constructor(e.source,Ir.exec(e));return i.lastIndex=e.lastIndex,i}function sg(e){return Dn?Ge(Dn.call(e)):{}}function Xu(e,i){var a=i?Fa(e.buffer):e.buffer;return new e.constructor(a,e.byteOffset,e.length)}function eh(e,i){if(e!==i){var a=e!==r,c=e===null,l=e===e,y=wr(e),b=i!==r,_=i===null,C=i===i,H=wr(i);if(!_&&!H&&!y&&e>i||y&&b&&C&&!_&&!H||c&&b&&C||!a&&C||!l)return 1;if(!c&&!y&&!H&&e<i||H&&a&&l&&!c&&!y||_&&a&&l||!b&&l||!C)return-1}return 0}function og(e,i,a){for(var c=-1,l=e.criteria,y=i.criteria,b=l.length,_=a.length;++c<b;){var C=eh(l[c],y[c]);if(C){if(c>=_)return C;var H=a[c];return C*(H=="desc"?-1:1)}}return e.index-i.index}function th(e,i,a,c){for(var l=-1,y=e.length,b=a.length,_=-1,C=i.length,H=Lt(y-b,0),k=T(C+H),G=!c;++_<C;)k[_]=i[_];for(;++l<b;)(G||l<y)&&(k[a[l]]=e[l]);for(;H--;)k[_++]=e[l++];return k}function rh(e,i,a,c){for(var l=-1,y=e.length,b=-1,_=a.length,C=-1,H=i.length,k=Lt(y-_,0),G=T(k+H),X=!c;++l<k;)G[l]=e[l];for(var ne=l;++C<H;)G[ne+C]=i[C];for(;++b<_;)(X||l<y)&&(G[ne+a[b]]=e[l++]);return G}function cr(e,i){var a=-1,c=e.length;for(i||(i=T(c));++a<c;)i[a]=e[a];return i}function Br(e,i,a,c){var l=!a;a||(a={});for(var y=-1,b=i.length;++y<b;){var _=i[y],C=c?c(a[_],e[_],_,a,e):r;C===r&&(C=e[_]),l?ri(a,_,C):jn(a,_,C)}return a}function ag(e,i){return Br(e,za(e),i)}function cg(e,i){return Br(e,gh(e),i)}function Xs(e,i){return function(a,c){var l=ye(a)?pp:Rd,y=i?i():{};return l(a,e,ue(c,2),y)}}function pn(e){return _e(function(i,a){var c=-1,l=a.length,y=l>1?a[l-1]:r,b=l>2?a[2]:r;for(y=e.length>3&&typeof y=="function"?(l--,y):r,b&&er(a[0],a[1],b)&&(y=l<3?r:y,l=1),i=Ge(i);++c<l;){var _=a[c];_&&e(i,_,c,y)}return i})}function ih(e,i){return function(a,c){if(a==null)return a;if(!ur(a))return e(a,c);for(var l=a.length,y=i?l:-1,b=Ge(a);(i?y--:++y<l)&&c(b[y],y,b)!==!1;);return a}}function nh(e){return function(i,a,c){for(var l=-1,y=Ge(i),b=c(i),_=b.length;_--;){var C=b[e?_:++l];if(a(y[C],C,y)===!1)break}return i}}function ug(e,i,a){var c=i&oe,l=zn(e);function y(){var b=this&&this!==Pe&&this instanceof y?l:e;return b.apply(c?a:this,arguments)}return y}function sh(e){return function(i){i=je(i);var a=on(i)?Dr(i):r,c=a?a[0]:i.charAt(0),l=a?Ii(a,1).join(""):i.slice(1);return c[e]()+l}}function dn(e){return function(i){return sa(il(rl(i).replace(Cn,"")),e,"")}}function zn(e){return function(){var i=arguments;switch(i.length){case 0:return new e;case 1:return new e(i[0]);case 2:return new e(i[0],i[1]);case 3:return new e(i[0],i[1],i[2]);case 4:return new e(i[0],i[1],i[2],i[3]);case 5:return new e(i[0],i[1],i[2],i[3],i[4]);case 6:return new e(i[0],i[1],i[2],i[3],i[4],i[5]);case 7:return new e(i[0],i[1],i[2],i[3],i[4],i[5],i[6])}var a=fn(e.prototype),c=e.apply(a,i);return ct(c)?c:a}}function hg(e,i,a){var c=zn(e);function l(){for(var y=arguments.length,b=T(y),_=y,C=gn(l);_--;)b[_]=arguments[_];var H=y<3&&b[0]!==C&&b[y-1]!==C?[]:vi(b,C);if(y-=H.length,y<a)return hh(e,i,eo,l.placeholder,r,b,H,r,r,a-y);var k=this&&this!==Pe&&this instanceof l?c:e;return Mt(k,this,b)}return l}function oh(e){return function(i,a,c){var l=Ge(i);if(!ur(i)){var y=ue(a,3);i=Ut(i),a=function(_){return y(l[_],_,l)}}var b=e(i,a,c);return b>-1?l[y?i[b]:b]:r}}function ah(e){return ni(function(i){var a=i.length,c=a,l=Or.prototype.thru;for(e&&i.reverse();c--;){var y=i[c];if(typeof y!="function")throw new Pr(f);if(l&&!b&&no(y)=="wrapper")var b=new Or([],!0)}for(c=b?c:a;++c<a;){y=i[c];var _=no(y),C=_=="wrapper"?Ma(y):r;C&&ka(C[0])&&C[1]==(j|$|M|K)&&!C[4].length&&C[9]==1?b=b[no(C[0])].apply(b,C[3]):b=y.length==1&&ka(y)?b[_]():b.thru(y)}return function(){var H=arguments,k=H[0];if(b&&H.length==1&&ye(k))return b.plant(k).value();for(var G=0,X=a?i[G].apply(this,H):k;++G<a;)X=i[G].call(this,X);return X}})}function eo(e,i,a,c,l,y,b,_,C,H){var k=i&j,G=i&oe,X=i&fe,ne=i&($|U),he=i&ce,we=X?r:zn(e);function le(){for(var Ie=arguments.length,Oe=T(Ie),br=Ie;br--;)Oe[br]=arguments[br];if(ne)var tr=gn(le),_r=Ep(Oe,tr);if(c&&(Oe=th(Oe,c,l,ne)),y&&(Oe=rh(Oe,y,b,ne)),Ie-=_r,ne&&Ie<H){var Et=vi(Oe,tr);return hh(e,i,eo,le.placeholder,a,Oe,Et,_,C,H-Ie)}var qr=G?a:this,ci=X?qr[e]:e;return Ie=Oe.length,_?Oe=Rg(Oe,_):he&&Ie>1&&Oe.reverse(),k&&C<Ie&&(Oe.length=C),this&&this!==Pe&&this instanceof le&&(ci=we||zn(ci)),ci.apply(qr,Oe)}return le}function ch(e,i){return function(a,c){return qd(a,e,i(c),{})}}function to(e,i){return function(a,c){var l;if(a===r&&c===r)return i;if(a!==r&&(l=a),c!==r){if(l===r)return c;typeof a=="string"||typeof c=="string"?(a=vr(a),c=vr(c)):(a=Gu(a),c=Gu(c)),l=e(a,c)}return l}}function Da(e){return ni(function(i){return i=it(i,mr(ue())),_e(function(a){var c=this;return e(i,function(l){return Mt(l,c,a)})})})}function ro(e,i){i=i===r?" ":vr(i);var a=i.length;if(a<2)return a?Ca(i,e):i;var c=Ca(i,Hs(e/an(i)));return on(i)?Ii(Dr(c),0,e).join(""):c.slice(0,e)}function lg(e,i,a,c){var l=i&oe,y=zn(e);function b(){for(var _=-1,C=arguments.length,H=-1,k=c.length,G=T(k+C),X=this&&this!==Pe&&this instanceof b?y:e;++H<k;)G[H]=c[H];for(;C--;)G[H++]=arguments[++_];return Mt(X,l?a:this,G)}return b}function uh(e){return function(i,a,c){return c&&typeof c!="number"&&er(i,a,c)&&(a=c=r),i=ai(i),a===r?(a=i,i=0):a=ai(a),c=c===r?i<a?1:-1:ai(c),Qd(i,a,c,e)}}function io(e){return function(i,a){return typeof i=="string"&&typeof a=="string"||(i=Tr(i),a=Tr(a)),e(i,a)}}function hh(e,i,a,c,l,y,b,_,C,H){var k=i&$,G=k?b:r,X=k?r:b,ne=k?y:r,he=k?r:y;i|=k?M:x,i&=~(k?x:M),i&A||(i&=~(oe|fe));var we=[e,i,l,ne,G,he,X,_,C,H],le=a.apply(r,we);return ka(e)&&Eh(le,we),le.placeholder=c,Ih(le,e,i)}function ja(e){var i=jt[e];return function(a,c){if(a=Tr(a),c=c==null?0:Gt(me(c),292),c&&Iu(a)){var l=(je(a)+"e").split("e"),y=i(l[0]+"e"+(+l[1]+c));return l=(je(y)+"e").split("e"),+(l[0]+"e"+(+l[1]-c))}return i(a)}}var fg=hn&&1/Ns(new hn([,-0]))[1]==Re?function(e){return new hn(e)}:nc;function lh(e){return function(i){var a=Wt(i);return a==ve?fa(i):a==De?Ap(i):_p(i,e(i))}}function ii(e,i,a,c,l,y,b,_){var C=i&fe;if(!C&&typeof e!="function")throw new Pr(f);var H=c?c.length:0;if(H||(i&=~(M|x),c=l=r),b=b===r?b:Lt(me(b),0),_=_===r?_:me(_),H-=l?l.length:0,i&x){var k=c,G=l;c=l=r}var X=C?r:Ma(e),ne=[e,i,a,c,l,k,G,y,b,_];if(X&&Og(ne,X),e=ne[0],i=ne[1],a=ne[2],c=ne[3],l=ne[4],_=ne[9]=ne[9]===r?C?0:e.length:Lt(ne[9]-H,0),!_&&i&($|U)&&(i&=~($|U)),!i||i==oe)var he=ug(e,i,a);else i==$||i==U?he=hg(e,i,_):(i==M||i==(oe|M))&&!l.length?he=lg(e,i,a,c):he=eo.apply(r,ne);var we=X?Vu:Eh;return Ih(we(he,ne),e,i)}function fh(e,i,a,c){return e===r||Lr(e,un[a])&&!qe.call(c,a)?i:e}function ph(e,i,a,c,l,y){return ct(e)&&ct(i)&&(y.set(i,e),Qs(e,i,r,ph,y),y.delete(i)),e}function pg(e){return Kn(e)?r:e}function dh(e,i,a,c,l,y){var b=a&D,_=e.length,C=i.length;if(_!=C&&!(b&&C>_))return!1;var H=y.get(e),k=y.get(i);if(H&&k)return H==i&&k==e;var G=-1,X=!0,ne=a&J?new qi:r;for(y.set(e,i),y.set(i,e);++G<_;){var he=e[G],we=i[G];if(c)var le=b?c(we,he,G,i,e,y):c(he,we,G,e,i,y);if(le!==r){if(le)continue;X=!1;break}if(ne){if(!oa(i,function(Ie,Oe){if(!Rn(ne,Oe)&&(he===Ie||l(he,Ie,a,c,y)))return ne.push(Oe)})){X=!1;break}}else if(!(he===we||l(he,we,a,c,y))){X=!1;break}}return y.delete(e),y.delete(i),X}function dg(e,i,a,c,l,y,b){switch(a){case ke:if(e.byteLength!=i.byteLength||e.byteOffset!=i.byteOffset)return!1;e=e.buffer,i=i.buffer;case Ne:return!(e.byteLength!=i.byteLength||!y(new qs(e),new qs(i)));case F:case R:case Te:return Lr(+e,+i);case I:return e.name==i.name&&e.message==i.message;case st:case Je:return e==i+"";case ve:var _=fa;case De:var C=c&D;if(_||(_=Ns),e.size!=i.size&&!C)return!1;var H=b.get(e);if(H)return H==i;c|=J,b.set(e,i);var k=dh(_(e),_(i),c,l,y,b);return b.delete(e),k;case Qe:if(Dn)return Dn.call(e)==Dn.call(i)}return!1}function gg(e,i,a,c,l,y){var b=a&D,_=La(e),C=_.length,H=La(i),k=H.length;if(C!=k&&!b)return!1;for(var G=C;G--;){var X=_[G];if(!(b?X in i:qe.call(i,X)))return!1}var ne=y.get(e),he=y.get(i);if(ne&&he)return ne==i&&he==e;var we=!0;y.set(e,i),y.set(i,e);for(var le=b;++G<C;){X=_[G];var Ie=e[X],Oe=i[X];if(c)var br=b?c(Oe,Ie,X,i,e,y):c(Ie,Oe,X,e,i,y);if(!(br===r?Ie===Oe||l(Ie,Oe,a,c,y):br)){we=!1;break}le||(le=X=="constructor")}if(we&&!le){var tr=e.constructor,_r=i.constructor;tr!=_r&&"constructor"in e&&"constructor"in i&&!(typeof tr=="function"&&tr instanceof tr&&typeof _r=="function"&&_r instanceof _r)&&(we=!1)}return y.delete(e),y.delete(i),we}function ni(e){return Va(bh(e,r,Ah),e+"")}function La(e){return Fu(e,Ut,za)}function qa(e){return Fu(e,hr,gh)}var Ma=Ks?function(e){return Ks.get(e)}:nc;function no(e){for(var i=e.name+"",a=ln[i],c=qe.call(ln,i)?a.length:0;c--;){var l=a[c],y=l.func;if(y==null||y==e)return l.name}return i}function gn(e){var i=qe.call(d,"placeholder")?d:e;return i.placeholder}function ue(){var e=d.iteratee||rc;return e=e===rc?Lu:e,arguments.length?e(arguments[0],arguments[1]):e}function so(e,i){var a=e.__data__;return Ig(i)?a[typeof i=="string"?"string":"hash"]:a.map}function Ua(e){for(var i=Ut(e),a=i.length;a--;){var c=i[a],l=e[c];i[a]=[c,l,vh(l)]}return i}function zi(e,i){var a=Pp(e,i);return ju(a)?a:r}function yg(e){var i=qe.call(e,ji),a=e[ji];try{e[ji]=r;var c=!0}catch{}var l=js.call(e);return c&&(i?e[ji]=a:delete e[ji]),l}var za=da?function(e){return e==null?[]:(e=Ge(e),yi(da(e),function(i){return _u.call(e,i)}))}:sc,gh=da?function(e){for(var i=[];e;)mi(i,za(e)),e=Ms(e);return i}:sc,Wt=Xt;(ga&&Wt(new ga(new ArrayBuffer(1)))!=ke||Nn&&Wt(new Nn)!=ve||ya&&Wt(ya.resolve())!=St||hn&&Wt(new hn)!=De||$n&&Wt(new $n)!=Ue)&&(Wt=function(e){var i=Xt(e),a=i==xe?e.constructor:r,c=a?Hi(a):"";if(c)switch(c){case Zp:return ke;case Xp:return ve;case ed:return St;case td:return De;case rd:return Ue}return i});function mg(e,i,a){for(var c=-1,l=a.length;++c<l;){var y=a[c],b=y.size;switch(y.type){case"drop":e+=b;break;case"dropRight":i-=b;break;case"take":i=Gt(i,e+b);break;case"takeRight":e=Lt(e,i-b);break}}return{start:e,end:i}}function vg(e){var i=e.match(We);return i?i[1].split(Rt):[]}function yh(e,i,a){i=Ei(i,e);for(var c=-1,l=i.length,y=!1;++c<l;){var b=Gr(i[c]);if(!(y=e!=null&&a(e,b)))break;e=e[b]}return y||++c!=l?y:(l=e==null?0:e.length,!!l&&fo(l)&&si(b,l)&&(ye(e)||ki(e)))}function wg(e){var i=e.length,a=new e.constructor(i);return i&&typeof e[0]=="string"&&qe.call(e,"index")&&(a.index=e.index,a.input=e.input),a}function mh(e){return typeof e.constructor=="function"&&!Hn(e)?fn(Ms(e)):{}}function bg(e,i,a){var c=e.constructor;switch(i){case Ne:return Fa(e);case F:case R:return new c(+e);case ke:return ig(e,a);case ht:case Le:case Pt:case Dt:case kt:case Kt:case qt:case Qt:case or:return Xu(e,a);case ve:return new c;case Te:case Je:return new c(e);case st:return ng(e);case De:return new c;case Qe:return sg(e)}}function _g(e,i){var a=i.length;if(!a)return e;var c=a-1;return i[c]=(a>1?"& ":"")+i[c],i=i.join(a>2?", ":" "),e.replace(yt,`{
/* [wrapped with `+i+`] */
`)}function Eg(e){return ye(e)||ki(e)||!!(Eu&&e&&e[Eu])}function si(e,i){var a=typeof e;return i=i??ee,!!i&&(a=="number"||a!="symbol"&&Ko.test(e))&&e>-1&&e%1==0&&e<i}function er(e,i,a){if(!ct(a))return!1;var c=typeof i;return(c=="number"?ur(a)&&si(i,a.length):c=="string"&&i in a)?Lr(a[i],e):!1}function Ha(e,i){if(ye(e))return!1;var a=typeof e;return a=="number"||a=="symbol"||a=="boolean"||e==null||wr(e)?!0:Ot.test(e)||!rt.test(e)||i!=null&&e in Ge(i)}function Ig(e){var i=typeof e;return i=="string"||i=="number"||i=="symbol"||i=="boolean"?e!=="__proto__":e===null}function ka(e){var i=no(e),a=d[i];if(typeof a!="function"||!(i in Se.prototype))return!1;if(e===a)return!0;var c=Ma(a);return!!c&&e===c[0]}function xg(e){return!!vu&&vu in e}var Sg=Fs?oi:oc;function Hn(e){var i=e&&e.constructor,a=typeof i=="function"&&i.prototype||un;return e===a}function vh(e){return e===e&&!ct(e)}function wh(e,i){return function(a){return a==null?!1:a[e]===i&&(i!==r||e in Ge(a))}}function Pg(e){var i=ho(e,function(c){return a.size===p&&a.clear(),c}),a=i.cache;return i}function Og(e,i){var a=e[1],c=i[1],l=a|c,y=l<(oe|fe|j),b=c==j&&a==$||c==j&&a==K&&e[7].length<=i[8]||c==(j|K)&&i[7].length<=i[8]&&a==$;if(!(y||b))return e;c&oe&&(e[2]=i[2],l|=a&oe?0:A);var _=i[3];if(_){var C=e[3];e[3]=C?th(C,_,i[4]):_,e[4]=C?vi(e[3],w):i[4]}return _=i[5],_&&(C=e[5],e[5]=C?rh(C,_,i[6]):_,e[6]=C?vi(e[5],w):i[6]),_=i[7],_&&(e[7]=_),c&j&&(e[8]=e[8]==null?i[8]:Gt(e[8],i[8])),e[9]==null&&(e[9]=i[9]),e[0]=i[0],e[1]=l,e}function Cg(e){var i=[];if(e!=null)for(var a in Ge(e))i.push(a);return i}function Ag(e){return js.call(e)}function bh(e,i,a){return i=Lt(i===r?e.length-1:i,0),function(){for(var c=arguments,l=-1,y=Lt(c.length-i,0),b=T(y);++l<y;)b[l]=c[i+l];l=-1;for(var _=T(i+1);++l<i;)_[l]=c[l];return _[i]=a(b),Mt(e,this,_)}}function _h(e,i){return i.length<2?e:Ui(e,Ar(i,0,-1))}function Rg(e,i){for(var a=e.length,c=Gt(i.length,a),l=cr(e);c--;){var y=i[c];e[c]=si(y,a)?l[y]:r}return e}function Ka(e,i){if(!(i==="constructor"&&typeof e[i]=="function")&&i!="__proto__")return e[i]}var Eh=xh(Vu),kn=Vp||function(e,i){return Pe.setTimeout(e,i)},Va=xh(Xd);function Ih(e,i,a){var c=i+"";return Va(e,_g(c,Tg(vg(c),a)))}function xh(e){var i=0,a=0;return function(){var c=Jp(),l=et-(c-a);if(a=c,l>0){if(++i>=Ae)return arguments[0]}else i=0;return e.apply(r,arguments)}}function oo(e,i){var a=-1,c=e.length,l=c-1;for(i=i===r?c:i;++a<i;){var y=Oa(a,l),b=e[y];e[y]=e[a],e[a]=b}return e.length=i,e}var Sh=Pg(function(e){var i=[];return e.charCodeAt(0)===46&&i.push(""),e.replace(Ct,function(a,c,l,y){i.push(l?y.replace(qo,"$1"):c||a)}),i});function Gr(e){if(typeof e=="string"||wr(e))return e;var i=e+"";return i=="0"&&1/e==-Re?"-0":i}function Hi(e){if(e!=null){try{return Ds.call(e)}catch{}try{return e+""}catch{}}return""}function Tg(e,i){return Sr(zr,function(a){var c="_."+a[0];i&a[1]&&!Rs(e,c)&&e.push(c)}),e.sort()}function Ph(e){if(e instanceof Se)return e.clone();var i=new Or(e.__wrapped__,e.__chain__);return i.__actions__=cr(e.__actions__),i.__index__=e.__index__,i.__values__=e.__values__,i}function Ng(e,i,a){(a?er(e,i,a):i===r)?i=1:i=Lt(me(i),0);var c=e==null?0:e.length;if(!c||i<1)return[];for(var l=0,y=0,b=T(Hs(c/i));l<c;)b[y++]=Ar(e,l,l+=i);return b}function $g(e){for(var i=-1,a=e==null?0:e.length,c=0,l=[];++i<a;){var y=e[i];y&&(l[c++]=y)}return l}function Fg(){var e=arguments.length;if(!e)return[];for(var i=T(e-1),a=arguments[0],c=e;c--;)i[c-1]=arguments[c];return mi(ye(a)?cr(a):[a],Vt(i,1))}var Dg=_e(function(e,i){return _t(e)?Ln(e,Vt(i,1,_t,!0)):[]}),jg=_e(function(e,i){var a=Rr(i);return _t(a)&&(a=r),_t(e)?Ln(e,Vt(i,1,_t,!0),ue(a,2)):[]}),Lg=_e(function(e,i){var a=Rr(i);return _t(a)&&(a=r),_t(e)?Ln(e,Vt(i,1,_t,!0),r,a):[]});function qg(e,i,a){var c=e==null?0:e.length;return c?(i=a||i===r?1:me(i),Ar(e,i<0?0:i,c)):[]}function Mg(e,i,a){var c=e==null?0:e.length;return c?(i=a||i===r?1:me(i),i=c-i,Ar(e,0,i<0?0:i)):[]}function Ug(e,i){return e&&e.length?Zs(e,ue(i,3),!0,!0):[]}function zg(e,i){return e&&e.length?Zs(e,ue(i,3),!0):[]}function Hg(e,i,a,c){var l=e==null?0:e.length;return l?(a&&typeof a!="number"&&er(e,i,a)&&(a=0,c=l),Fd(e,i,a,c)):[]}function Oh(e,i,a){var c=e==null?0:e.length;if(!c)return-1;var l=a==null?0:me(a);return l<0&&(l=Lt(c+l,0)),Ts(e,ue(i,3),l)}function Ch(e,i,a){var c=e==null?0:e.length;if(!c)return-1;var l=c-1;return a!==r&&(l=me(a),l=a<0?Lt(c+l,0):Gt(l,c-1)),Ts(e,ue(i,3),l,!0)}function Ah(e){var i=e==null?0:e.length;return i?Vt(e,1):[]}function kg(e){var i=e==null?0:e.length;return i?Vt(e,Re):[]}function Kg(e,i){var a=e==null?0:e.length;return a?(i=i===r?1:me(i),Vt(e,i)):[]}function Vg(e){for(var i=-1,a=e==null?0:e.length,c={};++i<a;){var l=e[i];c[l[0]]=l[1]}return c}function Rh(e){return e&&e.length?e[0]:r}function Bg(e,i,a){var c=e==null?0:e.length;if(!c)return-1;var l=a==null?0:me(a);return l<0&&(l=Lt(c+l,0)),sn(e,i,l)}function Gg(e){var i=e==null?0:e.length;return i?Ar(e,0,-1):[]}var Wg=_e(function(e){var i=it(e,Na);return i.length&&i[0]===e[0]?Ea(i):[]}),Jg=_e(function(e){var i=Rr(e),a=it(e,Na);return i===Rr(a)?i=r:a.pop(),a.length&&a[0]===e[0]?Ea(a,ue(i,2)):[]}),Qg=_e(function(e){var i=Rr(e),a=it(e,Na);return i=typeof i=="function"?i:r,i&&a.pop(),a.length&&a[0]===e[0]?Ea(a,r,i):[]});function Yg(e,i){return e==null?"":Gp.call(e,i)}function Rr(e){var i=e==null?0:e.length;return i?e[i-1]:r}function Zg(e,i,a){var c=e==null?0:e.length;if(!c)return-1;var l=c;return a!==r&&(l=me(a),l=l<0?Lt(c+l,0):Gt(l,c-1)),i===i?Tp(e,i,l):Ts(e,hu,l,!0)}function Xg(e,i){return e&&e.length?zu(e,me(i)):r}var ey=_e(Th);function Th(e,i){return e&&e.length&&i&&i.length?Pa(e,i):e}function ty(e,i,a){return e&&e.length&&i&&i.length?Pa(e,i,ue(a,2)):e}function ry(e,i,a){return e&&e.length&&i&&i.length?Pa(e,i,r,a):e}var iy=ni(function(e,i){var a=e==null?0:e.length,c=va(e,i);return Ku(e,it(i,function(l){return si(l,a)?+l:l}).sort(eh)),c});function ny(e,i){var a=[];if(!(e&&e.length))return a;var c=-1,l=[],y=e.length;for(i=ue(i,3);++c<y;){var b=e[c];i(b,c,e)&&(a.push(b),l.push(c))}return Ku(e,l),a}function Ba(e){return e==null?e:Yp.call(e)}function sy(e,i,a){var c=e==null?0:e.length;return c?(a&&typeof a!="number"&&er(e,i,a)?(i=0,a=c):(i=i==null?0:me(i),a=a===r?c:me(a)),Ar(e,i,a)):[]}function oy(e,i){return Ys(e,i)}function ay(e,i,a){return Aa(e,i,ue(a,2))}function cy(e,i){var a=e==null?0:e.length;if(a){var c=Ys(e,i);if(c<a&&Lr(e[c],i))return c}return-1}function uy(e,i){return Ys(e,i,!0)}function hy(e,i,a){return Aa(e,i,ue(a,2),!0)}function ly(e,i){var a=e==null?0:e.length;if(a){var c=Ys(e,i,!0)-1;if(Lr(e[c],i))return c}return-1}function fy(e){return e&&e.length?Bu(e):[]}function py(e,i){return e&&e.length?Bu(e,ue(i,2)):[]}function dy(e){var i=e==null?0:e.length;return i?Ar(e,1,i):[]}function gy(e,i,a){return e&&e.length?(i=a||i===r?1:me(i),Ar(e,0,i<0?0:i)):[]}function yy(e,i,a){var c=e==null?0:e.length;return c?(i=a||i===r?1:me(i),i=c-i,Ar(e,i<0?0:i,c)):[]}function my(e,i){return e&&e.length?Zs(e,ue(i,3),!1,!0):[]}function vy(e,i){return e&&e.length?Zs(e,ue(i,3)):[]}var wy=_e(function(e){return _i(Vt(e,1,_t,!0))}),by=_e(function(e){var i=Rr(e);return _t(i)&&(i=r),_i(Vt(e,1,_t,!0),ue(i,2))}),_y=_e(function(e){var i=Rr(e);return i=typeof i=="function"?i:r,_i(Vt(e,1,_t,!0),r,i)});function Ey(e){return e&&e.length?_i(e):[]}function Iy(e,i){return e&&e.length?_i(e,ue(i,2)):[]}function xy(e,i){return i=typeof i=="function"?i:r,e&&e.length?_i(e,r,i):[]}function Ga(e){if(!(e&&e.length))return[];var i=0;return e=yi(e,function(a){if(_t(a))return i=Lt(a.length,i),!0}),ha(i,function(a){return it(e,aa(a))})}function Nh(e,i){if(!(e&&e.length))return[];var a=Ga(e);return i==null?a:it(a,function(c){return Mt(i,r,c)})}var Sy=_e(function(e,i){return _t(e)?Ln(e,i):[]}),Py=_e(function(e){return Ta(yi(e,_t))}),Oy=_e(function(e){var i=Rr(e);return _t(i)&&(i=r),Ta(yi(e,_t),ue(i,2))}),Cy=_e(function(e){var i=Rr(e);return i=typeof i=="function"?i:r,Ta(yi(e,_t),r,i)}),Ay=_e(Ga);function Ry(e,i){return Qu(e||[],i||[],jn)}function Ty(e,i){return Qu(e||[],i||[],Un)}var Ny=_e(function(e){var i=e.length,a=i>1?e[i-1]:r;return a=typeof a=="function"?(e.pop(),a):r,Nh(e,a)});function $h(e){var i=d(e);return i.__chain__=!0,i}function $y(e,i){return i(e),e}function ao(e,i){return i(e)}var Fy=ni(function(e){var i=e.length,a=i?e[0]:0,c=this.__wrapped__,l=function(y){return va(y,e)};return i>1||this.__actions__.length||!(c instanceof Se)||!si(a)?this.thru(l):(c=c.slice(a,+a+(i?1:0)),c.__actions__.push({func:ao,args:[l],thisArg:r}),new Or(c,this.__chain__).thru(function(y){return i&&!y.length&&y.push(r),y}))});function Dy(){return $h(this)}function jy(){return new Or(this.value(),this.__chain__)}function Ly(){this.__values__===r&&(this.__values__=Gh(this.value()));var e=this.__index__>=this.__values__.length,i=e?r:this.__values__[this.__index__++];return{done:e,value:i}}function qy(){return this}function My(e){for(var i,a=this;a instanceof Bs;){var c=Ph(a);c.__index__=0,c.__values__=r,i?l.__wrapped__=c:i=c;var l=c;a=a.__wrapped__}return l.__wrapped__=e,i}function Uy(){var e=this.__wrapped__;if(e instanceof Se){var i=e;return this.__actions__.length&&(i=new Se(this)),i=i.reverse(),i.__actions__.push({func:ao,args:[Ba],thisArg:r}),new Or(i,this.__chain__)}return this.thru(Ba)}function zy(){return Ju(this.__wrapped__,this.__actions__)}var Hy=Xs(function(e,i,a){qe.call(e,a)?++e[a]:ri(e,a,1)});function ky(e,i,a){var c=ye(e)?cu:$d;return a&&er(e,i,a)&&(i=r),c(e,ue(i,3))}function Ky(e,i){var a=ye(e)?yi:Nu;return a(e,ue(i,3))}var Vy=oh(Oh),By=oh(Ch);function Gy(e,i){return Vt(co(e,i),1)}function Wy(e,i){return Vt(co(e,i),Re)}function Jy(e,i,a){return a=a===r?1:me(a),Vt(co(e,i),a)}function Fh(e,i){var a=ye(e)?Sr:bi;return a(e,ue(i,3))}function Dh(e,i){var a=ye(e)?dp:Tu;return a(e,ue(i,3))}var Qy=Xs(function(e,i,a){qe.call(e,a)?e[a].push(i):ri(e,a,[i])});function Yy(e,i,a,c){e=ur(e)?e:mn(e),a=a&&!c?me(a):0;var l=e.length;return a<0&&(a=Lt(l+a,0)),po(e)?a<=l&&e.indexOf(i,a)>-1:!!l&&sn(e,i,a)>-1}var Zy=_e(function(e,i,a){var c=-1,l=typeof i=="function",y=ur(e)?T(e.length):[];return bi(e,function(b){y[++c]=l?Mt(i,b,a):qn(b,i,a)}),y}),Xy=Xs(function(e,i,a){ri(e,a,i)});function co(e,i){var a=ye(e)?it:qu;return a(e,ue(i,3))}function em(e,i,a,c){return e==null?[]:(ye(i)||(i=i==null?[]:[i]),a=c?r:a,ye(a)||(a=a==null?[]:[a]),Hu(e,i,a))}var tm=Xs(function(e,i,a){e[a?0:1].push(i)},function(){return[[],[]]});function rm(e,i,a){var c=ye(e)?sa:fu,l=arguments.length<3;return c(e,ue(i,4),a,l,bi)}function im(e,i,a){var c=ye(e)?gp:fu,l=arguments.length<3;return c(e,ue(i,4),a,l,Tu)}function nm(e,i){var a=ye(e)?yi:Nu;return a(e,lo(ue(i,3)))}function sm(e){var i=ye(e)?Ou:Yd;return i(e)}function om(e,i,a){(a?er(e,i,a):i===r)?i=1:i=me(i);var c=ye(e)?Cd:Zd;return c(e,i)}function am(e){var i=ye(e)?Ad:eg;return i(e)}function cm(e){if(e==null)return 0;if(ur(e))return po(e)?an(e):e.length;var i=Wt(e);return i==ve||i==De?e.size:xa(e).length}function um(e,i,a){var c=ye(e)?oa:tg;return a&&er(e,i,a)&&(i=r),c(e,ue(i,3))}var hm=_e(function(e,i){if(e==null)return[];var a=i.length;return a>1&&er(e,i[0],i[1])?i=[]:a>2&&er(i[0],i[1],i[2])&&(i=[i[0]]),Hu(e,Vt(i,1),[])}),uo=Kp||function(){return Pe.Date.now()};function lm(e,i){if(typeof i!="function")throw new Pr(f);return e=me(e),function(){if(--e<1)return i.apply(this,arguments)}}function jh(e,i,a){return i=a?r:i,i=e&&i==null?e.length:i,ii(e,j,r,r,r,r,i)}function Lh(e,i){var a;if(typeof i!="function")throw new Pr(f);return e=me(e),function(){return--e>0&&(a=i.apply(this,arguments)),e<=1&&(i=r),a}}var Wa=_e(function(e,i,a){var c=oe;if(a.length){var l=vi(a,gn(Wa));c|=M}return ii(e,c,i,a,l)}),qh=_e(function(e,i,a){var c=oe|fe;if(a.length){var l=vi(a,gn(qh));c|=M}return ii(i,c,e,a,l)});function Mh(e,i,a){i=a?r:i;var c=ii(e,$,r,r,r,r,r,i);return c.placeholder=Mh.placeholder,c}function Uh(e,i,a){i=a?r:i;var c=ii(e,U,r,r,r,r,r,i);return c.placeholder=Uh.placeholder,c}function zh(e,i,a){var c,l,y,b,_,C,H=0,k=!1,G=!1,X=!0;if(typeof e!="function")throw new Pr(f);i=Tr(i)||0,ct(a)&&(k=!!a.leading,G="maxWait"in a,y=G?Lt(Tr(a.maxWait)||0,i):y,X="trailing"in a?!!a.trailing:X);function ne(Et){var qr=c,ci=l;return c=l=r,H=Et,b=e.apply(ci,qr),b}function he(Et){return H=Et,_=kn(Ie,i),k?ne(Et):b}function we(Et){var qr=Et-C,ci=Et-H,ol=i-qr;return G?Gt(ol,y-ci):ol}function le(Et){var qr=Et-C,ci=Et-H;return C===r||qr>=i||qr<0||G&&ci>=y}function Ie(){var Et=uo();if(le(Et))return Oe(Et);_=kn(Ie,we(Et))}function Oe(Et){return _=r,X&&c?ne(Et):(c=l=r,b)}function br(){_!==r&&Yu(_),H=0,c=C=l=_=r}function tr(){return _===r?b:Oe(uo())}function _r(){var Et=uo(),qr=le(Et);if(c=arguments,l=this,C=Et,qr){if(_===r)return he(C);if(G)return Yu(_),_=kn(Ie,i),ne(C)}return _===r&&(_=kn(Ie,i)),b}return _r.cancel=br,_r.flush=tr,_r}var fm=_e(function(e,i){return Ru(e,1,i)}),pm=_e(function(e,i,a){return Ru(e,Tr(i)||0,a)});function dm(e){return ii(e,ce)}function ho(e,i){if(typeof e!="function"||i!=null&&typeof i!="function")throw new Pr(f);var a=function(){var c=arguments,l=i?i.apply(this,c):c[0],y=a.cache;if(y.has(l))return y.get(l);var b=e.apply(this,c);return a.cache=y.set(l,b)||y,b};return a.cache=new(ho.Cache||ti),a}ho.Cache=ti;function lo(e){if(typeof e!="function")throw new Pr(f);return function(){var i=arguments;switch(i.length){case 0:return!e.call(this);case 1:return!e.call(this,i[0]);case 2:return!e.call(this,i[0],i[1]);case 3:return!e.call(this,i[0],i[1],i[2])}return!e.apply(this,i)}}function gm(e){return Lh(2,e)}var ym=rg(function(e,i){i=i.length==1&&ye(i[0])?it(i[0],mr(ue())):it(Vt(i,1),mr(ue()));var a=i.length;return _e(function(c){for(var l=-1,y=Gt(c.length,a);++l<y;)c[l]=i[l].call(this,c[l]);return Mt(e,this,c)})}),Ja=_e(function(e,i){var a=vi(i,gn(Ja));return ii(e,M,r,i,a)}),Hh=_e(function(e,i){var a=vi(i,gn(Hh));return ii(e,x,r,i,a)}),mm=ni(function(e,i){return ii(e,K,r,r,r,i)});function vm(e,i){if(typeof e!="function")throw new Pr(f);return i=i===r?i:me(i),_e(e,i)}function wm(e,i){if(typeof e!="function")throw new Pr(f);return i=i==null?0:Lt(me(i),0),_e(function(a){var c=a[i],l=Ii(a,0,i);return c&&mi(l,c),Mt(e,this,l)})}function bm(e,i,a){var c=!0,l=!0;if(typeof e!="function")throw new Pr(f);return ct(a)&&(c="leading"in a?!!a.leading:c,l="trailing"in a?!!a.trailing:l),zh(e,i,{leading:c,maxWait:i,trailing:l})}function _m(e){return jh(e,1)}function Em(e,i){return Ja($a(i),e)}function Im(){if(!arguments.length)return[];var e=arguments[0];return ye(e)?e:[e]}function xm(e){return Cr(e,q)}function Sm(e,i){return i=typeof i=="function"?i:r,Cr(e,q,i)}function Pm(e){return Cr(e,E|q)}function Om(e,i){return i=typeof i=="function"?i:r,Cr(e,E|q,i)}function Cm(e,i){return i==null||Au(e,i,Ut(i))}function Lr(e,i){return e===i||e!==e&&i!==i}var Am=io(_a),Rm=io(function(e,i){return e>=i}),ki=Du(function(){return arguments}())?Du:function(e){return mt(e)&&qe.call(e,"callee")&&!_u.call(e,"callee")},ye=T.isArray,Tm=Zt?mr(Zt):Md;function ur(e){return e!=null&&fo(e.length)&&!oi(e)}function _t(e){return mt(e)&&ur(e)}function Nm(e){return e===!0||e===!1||mt(e)&&Xt(e)==F}var xi=Bp||oc,$m=Fr?mr(Fr):Ud;function Fm(e){return mt(e)&&e.nodeType===1&&!Kn(e)}function Dm(e){if(e==null)return!0;if(ur(e)&&(ye(e)||typeof e=="string"||typeof e.splice=="function"||xi(e)||yn(e)||ki(e)))return!e.length;var i=Wt(e);if(i==ve||i==De)return!e.size;if(Hn(e))return!xa(e).length;for(var a in e)if(qe.call(e,a))return!1;return!0}function jm(e,i){return Mn(e,i)}function Lm(e,i,a){a=typeof a=="function"?a:r;var c=a?a(e,i):r;return c===r?Mn(e,i,r,a):!!c}function Qa(e){if(!mt(e))return!1;var i=Xt(e);return i==I||i==h||typeof e.message=="string"&&typeof e.name=="string"&&!Kn(e)}function qm(e){return typeof e=="number"&&Iu(e)}function oi(e){if(!ct(e))return!1;var i=Xt(e);return i==ie||i==pe||i==L||i==vt}function kh(e){return typeof e=="number"&&e==me(e)}function fo(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=ee}function ct(e){var i=typeof e;return e!=null&&(i=="object"||i=="function")}function mt(e){return e!=null&&typeof e=="object"}var Kh=xr?mr(xr):Hd;function Mm(e,i){return e===i||Ia(e,i,Ua(i))}function Um(e,i,a){return a=typeof a=="function"?a:r,Ia(e,i,Ua(i),a)}function zm(e){return Vh(e)&&e!=+e}function Hm(e){if(Sg(e))throw new de(u);return ju(e)}function km(e){return e===null}function Km(e){return e==null}function Vh(e){return typeof e=="number"||mt(e)&&Xt(e)==Te}function Kn(e){if(!mt(e)||Xt(e)!=xe)return!1;var i=Ms(e);if(i===null)return!0;var a=qe.call(i,"constructor")&&i.constructor;return typeof a=="function"&&a instanceof a&&Ds.call(a)==Up}var Ya=Kr?mr(Kr):kd;function Vm(e){return kh(e)&&e>=-ee&&e<=ee}var Bh=An?mr(An):Kd;function po(e){return typeof e=="string"||!ye(e)&&mt(e)&&Xt(e)==Je}function wr(e){return typeof e=="symbol"||mt(e)&&Xt(e)==Qe}var yn=Di?mr(Di):Vd;function Bm(e){return e===r}function Gm(e){return mt(e)&&Wt(e)==Ue}function Wm(e){return mt(e)&&Xt(e)==Ye}var Jm=io(Sa),Qm=io(function(e,i){return e<=i});function Gh(e){if(!e)return[];if(ur(e))return po(e)?Dr(e):cr(e);if(Tn&&e[Tn])return Cp(e[Tn]());var i=Wt(e),a=i==ve?fa:i==De?Ns:mn;return a(e)}function ai(e){if(!e)return e===0?e:0;if(e=Tr(e),e===Re||e===-Re){var i=e<0?-1:1;return i*Q}return e===e?e:0}function me(e){var i=ai(e),a=i%1;return i===i?a?i-a:i:0}function Wh(e){return e?Mi(me(e),0,Y):0}function Tr(e){if(typeof e=="number")return e;if(wr(e))return W;if(ct(e)){var i=typeof e.valueOf=="function"?e.valueOf():e;e=ct(i)?i+"":i}if(typeof e!="string")return e===0?e:+e;e=pu(e);var a=zo.test(e);return a||ko.test(e)?ge(e.slice(2),a?2:8):Uo.test(e)?W:+e}function Jh(e){return Br(e,hr(e))}function Ym(e){return e?Mi(me(e),-ee,ee):e===0?e:0}function je(e){return e==null?"":vr(e)}var Zm=pn(function(e,i){if(Hn(i)||ur(i)){Br(i,Ut(i),e);return}for(var a in i)qe.call(i,a)&&jn(e,a,i[a])}),Qh=pn(function(e,i){Br(i,hr(i),e)}),go=pn(function(e,i,a,c){Br(i,hr(i),e,c)}),Xm=pn(function(e,i,a,c){Br(i,Ut(i),e,c)}),e0=ni(va);function t0(e,i){var a=fn(e);return i==null?a:Cu(a,i)}var r0=_e(function(e,i){e=Ge(e);var a=-1,c=i.length,l=c>2?i[2]:r;for(l&&er(i[0],i[1],l)&&(c=1);++a<c;)for(var y=i[a],b=hr(y),_=-1,C=b.length;++_<C;){var H=b[_],k=e[H];(k===r||Lr(k,un[H])&&!qe.call(e,H))&&(e[H]=y[H])}return e}),i0=_e(function(e){return e.push(r,ph),Mt(Yh,r,e)});function n0(e,i){return uu(e,ue(i,3),Vr)}function s0(e,i){return uu(e,ue(i,3),ba)}function o0(e,i){return e==null?e:wa(e,ue(i,3),hr)}function a0(e,i){return e==null?e:$u(e,ue(i,3),hr)}function c0(e,i){return e&&Vr(e,ue(i,3))}function u0(e,i){return e&&ba(e,ue(i,3))}function h0(e){return e==null?[]:Js(e,Ut(e))}function l0(e){return e==null?[]:Js(e,hr(e))}function Za(e,i,a){var c=e==null?r:Ui(e,i);return c===r?a:c}function f0(e,i){return e!=null&&yh(e,i,Dd)}function Xa(e,i){return e!=null&&yh(e,i,jd)}var p0=ch(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=js.call(i)),e[i]=a},tc(lr)),d0=ch(function(e,i,a){i!=null&&typeof i.toString!="function"&&(i=js.call(i)),qe.call(e,i)?e[i].push(a):e[i]=[a]},ue),g0=_e(qn);function Ut(e){return ur(e)?Pu(e):xa(e)}function hr(e){return ur(e)?Pu(e,!0):Bd(e)}function y0(e,i){var a={};return i=ue(i,3),Vr(e,function(c,l,y){ri(a,i(c,l,y),c)}),a}function m0(e,i){var a={};return i=ue(i,3),Vr(e,function(c,l,y){ri(a,l,i(c,l,y))}),a}var v0=pn(function(e,i,a){Qs(e,i,a)}),Yh=pn(function(e,i,a,c){Qs(e,i,a,c)}),w0=ni(function(e,i){var a={};if(e==null)return a;var c=!1;i=it(i,function(y){return y=Ei(y,e),c||(c=y.length>1),y}),Br(e,qa(e),a),c&&(a=Cr(a,E|O|q,pg));for(var l=i.length;l--;)Ra(a,i[l]);return a});function b0(e,i){return Zh(e,lo(ue(i)))}var _0=ni(function(e,i){return e==null?{}:Wd(e,i)});function Zh(e,i){if(e==null)return{};var a=it(qa(e),function(c){return[c]});return i=ue(i),ku(e,a,function(c,l){return i(c,l[0])})}function E0(e,i,a){i=Ei(i,e);var c=-1,l=i.length;for(l||(l=1,e=r);++c<l;){var y=e==null?r:e[Gr(i[c])];y===r&&(c=l,y=a),e=oi(y)?y.call(e):y}return e}function I0(e,i,a){return e==null?e:Un(e,i,a)}function x0(e,i,a,c){return c=typeof c=="function"?c:r,e==null?e:Un(e,i,a,c)}var Xh=lh(Ut),el=lh(hr);function S0(e,i,a){var c=ye(e),l=c||xi(e)||yn(e);if(i=ue(i,4),a==null){var y=e&&e.constructor;l?a=c?new y:[]:ct(e)?a=oi(y)?fn(Ms(e)):{}:a={}}return(l?Sr:Vr)(e,function(b,_,C){return i(a,b,_,C)}),a}function P0(e,i){return e==null?!0:Ra(e,i)}function O0(e,i,a){return e==null?e:Wu(e,i,$a(a))}function C0(e,i,a,c){return c=typeof c=="function"?c:r,e==null?e:Wu(e,i,$a(a),c)}function mn(e){return e==null?[]:la(e,Ut(e))}function A0(e){return e==null?[]:la(e,hr(e))}function R0(e,i,a){return a===r&&(a=i,i=r),a!==r&&(a=Tr(a),a=a===a?a:0),i!==r&&(i=Tr(i),i=i===i?i:0),Mi(Tr(e),i,a)}function T0(e,i,a){return i=ai(i),a===r?(a=i,i=0):a=ai(a),e=Tr(e),Ld(e,i,a)}function N0(e,i,a){if(a&&typeof a!="boolean"&&er(e,i,a)&&(i=a=r),a===r&&(typeof i=="boolean"?(a=i,i=r):typeof e=="boolean"&&(a=e,e=r)),e===r&&i===r?(e=0,i=1):(e=ai(e),i===r?(i=e,e=0):i=ai(i)),e>i){var c=e;e=i,i=c}if(a||e%1||i%1){var l=xu();return Gt(e+l*(i-e+Ve("1e-"+((l+"").length-1))),i)}return Oa(e,i)}var $0=dn(function(e,i,a){return i=i.toLowerCase(),e+(a?tl(i):i)});function tl(e){return ec(je(e).toLowerCase())}function rl(e){return e=je(e),e&&e.replace(Zr,Ip).replace(ra,"")}function F0(e,i,a){e=je(e),i=vr(i);var c=e.length;a=a===r?c:Mi(me(a),0,c);var l=a;return a-=i.length,a>=0&&e.slice(a,l)==i}function D0(e){return e=je(e),e&&tt.test(e)?e.replace(Ri,xp):e}function j0(e){return e=je(e),e&&At.test(e)?e.replace(dt,"\\$&"):e}var L0=dn(function(e,i,a){return e+(a?"-":"")+i.toLowerCase()}),q0=dn(function(e,i,a){return e+(a?" ":"")+i.toLowerCase()}),M0=sh("toLowerCase");function U0(e,i,a){e=je(e),i=me(i);var c=i?an(e):0;if(!i||c>=i)return e;var l=(i-c)/2;return ro(ks(l),a)+e+ro(Hs(l),a)}function z0(e,i,a){e=je(e),i=me(i);var c=i?an(e):0;return i&&c<i?e+ro(i-c,a):e}function H0(e,i,a){e=je(e),i=me(i);var c=i?an(e):0;return i&&c<i?ro(i-c,a)+e:e}function k0(e,i,a){return a||i==null?i=0:i&&(i=+i),Qp(je(e).replace(gt,""),i||0)}function K0(e,i,a){return(a?er(e,i,a):i===r)?i=1:i=me(i),Ca(je(e),i)}function V0(){var e=arguments,i=je(e[0]);return e.length<3?i:i.replace(e[1],e[2])}var B0=dn(function(e,i,a){return e+(a?"_":"")+i.toLowerCase()});function G0(e,i,a){return a&&typeof a!="number"&&er(e,i,a)&&(i=a=r),a=a===r?Y:a>>>0,a?(e=je(e),e&&(typeof i=="string"||i!=null&&!Ya(i))&&(i=vr(i),!i&&on(e))?Ii(Dr(e),0,a):e.split(i,a)):[]}var W0=dn(function(e,i,a){return e+(a?" ":"")+ec(i)});function J0(e,i,a){return e=je(e),a=a==null?0:Mi(me(a),0,e.length),i=vr(i),e.slice(a,a+i.length)==i}function Q0(e,i,a){var c=d.templateSettings;a&&er(e,i,a)&&(i=r),e=je(e),i=go({},i,c,fh);var l=go({},i.imports,c.imports,fh),y=Ut(l),b=la(l,y),_,C,H=0,k=i.interpolate||Yi,G="__p += '",X=pa((i.escape||Yi).source+"|"+k.source+"|"+(k===at?Mo:Yi).source+"|"+(i.evaluate||Yi).source+"|$","g"),ne="//# sourceURL="+(qe.call(i,"sourceURL")?(i.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++ia+"]")+`
`;e.replace(X,function(le,Ie,Oe,br,tr,_r){return Oe||(Oe=br),G+=e.slice(H,_r).replace(Vo,Sp),Ie&&(_=!0,G+=`' +
__e(`+Ie+`) +
'`),tr&&(C=!0,G+=`';
`+tr+`;
__p += '`),Oe&&(G+=`' +
((__t = (`+Oe+`)) == null ? '' : __t) +
'`),H=_r+le.length,le}),G+=`';
`;var he=qe.call(i,"variable")&&i.variable;if(!he)G=`with (obj) {
`+G+`
}
`;else if(Lo.test(he))throw new de(g);G=(C?G.replace(Hr,""):G).replace(Yt,"$1").replace(Yr,"$1;"),G="function("+(he||"obj")+`) {
`+(he?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(_?", __e = _.escape":"")+(C?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+G+`return __p
}`;var we=nl(function(){return Fe(y,ne+"return "+G).apply(r,b)});if(we.source=G,Qa(we))throw we;return we}function Y0(e){return je(e).toLowerCase()}function Z0(e){return je(e).toUpperCase()}function X0(e,i,a){if(e=je(e),e&&(a||i===r))return pu(e);if(!e||!(i=vr(i)))return e;var c=Dr(e),l=Dr(i),y=du(c,l),b=gu(c,l)+1;return Ii(c,y,b).join("")}function ev(e,i,a){if(e=je(e),e&&(a||i===r))return e.slice(0,mu(e)+1);if(!e||!(i=vr(i)))return e;var c=Dr(e),l=gu(c,Dr(i))+1;return Ii(c,0,l).join("")}function tv(e,i,a){if(e=je(e),e&&(a||i===r))return e.replace(gt,"");if(!e||!(i=vr(i)))return e;var c=Dr(e),l=du(c,Dr(i));return Ii(c,l).join("")}function rv(e,i){var a=ae,c=Ee;if(ct(i)){var l="separator"in i?i.separator:l;a="length"in i?me(i.length):a,c="omission"in i?vr(i.omission):c}e=je(e);var y=e.length;if(on(e)){var b=Dr(e);y=b.length}if(a>=y)return e;var _=a-an(c);if(_<1)return c;var C=b?Ii(b,0,_).join(""):e.slice(0,_);if(l===r)return C+c;if(b&&(_+=C.length-_),Ya(l)){if(e.slice(_).search(l)){var H,k=C;for(l.global||(l=pa(l.source,je(Ir.exec(l))+"g")),l.lastIndex=0;H=l.exec(k);)var G=H.index;C=C.slice(0,G===r?_:G)}}else if(e.indexOf(vr(l),_)!=_){var X=C.lastIndexOf(l);X>-1&&(C=C.slice(0,X))}return C+c}function iv(e){return e=je(e),e&&lt.test(e)?e.replace(di,Np):e}var nv=dn(function(e,i,a){return e+(a?" ":"")+i.toUpperCase()}),ec=sh("toUpperCase");function il(e,i,a){return e=je(e),i=a?r:i,i===r?Op(e)?Dp(e):vp(e):e.match(i)||[]}var nl=_e(function(e,i){try{return Mt(e,r,i)}catch(a){return Qa(a)?a:new de(a)}}),sv=ni(function(e,i){return Sr(i,function(a){a=Gr(a),ri(e,a,Wa(e[a],e))}),e});function ov(e){var i=e==null?0:e.length,a=ue();return e=i?it(e,function(c){if(typeof c[1]!="function")throw new Pr(f);return[a(c[0]),c[1]]}):[],_e(function(c){for(var l=-1;++l<i;){var y=e[l];if(Mt(y[0],this,c))return Mt(y[1],this,c)}})}function av(e){return Nd(Cr(e,E))}function tc(e){return function(){return e}}function cv(e,i){return e==null||e!==e?i:e}var uv=ah(),hv=ah(!0);function lr(e){return e}function rc(e){return Lu(typeof e=="function"?e:Cr(e,E))}function lv(e){return Mu(Cr(e,E))}function fv(e,i){return Uu(e,Cr(i,E))}var pv=_e(function(e,i){return function(a){return qn(a,e,i)}}),dv=_e(function(e,i){return function(a){return qn(e,a,i)}});function ic(e,i,a){var c=Ut(i),l=Js(i,c);a==null&&!(ct(i)&&(l.length||!c.length))&&(a=i,i=e,e=this,l=Js(i,Ut(i)));var y=!(ct(a)&&"chain"in a)||!!a.chain,b=oi(e);return Sr(l,function(_){var C=i[_];e[_]=C,b&&(e.prototype[_]=function(){var H=this.__chain__;if(y||H){var k=e(this.__wrapped__),G=k.__actions__=cr(this.__actions__);return G.push({func:C,args:arguments,thisArg:e}),k.__chain__=H,k}return C.apply(e,mi([this.value()],arguments))})}),e}function gv(){return Pe._===this&&(Pe._=zp),this}function nc(){}function yv(e){return e=me(e),_e(function(i){return zu(i,e)})}var mv=Da(it),vv=Da(cu),wv=Da(oa);function sl(e){return Ha(e)?aa(Gr(e)):Jd(e)}function bv(e){return function(i){return e==null?r:Ui(e,i)}}var _v=uh(),Ev=uh(!0);function sc(){return[]}function oc(){return!1}function Iv(){return{}}function xv(){return""}function Sv(){return!0}function Pv(e,i){if(e=me(e),e<1||e>ee)return[];var a=Y,c=Gt(e,Y);i=ue(i),e-=Y;for(var l=ha(c,i);++a<e;)i(a);return l}function Ov(e){return ye(e)?it(e,Gr):wr(e)?[e]:cr(Sh(je(e)))}function Cv(e){var i=++Mp;return je(e)+i}var Av=to(function(e,i){return e+i},0),Rv=ja("ceil"),Tv=to(function(e,i){return e/i},1),Nv=ja("floor");function $v(e){return e&&e.length?Ws(e,lr,_a):r}function Fv(e,i){return e&&e.length?Ws(e,ue(i,2),_a):r}function Dv(e){return lu(e,lr)}function jv(e,i){return lu(e,ue(i,2))}function Lv(e){return e&&e.length?Ws(e,lr,Sa):r}function qv(e,i){return e&&e.length?Ws(e,ue(i,2),Sa):r}var Mv=to(function(e,i){return e*i},1),Uv=ja("round"),zv=to(function(e,i){return e-i},0);function Hv(e){return e&&e.length?ua(e,lr):0}function kv(e,i){return e&&e.length?ua(e,ue(i,2)):0}return d.after=lm,d.ary=jh,d.assign=Zm,d.assignIn=Qh,d.assignInWith=go,d.assignWith=Xm,d.at=e0,d.before=Lh,d.bind=Wa,d.bindAll=sv,d.bindKey=qh,d.castArray=Im,d.chain=$h,d.chunk=Ng,d.compact=$g,d.concat=Fg,d.cond=ov,d.conforms=av,d.constant=tc,d.countBy=Hy,d.create=t0,d.curry=Mh,d.curryRight=Uh,d.debounce=zh,d.defaults=r0,d.defaultsDeep=i0,d.defer=fm,d.delay=pm,d.difference=Dg,d.differenceBy=jg,d.differenceWith=Lg,d.drop=qg,d.dropRight=Mg,d.dropRightWhile=Ug,d.dropWhile=zg,d.fill=Hg,d.filter=Ky,d.flatMap=Gy,d.flatMapDeep=Wy,d.flatMapDepth=Jy,d.flatten=Ah,d.flattenDeep=kg,d.flattenDepth=Kg,d.flip=dm,d.flow=uv,d.flowRight=hv,d.fromPairs=Vg,d.functions=h0,d.functionsIn=l0,d.groupBy=Qy,d.initial=Gg,d.intersection=Wg,d.intersectionBy=Jg,d.intersectionWith=Qg,d.invert=p0,d.invertBy=d0,d.invokeMap=Zy,d.iteratee=rc,d.keyBy=Xy,d.keys=Ut,d.keysIn=hr,d.map=co,d.mapKeys=y0,d.mapValues=m0,d.matches=lv,d.matchesProperty=fv,d.memoize=ho,d.merge=v0,d.mergeWith=Yh,d.method=pv,d.methodOf=dv,d.mixin=ic,d.negate=lo,d.nthArg=yv,d.omit=w0,d.omitBy=b0,d.once=gm,d.orderBy=em,d.over=mv,d.overArgs=ym,d.overEvery=vv,d.overSome=wv,d.partial=Ja,d.partialRight=Hh,d.partition=tm,d.pick=_0,d.pickBy=Zh,d.property=sl,d.propertyOf=bv,d.pull=ey,d.pullAll=Th,d.pullAllBy=ty,d.pullAllWith=ry,d.pullAt=iy,d.range=_v,d.rangeRight=Ev,d.rearg=mm,d.reject=nm,d.remove=ny,d.rest=vm,d.reverse=Ba,d.sampleSize=om,d.set=I0,d.setWith=x0,d.shuffle=am,d.slice=sy,d.sortBy=hm,d.sortedUniq=fy,d.sortedUniqBy=py,d.split=G0,d.spread=wm,d.tail=dy,d.take=gy,d.takeRight=yy,d.takeRightWhile=my,d.takeWhile=vy,d.tap=$y,d.throttle=bm,d.thru=ao,d.toArray=Gh,d.toPairs=Xh,d.toPairsIn=el,d.toPath=Ov,d.toPlainObject=Jh,d.transform=S0,d.unary=_m,d.union=wy,d.unionBy=by,d.unionWith=_y,d.uniq=Ey,d.uniqBy=Iy,d.uniqWith=xy,d.unset=P0,d.unzip=Ga,d.unzipWith=Nh,d.update=O0,d.updateWith=C0,d.values=mn,d.valuesIn=A0,d.without=Sy,d.words=il,d.wrap=Em,d.xor=Py,d.xorBy=Oy,d.xorWith=Cy,d.zip=Ay,d.zipObject=Ry,d.zipObjectDeep=Ty,d.zipWith=Ny,d.entries=Xh,d.entriesIn=el,d.extend=Qh,d.extendWith=go,ic(d,d),d.add=Av,d.attempt=nl,d.camelCase=$0,d.capitalize=tl,d.ceil=Rv,d.clamp=R0,d.clone=xm,d.cloneDeep=Pm,d.cloneDeepWith=Om,d.cloneWith=Sm,d.conformsTo=Cm,d.deburr=rl,d.defaultTo=cv,d.divide=Tv,d.endsWith=F0,d.eq=Lr,d.escape=D0,d.escapeRegExp=j0,d.every=ky,d.find=Vy,d.findIndex=Oh,d.findKey=n0,d.findLast=By,d.findLastIndex=Ch,d.findLastKey=s0,d.floor=Nv,d.forEach=Fh,d.forEachRight=Dh,d.forIn=o0,d.forInRight=a0,d.forOwn=c0,d.forOwnRight=u0,d.get=Za,d.gt=Am,d.gte=Rm,d.has=f0,d.hasIn=Xa,d.head=Rh,d.identity=lr,d.includes=Yy,d.indexOf=Bg,d.inRange=T0,d.invoke=g0,d.isArguments=ki,d.isArray=ye,d.isArrayBuffer=Tm,d.isArrayLike=ur,d.isArrayLikeObject=_t,d.isBoolean=Nm,d.isBuffer=xi,d.isDate=$m,d.isElement=Fm,d.isEmpty=Dm,d.isEqual=jm,d.isEqualWith=Lm,d.isError=Qa,d.isFinite=qm,d.isFunction=oi,d.isInteger=kh,d.isLength=fo,d.isMap=Kh,d.isMatch=Mm,d.isMatchWith=Um,d.isNaN=zm,d.isNative=Hm,d.isNil=Km,d.isNull=km,d.isNumber=Vh,d.isObject=ct,d.isObjectLike=mt,d.isPlainObject=Kn,d.isRegExp=Ya,d.isSafeInteger=Vm,d.isSet=Bh,d.isString=po,d.isSymbol=wr,d.isTypedArray=yn,d.isUndefined=Bm,d.isWeakMap=Gm,d.isWeakSet=Wm,d.join=Yg,d.kebabCase=L0,d.last=Rr,d.lastIndexOf=Zg,d.lowerCase=q0,d.lowerFirst=M0,d.lt=Jm,d.lte=Qm,d.max=$v,d.maxBy=Fv,d.mean=Dv,d.meanBy=jv,d.min=Lv,d.minBy=qv,d.stubArray=sc,d.stubFalse=oc,d.stubObject=Iv,d.stubString=xv,d.stubTrue=Sv,d.multiply=Mv,d.nth=Xg,d.noConflict=gv,d.noop=nc,d.now=uo,d.pad=U0,d.padEnd=z0,d.padStart=H0,d.parseInt=k0,d.random=N0,d.reduce=rm,d.reduceRight=im,d.repeat=K0,d.replace=V0,d.result=E0,d.round=Uv,d.runInContext=P,d.sample=sm,d.size=cm,d.snakeCase=B0,d.some=um,d.sortedIndex=oy,d.sortedIndexBy=ay,d.sortedIndexOf=cy,d.sortedLastIndex=uy,d.sortedLastIndexBy=hy,d.sortedLastIndexOf=ly,d.startCase=W0,d.startsWith=J0,d.subtract=zv,d.sum=Hv,d.sumBy=kv,d.template=Q0,d.times=Pv,d.toFinite=ai,d.toInteger=me,d.toLength=Wh,d.toLower=Y0,d.toNumber=Tr,d.toSafeInteger=Ym,d.toString=je,d.toUpper=Z0,d.trim=X0,d.trimEnd=ev,d.trimStart=tv,d.truncate=rv,d.unescape=iv,d.uniqueId=Cv,d.upperCase=nv,d.upperFirst=ec,d.each=Fh,d.eachRight=Dh,d.first=Rh,ic(d,function(){var e={};return Vr(d,function(i,a){qe.call(d.prototype,a)||(e[a]=i)}),e}(),{chain:!1}),d.VERSION=n,Sr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(e){d[e].placeholder=d}),Sr(["drop","take"],function(e,i){Se.prototype[e]=function(a){a=a===r?1:Lt(me(a),0);var c=this.__filtered__&&!i?new Se(this):this.clone();return c.__filtered__?c.__takeCount__=Gt(a,c.__takeCount__):c.__views__.push({size:Gt(a,Y),type:e+(c.__dir__<0?"Right":"")}),c},Se.prototype[e+"Right"]=function(a){return this.reverse()[e](a).reverse()}}),Sr(["filter","map","takeWhile"],function(e,i){var a=i+1,c=a==N||a==Me;Se.prototype[e]=function(l){var y=this.clone();return y.__iteratees__.push({iteratee:ue(l,3),type:a}),y.__filtered__=y.__filtered__||c,y}}),Sr(["head","last"],function(e,i){var a="take"+(i?"Right":"");Se.prototype[e]=function(){return this[a](1).value()[0]}}),Sr(["initial","tail"],function(e,i){var a="drop"+(i?"":"Right");Se.prototype[e]=function(){return this.__filtered__?new Se(this):this[a](1)}}),Se.prototype.compact=function(){return this.filter(lr)},Se.prototype.find=function(e){return this.filter(e).head()},Se.prototype.findLast=function(e){return this.reverse().find(e)},Se.prototype.invokeMap=_e(function(e,i){return typeof e=="function"?new Se(this):this.map(function(a){return qn(a,e,i)})}),Se.prototype.reject=function(e){return this.filter(lo(ue(e)))},Se.prototype.slice=function(e,i){e=me(e);var a=this;return a.__filtered__&&(e>0||i<0)?new Se(a):(e<0?a=a.takeRight(-e):e&&(a=a.drop(e)),i!==r&&(i=me(i),a=i<0?a.dropRight(-i):a.take(i-e)),a)},Se.prototype.takeRightWhile=function(e){return this.reverse().takeWhile(e).reverse()},Se.prototype.toArray=function(){return this.take(Y)},Vr(Se.prototype,function(e,i){var a=/^(?:filter|find|map|reject)|While$/.test(i),c=/^(?:head|last)$/.test(i),l=d[c?"take"+(i=="last"?"Right":""):i],y=c||/^find/.test(i);l&&(d.prototype[i]=function(){var b=this.__wrapped__,_=c?[1]:arguments,C=b instanceof Se,H=_[0],k=C||ye(b),G=function(Ie){var Oe=l.apply(d,mi([Ie],_));return c&&X?Oe[0]:Oe};k&&a&&typeof H=="function"&&H.length!=1&&(C=k=!1);var X=this.__chain__,ne=!!this.__actions__.length,he=y&&!X,we=C&&!ne;if(!y&&k){b=we?b:new Se(this);var le=e.apply(b,_);return le.__actions__.push({func:ao,args:[G],thisArg:r}),new Or(le,X)}return he&&we?e.apply(this,_):(le=this.thru(G),he?c?le.value()[0]:le.value():le)})}),Sr(["pop","push","shift","sort","splice","unshift"],function(e){var i=$s[e],a=/^(?:push|sort|unshift)$/.test(e)?"tap":"thru",c=/^(?:pop|shift)$/.test(e);d.prototype[e]=function(){var l=arguments;if(c&&!this.__chain__){var y=this.value();return i.apply(ye(y)?y:[],l)}return this[a](function(b){return i.apply(ye(b)?b:[],l)})}}),Vr(Se.prototype,function(e,i){var a=d[i];if(a){var c=a.name+"";qe.call(ln,c)||(ln[c]=[]),ln[c].push({name:i,func:a})}}),ln[eo(r,fe).name]=[{name:"wrapper",func:r}],Se.prototype.clone=id,Se.prototype.reverse=nd,Se.prototype.value=sd,d.prototype.at=Fy,d.prototype.chain=Dy,d.prototype.commit=jy,d.prototype.next=Ly,d.prototype.plant=My,d.prototype.reverse=Uy,d.prototype.toJSON=d.prototype.valueOf=d.prototype.value=zy,d.prototype.first=d.prototype.head,Tn&&(d.prototype[Tn]=qy),d},cn=jp();bt?((bt.exports=cn)._=cn,Be._=cn):Pe._=cn}).call(Yn)})(Uc,Uc.exports);var Ax=Object.defineProperty,Rx=Object.defineProperties,Tx=Object.getOwnPropertyDescriptors,hf=Object.getOwnPropertySymbols,Nx=Object.prototype.hasOwnProperty,$x=Object.prototype.propertyIsEnumerable,lf=(s,t,r)=>t in s?Ax(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,_o=(s,t)=>{for(var r in t||(t={}))Nx.call(t,r)&&lf(s,r,t[r]);if(hf)for(var r of hf(t))$x.call(t,r)&&lf(s,r,t[r]);return s},Fx=(s,t)=>Rx(s,Tx(t));function Ci(s,t,r){var n;const o=w1(s);return((n=t.rpcMap)==null?void 0:n[o.reference])||`${Cx}?chainId=${o.namespace}:${o.reference}&projectId=${r}`}function Qi(s){return s.includes(":")?s.split(":")[1]:s}function lp(s){return s.map(t=>`${t.split(":")[0]}:${t.split(":")[1]}`)}function Dx(s,t){const r=Object.keys(t.namespaces).filter(o=>o.includes(s));if(!r.length)return[];const n=[];return r.forEach(o=>{const u=t.namespaces[o].accounts;n.push(...u)}),n}function jx(s={},t={}){const r=ff(s),n=ff(t);return Uc.exports.merge(r,n)}function ff(s){var t,r,n,o;const u={};if(!_n(s))return u;for(const[f,g]of Object.entries(s)){const v=eu(f)?[f]:g.chains,p=g.methods||[],w=g.events||[],E=g.rpcMap||{},O=Zn(f);u[O]=Fx(_o(_o({},u[O]),g),{chains:cc(v,(t=u[O])==null?void 0:t.chains),methods:cc(p,(r=u[O])==null?void 0:r.methods),events:cc(w,(n=u[O])==null?void 0:n.events),rpcMap:_o(_o({},E),(o=u[O])==null?void 0:o.rpcMap)})}return u}function Lx(s){return s.includes(":")?s.split(":")[2]:s}function qx(s){const t={};for(const[r,n]of Object.entries(s)){const o=n.methods||[],u=n.events||[],f=n.accounts||[],g=eu(r)?[r]:n.chains?n.chains:lp(n.accounts);t[r]={chains:g,methods:o,events:u,accounts:f}}return t}function _c(s){return typeof s=="number"?s:s.includes("0x")?parseInt(s,16):s.includes(":")?Number(s.split(":")[1]):Number(s)}const fp={},nt=s=>fp[s],Ec=(s,t)=>{fp[s]=t};class Mx{constructor(t){this.name="polkadot",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Qi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new fi(new Ai(n,nt("disableProviderPing")))}}class Ux{constructor(t){this.name="eip155",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(t){switch(t.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(t);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(t.request.method)?await this.client.request(t):this.getHttpProvider().request(t.request)}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(parseInt(t),r),this.chainId=parseInt(t),this.events.emit(pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}createHttpProvider(t,r){const n=r||Ci(`${this.name}:${t}`,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new fi(new Ai(n,nt("disableProviderPing")))}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=parseInt(Qi(r));t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}getHttpProvider(){const t=this.chainId,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}async handleSwitchChain(t){var r,n;let o=t.request.params?(r=t.request.params[0])==null?void 0:r.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const u=parseInt(o,16);if(this.isChainApproved(u))this.setDefaultChain(`${u}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:t.topic,request:{method:t.request.method,params:[{chainId:o}]},chainId:(n=this.namespace.chains)==null?void 0:n[0]}),this.setDefaultChain(`${u}`);else throw new Error(`Failed to switch to chain 'eip155:${u}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(t){return this.namespace.chains.includes(`${this.name}:${t}`)}}class zx{constructor(t){this.name="solana",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Qi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new fi(new Ai(n,nt("disableProviderPing")))}}class Hx{constructor(t){this.name="cosmos",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Qi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new fi(new Ai(n,nt("disableProviderPing")))}}class kx{constructor(t){this.name="cip34",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{const n=this.getCardanoRPCUrl(r),o=Qi(r);t[o]=this.createHttpProvider(o,n)}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}getCardanoRPCUrl(t){const r=this.namespace.rpcMap;if(r)return r[t]}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||this.getCardanoRPCUrl(t);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new fi(new Ai(n,nt("disableProviderPing")))}}class Kx{constructor(t){this.name="elrond",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Qi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new fi(new Ai(n,nt("disableProviderPing")))}}class Vx{constructor(t){this.name="multiversx",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){this.httpProviders[t]||this.setHttpProvider(t,r),this.chainId=t,this.events.emit(pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${t}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}getAccounts(){const t=this.namespace.accounts;return t?[...new Set(t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2]))]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;const o=Qi(r);t[o]=this.createHttpProvider(o,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace,this.client.core.projectId);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);return new fi(new Ai(n,nt("disableProviderPing")))}}class Bx{constructor(t){this.name="near",this.namespace=t.namespace,this.events=nt("events"),this.client=nt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(t){this.namespace=Object.assign(this.namespace,t)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const t=this.namespace.chains[0];if(!t)throw new Error("ChainId not found");return t.split(":")[1]}request(t){return this.namespace.methods.includes(t.request.method)?this.client.request(t):this.getHttpProvider().request(t.request)}setDefaultChain(t,r){if(this.chainId=t,!this.httpProviders[t]){const n=r||Ci(`${this.name}:${t}`,this.namespace);if(!n)throw new Error(`No RPC url provided for chainId: ${t}`);this.setHttpProvider(t,n)}this.events.emit(pi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const t=this.namespace.accounts;return t?t.filter(r=>r.split(":")[1]===this.chainId.toString()).map(r=>r.split(":")[2])||[]:[]}createHttpProviders(){const t={};return this.namespace.chains.forEach(r=>{var n;t[r]=this.createHttpProvider(r,(n=this.namespace.rpcMap)==null?void 0:n[r])}),t}getHttpProvider(){const t=`${this.name}:${this.chainId}`,r=this.httpProviders[t];if(typeof r>"u")throw new Error(`JSON-RPC provider for ${t} not found`);return r}setHttpProvider(t,r){const n=this.createHttpProvider(t,r);n&&(this.httpProviders[t]=n)}createHttpProvider(t,r){const n=r||Ci(t,this.namespace);return typeof n>"u"?void 0:new fi(new Ai(n,nt("disableProviderPing")))}}var Gx=Object.defineProperty,Wx=Object.defineProperties,Jx=Object.getOwnPropertyDescriptors,pf=Object.getOwnPropertySymbols,Qx=Object.prototype.hasOwnProperty,Yx=Object.prototype.propertyIsEnumerable,df=(s,t,r)=>t in s?Gx(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,Eo=(s,t)=>{for(var r in t||(t={}))Qx.call(t,r)&&df(s,r,t[r]);if(pf)for(var r of pf(t))Yx.call(t,r)&&df(s,r,t[r]);return s},Ic=(s,t)=>Wx(s,Jx(t));class ou{constructor(t){this.events=new Vc,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=t,this.logger=typeof(t==null?void 0:t.logger)<"u"&&typeof(t==null?void 0:t.logger)!="string"?t.logger:Ce.pino(Ce.getDefaultLoggerOptions({level:(t==null?void 0:t.logger)||cf})),this.disableProviderPing=(t==null?void 0:t.disableProviderPing)||!1}static async init(t){const r=new ou(t);return await r.initialize(),r}async request(t,r){const[n,o]=this.validateChain(r);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(n).request({request:Eo({},t),chainId:`${n}:${o}`,topic:this.session.topic})}sendAsync(t,r,n){this.request(t,n).then(o=>r(null,o)).catch(o=>r(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var t;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(t=this.session)==null?void 0:t.topic,reason:It("USER_DISCONNECTED")}),await this.cleanup()}async connect(t){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(t),await this.cleanupPendingPairings(),!t.skipPairing)return await this.pair(t.pairingTopic)}on(t,r){this.events.on(t,r)}once(t,r){this.events.once(t,r)}removeListener(t,r){this.events.removeListener(t,r)}off(t,r){this.events.off(t,r)}get isWalletConnect(){return!0}async pair(t){this.shouldAbortPairingAttempt=!1;let r=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(r>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:n,approval:o}=await this.client.connect({pairingTopic:t,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});n&&(this.uri=n,this.events.emit("display_uri",n)),await o().then(u=>{this.session=u,this.namespaces||(this.namespaces=qx(u.namespaces),this.persist("namespaces",this.namespaces))}).catch(u=>{if(u.message!==up)throw u;r++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(t,r){try{if(!this.session)return;const[n,o]=this.validateChain(t);this.getProvider(n).setDefaultChain(o,r)}catch(n){if(!/Please call connect/.test(n.message))throw n}}async cleanupPendingPairings(t={}){this.logger.info("Cleaning up inactive pairings...");const r=this.client.pairing.getAll();if(Jr(r)){for(const n of r)t.deletePairings?this.client.core.expirer.set(n.topic,0):await this.client.core.relayer.subscriber.unsubscribe(n.topic);this.logger.info(`Inactive pairings cleared: ${r.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const t=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[t]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await xx.init({logger:this.providerOpts.logger||cf,relayUrl:this.providerOpts.relayUrl||Sx,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const t=[...new Set(Object.keys(this.session.namespaces).map(r=>Zn(r)))];Ec("client",this.client),Ec("events",this.events),Ec("disableProviderPing",this.disableProviderPing),t.forEach(r=>{if(!this.session)return;const n=Dx(r,this.session),o=lp(n),u=jx(this.namespaces,this.optionalNamespaces),f=Ic(Eo({},u[r]),{accounts:n,chains:o});switch(r){case"eip155":this.rpcProviders[r]=new Ux({namespace:f});break;case"solana":this.rpcProviders[r]=new zx({namespace:f});break;case"cosmos":this.rpcProviders[r]=new Hx({namespace:f});break;case"polkadot":this.rpcProviders[r]=new Mx({namespace:f});break;case"cip34":this.rpcProviders[r]=new kx({namespace:f});break;case"elrond":this.rpcProviders[r]=new Kx({namespace:f});break;case"multiversx":this.rpcProviders[r]=new Vx({namespace:f});break;case"near":this.rpcProviders[r]=new Bx({namespace:f});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",t=>{this.events.emit("session_ping",t)}),this.client.on("session_event",t=>{const{params:r}=t,{event:n}=r;if(n.name==="accountsChanged"){const o=n.data;o&&Jr(o)&&this.events.emit("accountsChanged",o.map(Lx))}else if(n.name==="chainChanged"){const o=r.chainId,u=r.event.data,f=Zn(o),g=_c(o)!==_c(u)?`${f}:${_c(u)}`:o;this.onChainChanged(g)}else this.events.emit(n.name,n.data);this.events.emit("session_event",t)}),this.client.on("session_update",({topic:t,params:r})=>{var n;const{namespaces:o}=r,u=(n=this.client)==null?void 0:n.session.get(t);this.session=Ic(Eo({},u),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:t,params:r})}),this.client.on("session_delete",async t=>{await this.cleanup(),this.events.emit("session_delete",t),this.events.emit("disconnect",Ic(Eo({},It("USER_DISCONNECTED")),{data:t.topic}))}),this.on(pi.DEFAULT_CHAIN_CHANGED,t=>{this.onChainChanged(t,!0)})}getProvider(t){if(!this.rpcProviders[t])throw new Error(`Provider not found: ${t}`);return this.rpcProviders[t]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(t=>{var r;this.getProvider(t).updateNamespace((r=this.session)==null?void 0:r.namespaces[t])})}setNamespaces(t){const{namespaces:r,optionalNamespaces:n,sessionProperties:o}=t;r&&Object.keys(r).length&&(this.namespaces=r),n&&Object.keys(n).length&&(this.optionalNamespaces=n),this.sessionProperties=o,this.persist("namespaces",r),this.persist("optionalNamespaces",n)}validateChain(t){const[r,n]=(t==null?void 0:t.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[r,n];if(r&&!Object.keys(this.namespaces||{}).map(f=>Zn(f)).includes(r))throw new Error(`Namespace '${r}' is not configured. Please call connect() first with namespace config.`);if(r&&n)return[r,n];const o=Zn(Object.keys(this.namespaces)[0]),u=this.rpcProviders[o].getDefaultChain();return[o,u]}async requestAccounts(){const[t]=this.validateChain();return await this.getProvider(t).requestAccounts()}onChainChanged(t,r=!1){var n;if(!this.namespaces)return;const[o,u]=this.validateChain(t);r||this.getProvider(o).setDefaultChain(u),((n=this.namespaces[o])!=null?n:this.namespaces[`${o}:${u}`]).defaultChain=u,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",u)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(t,r){this.client.core.storage.setItem(`${uf}/${t}`,r)}async getFromStore(t){return await this.client.core.storage.getItem(`${uf}/${t}`)}}const Zx=ou,Xx="wc",eS="ethereum_provider",tS=`${Xx}@2:${eS}:`,rS="https://rpc.walletconnect.com/v1/",zc=["eth_sendTransaction","personal_sign"],iS=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","eth_sendTransaction","personal_sign","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Hc=["chainChanged","accountsChanged"],nS=["chainChanged","accountsChanged","message","disconnect","connect"];var sS=Object.defineProperty,oS=Object.defineProperties,aS=Object.getOwnPropertyDescriptors,gf=Object.getOwnPropertySymbols,cS=Object.prototype.hasOwnProperty,uS=Object.prototype.propertyIsEnumerable,yf=(s,t,r)=>t in s?sS(s,t,{enumerable:!0,configurable:!0,writable:!0,value:r}):s[t]=r,es=(s,t)=>{for(var r in t||(t={}))cS.call(t,r)&&yf(s,r,t[r]);if(gf)for(var r of gf(t))uS.call(t,r)&&yf(s,r,t[r]);return s},mf=(s,t)=>oS(s,aS(t));function To(s){return Number(s[0].split(":")[1])}function xc(s){return`0x${s.toString(16)}`}function hS(s){const{chains:t,optionalChains:r,methods:n,optionalMethods:o,events:u,optionalEvents:f,rpcMap:g}=s;if(!Jr(t))throw new Error("Invalid chains");const v={chains:t,methods:n||zc,events:u||Hc,rpcMap:es({},t.length?{[To(t)]:g[To(t)]}:{})},p=u==null?void 0:u.filter(q=>!Hc.includes(q)),w=n==null?void 0:n.filter(q=>!zc.includes(q));if(!r&&!f&&!o&&!(p!=null&&p.length)&&!(w!=null&&w.length))return{required:t.length?v:void 0};const E=(p==null?void 0:p.length)&&(w==null?void 0:w.length)||!r,O={chains:[...new Set(E?v.chains.concat(r||[]):r)],methods:[...new Set(v.methods.concat(o!=null&&o.length?o:iS))],events:[...new Set(v.events.concat(f!=null&&f.length?f:nS))],rpcMap:g};return{required:t.length?v:void 0,optional:r.length?O:void 0}}class au{constructor(){this.events=new Qr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=tS,this.on=(t,r)=>(this.events.on(t,r),this),this.once=(t,r)=>(this.events.once(t,r),this),this.removeListener=(t,r)=>(this.events.removeListener(t,r),this),this.off=(t,r)=>(this.events.off(t,r),this),this.parseAccount=t=>this.isCompatibleChainId(t)?this.parseAccountId(t).address:t,this.signer={},this.rpc={}}static async init(t){const r=new au;return await r.initialize(t),r}async request(t){return await this.signer.request(t,this.formatChainId(this.chainId))}sendAsync(t,r){this.signer.sendAsync(t,r,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(t){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(t);const{required:r,optional:n}=hS(this.rpc);try{const o=await new Promise(async(f,g)=>{var v;this.rpc.showQrModal&&((v=this.modal)==null||v.subscribeModal(p=>{!p.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),g(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(mf(es({namespaces:es({},r&&{[this.namespace]:r})},n&&{optionalNamespaces:{[this.namespace]:n}}),{pairingTopic:t==null?void 0:t.pairingTopic})).then(p=>{f(p)}).catch(p=>{g(new Error(p.message))})});if(!o)return;const u=b1(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:u),this.setAccounts(u),this.events.emit("connect",{chainId:xc(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",t=>{const{params:r}=t,{event:n}=r;n.name==="accountsChanged"?(this.accounts=this.parseAccounts(n.data),this.events.emit("accountsChanged",this.accounts)):n.name==="chainChanged"?this.setChainId(this.formatChainId(n.data)):this.events.emit(n.name,n.data),this.events.emit("session_event",t)}),this.signer.on("chainChanged",t=>{const r=parseInt(t);this.chainId=r,this.events.emit("chainChanged",xc(this.chainId)),this.persist()}),this.signer.on("session_update",t=>{this.events.emit("session_update",t)}),this.signer.on("session_delete",t=>{this.reset(),this.events.emit("session_delete",t),this.events.emit("disconnect",mf(es({},It("USER_DISCONNECTED")),{data:t.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",t=>{var r,n;this.rpc.showQrModal&&((r=this.modal)==null||r.closeModal(),(n=this.modal)==null||n.openModal({uri:t})),this.events.emit("display_uri",t)})}switchEthereumChain(t){this.request({method:"wallet_switchEthereumChain",params:[{chainId:t.toString(16)}]})}isCompatibleChainId(t){return typeof t=="string"?t.startsWith(`${this.namespace}:`):!1}formatChainId(t){return`${this.namespace}:${t}`}parseChainId(t){return Number(t.split(":")[1])}setChainIds(t){const r=t.filter(n=>this.isCompatibleChainId(n)).map(n=>this.parseChainId(n));r.length&&(this.chainId=r[0],this.events.emit("chainChanged",xc(this.chainId)),this.persist())}setChainId(t){if(this.isCompatibleChainId(t)){const r=this.parseChainId(t);this.chainId=r,this.switchEthereumChain(r)}}parseAccountId(t){const[r,n,o]=t.split(":");return{chainId:`${r}:${n}`,address:o}}setAccounts(t){this.accounts=t.filter(r=>this.parseChainId(this.parseAccountId(r).chainId)===this.chainId).map(r=>this.parseAccountId(r).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(t){var r,n;const o=(r=t==null?void 0:t.chains)!=null?r:[],u=(n=t==null?void 0:t.optionalChains)!=null?n:[],f=o.concat(u);if(!f.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const g=o.length?(t==null?void 0:t.methods)||zc:[],v=o.length?(t==null?void 0:t.events)||Hc:[],p=(t==null?void 0:t.optionalMethods)||[],w=(t==null?void 0:t.optionalEvents)||[],E=(t==null?void 0:t.rpcMap)||this.buildRpcMap(f,t.projectId),O=(t==null?void 0:t.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(q=>this.formatChainId(q)),optionalChains:u.map(q=>this.formatChainId(q)),methods:g,events:v,optionalMethods:p,optionalEvents:w,rpcMap:E,showQrModal:!!(t!=null&&t.showQrModal),qrModalOptions:O,projectId:t.projectId,metadata:t.metadata}}buildRpcMap(t,r){const n={};return t.forEach(o=>{n[o]=this.getRpcUrl(o,r)}),n}async initialize(t){if(this.rpc=this.getRpcConfig(t),this.chainId=this.rpc.chains.length?To(this.rpc.chains):To(this.rpc.optionalChains),this.signer=await Zx.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:t.disableProviderPing,relayUrl:t.relayUrl,storageOptions:t.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let r;try{const{WalletConnectModal:n}=await h1(()=>import("./index-f42783c3.js").then(o=>o.i),["assets/index-f42783c3.js","assets/index-a31c56fe.js","assets/index-e5979b9b.css"]);r=n}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(r)try{this.modal=new r(es({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(n){throw this.signer.logger.error(n),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(t){if(!t)return;const{chains:r,optionalChains:n,rpcMap:o}=t;r&&Jr(r)&&(this.rpc.chains=r.map(u=>this.formatChainId(u)),r.forEach(u=>{this.rpc.rpcMap[u]=(o==null?void 0:o[u])||this.getRpcUrl(u)})),n&&Jr(n)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=n==null?void 0:n.map(u=>this.formatChainId(u)),n.forEach(u=>{this.rpc.rpcMap[u]=(o==null?void 0:o[u])||this.getRpcUrl(u)}))}getRpcUrl(t,r){var n;return((n=this.rpc.rpcMap)==null?void 0:n[t])||`${rS}?chainId=eip155:${t}&projectId=${r||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const t=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),r=this.session.namespaces[`${this.namespace}:${t}`]?this.session.namespaces[`${this.namespace}:${t}`]:this.session.namespaces[this.namespace];this.setChainIds(t?[this.formatChainId(t)]:r==null?void 0:r.accounts),this.setAccounts(r==null?void 0:r.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(t){return typeof t=="string"||t instanceof String?[this.parseAccount(t)]:t.map(r=>this.parseAccount(r))}}const OS=au;export{OS as EthereumProvider,nS as OPTIONAL_EVENTS,iS as OPTIONAL_METHODS,Hc as REQUIRED_EVENTS,zc as REQUIRED_METHODS,au as default};
